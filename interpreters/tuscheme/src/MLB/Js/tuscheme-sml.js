if ((typeof(tuscheme$0tuscheme$1)) == "undefined") {tuscheme$0tuscheme$1 = {};
};
(function(){tuscheme$0tuscheme$1.eq_error$4919 = function(v$4923,v$4920){var v$4921 = v$4920[0];
var v$4922 = v$4920[1];
switch (v$4921[0]) { case 0: {switch (v$4922[0]) { case 0: {var v$4924 = v$4921[1];
var v$4925 = v$4922[1];
return v$4923([v$4924,v$4925]);
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4922[0]) { case 1: {return v$4921[1] == v$4922[1];
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_input_interactivity$4929 = function(v$4931,v$4932){switch (v$4931) { case 0: {switch (v$4932) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4932) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_output_interactivity$4933 = function(v$4935,v$4936){switch (v$4935) { case 0: {switch (v$4936) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4936) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_collection$4937 = function(v$4941,v$4938){var v$4939 = v$4938[0];
var v$4940 = v$4938[1];
switch (v$4940[0]) { case 0: {var v$4942 = v$4939[1];
var v$4943 = v$4940[1];
var fix$13821 = {};
fix$13821.$eq_list = function(v$5088,v$5089){lab$eq_list: while (true) {if (v$5088 == null) {return (v$5089 == null)?true:false;
} else {if (v$5089 == null) {return false;
} else {var v$5090 = v$5088;
var v$5091 = v$5089;
if (v$4941([v$5090[0],v$5091[0]])) {var t$13822 = v$5090[1];
var t$13823 = v$5091[1];
var v$5088 = t$13822;
var v$5089 = t$13823;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5086 = fix$13821.$eq_list;
return eq_list$5086(v$4942,v$4943);
 break; }default: {return false;
} };
};
tuscheme$0tuscheme$1.eq_error_format$4944 = function(v$4946,v$4947){switch (v$4946) { case 0: {switch (v$4947) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4947) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_eol_marked$4948 = function(v$4952,v$4949){var v$4950 = v$4949[0];
var v$4951 = v$4949[1];
switch (v$4950[0]) { case 0: {switch (v$4951[0]) { case 0: {var v$4953 = v$4950[1];
var v$4954 = v$4951[1];
return v$4952([v$4953,v$4954]);
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4951[0]) { case 1: {return v$4950[1] == v$4951[1];
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_bracket_shape$4958 = function(v$4960,v$4961){switch (v$4960) { case 0: {switch (v$4961) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4961) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4961) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_plus_brackets$4962 = function(v$4966,v$4963){var v$4964 = v$4963[0];
var v$4965 = v$4963[1];
switch (v$4964[0]) { case 0: {switch (v$4965[0]) { case 0: {var v$4967 = v$4964[1];
var v$4968 = v$4965[1];
switch (v$4967) { case 0: {switch (v$4968) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4968) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4968) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4965[0]) { case 1: {var v$4969 = v$4964[1];
var v$4970 = v$4965[1];
return v$4966([v$4969,v$4970]);
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4965[0]) { case 2: {var v$4971 = v$4964[1];
var v$4972 = v$4965[1];
switch (v$4971) { case 0: {switch (v$4972) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4972) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4972) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_right_result$4973 = function(v$4975,v$4976){switch (v$4975[0]) { case 0: {switch (v$4976[0]) { case 0: {var v$4977 = v$4975[1];
var v$4978 = v$4976[1];
return (v$4977[0] == v$4978[0])?(v$4977[1] == v$4978[1]):false;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4976[0]) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4976[0]) { case 2: {var v$4982 = v$4975[1];
var v$4983 = v$4976[1];
var t$13824;
var v$9281 = v$4982[0];
var v$9282 = v$4983[0];
t$13824 = ((v$9281[0] == v$9282[0])?(v$9281[1] == v$9282[1]):false);
if (t$13824) {var v$9287 = v$4982[1];
var v$9288 = v$4983[1];
switch (v$9287) { case 0: {switch (v$9288) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$9288) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$9288) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
} else {return false;
};
 break; }default: {return false;
} };
 break; } };
};
var fix$13825 = {};
fix$13825.$eq_kind = function(v$4990,v$4991){lab$eq_kind: while (true) {if (v$4990 == null) {return (v$4991 == null)?true:false;
} else {if (v$4991 == null) {return false;
} else {var v$4992 = v$4990;
var v$4993 = v$4991;
var t$13829;
var fix$13826 = {};
fix$13826.$eq_list = function(v$5105,v$5106){lab$eq_list: while (true) {if (v$5105 == null) {return (v$5106 == null)?true:false;
} else {if (v$5106 == null) {return false;
} else {var v$5107 = v$5105;
var v$5108 = v$5106;
if (fix$13825.$eq_kind(v$5107[0],v$5108[0])) {var t$13827 = v$5107[1];
var t$13828 = v$5108[1];
var v$5105 = t$13827;
var v$5106 = t$13828;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5103 = fix$13826.$eq_list;
t$13829 = (eq_list$5103(v$4992[0],v$4993[0]));
if (t$13829) {var t$13830 = v$4992[1];
var t$13831 = v$4993[1];
var v$4990 = t$13830;
var v$4991 = t$13831;
continue lab$eq_kind;
} else {return false;
};
};
};
};
};
tuscheme$0tuscheme$1.eq_kind$4988 = fix$13825.$eq_kind;
var fix$13832 = {};
fix$13832.$eq_tyex = function(v$4997,v$4998){lab$eq_tyex: while (true) {switch (v$4997[0]) { case 0: {switch (v$4998[0]) { case 0: {return v$4997[1] == v$4998[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4998[0]) { case 1: {return v$4997[1] == v$4998[1];
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4998[0]) { case 2: {var v$5005 = v$4997[1];
var v$5006 = v$4998[1];
var t$13845;
var fix$13842 = {};
fix$13842.$eq_list = function(v$5113,v$5114){lab$eq_list: while (true) {if (v$5113 == null) {return (v$5114 == null)?true:false;
} else {if (v$5114 == null) {return false;
} else {var v$5115 = v$5113;
var v$5116 = v$5114;
if (fix$13832.$eq_tyex(v$5115[0],v$5116[0])) {var t$13843 = v$5115[1];
var t$13844 = v$5116[1];
var v$5113 = t$13843;
var v$5114 = t$13844;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5111 = fix$13842.$eq_list;
t$13845 = (eq_list$5111(v$5005[0],v$5006[0]));
if (t$13845) {var t$13846 = v$5005[1];
var t$13847 = v$5006[1];
var v$4997 = t$13846;
var v$4998 = t$13847;
continue lab$eq_tyex;
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 3: {switch (v$4998[0]) { case 3: {var v$5008 = v$4997[1];
var v$5009 = v$4998[1];
var t$13839;
var fix$13836 = {};
fix$13836.$eq_list = function(v$5122,v$5123){lab$eq_list: while (true) {if (v$5122 == null) {return (v$5123 == null)?true:false;
} else {if (v$5123 == null) {return false;
} else {var v$5124 = v$5122;
var v$5125 = v$5123;
if (v$5124[0] == v$5125[0]) {var t$13837 = v$5124[1];
var t$13838 = v$5125[1];
var v$5122 = t$13837;
var v$5123 = t$13838;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5120 = fix$13836.$eq_list;
t$13839 = (eq_list$5120(v$5008[0],v$5009[0]));
if (t$13839) {var t$13840 = v$5008[1];
var t$13841 = v$5009[1];
var v$4997 = t$13840;
var v$4998 = t$13841;
continue lab$eq_tyex;
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 4: {switch (v$4998[0]) { case 4: {var v$5012 = v$4997[1];
var v$5013 = v$4998[1];
if (fix$13832.$eq_tyex(v$5012[0],v$5013[0])) {var fix$13833 = {};
fix$13833.$eq_list = function(v$5131,v$5132){lab$eq_list: while (true) {if (v$5131 == null) {return (v$5132 == null)?true:false;
} else {if (v$5132 == null) {return false;
} else {var v$5133 = v$5131;
var v$5134 = v$5132;
if (fix$13832.$eq_tyex(v$5133[0],v$5134[0])) {var t$13834 = v$5133[1];
var t$13835 = v$5134[1];
var v$5131 = t$13834;
var v$5132 = t$13835;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5129 = fix$13833.$eq_list;
return eq_list$5129(v$5012[1],v$5013[1]);
} else {return false;
};
 break; }default: {return false;
} };
 break; } };
};
};
tuscheme$0tuscheme$1.eq_tyex$4995 = fix$13832.$eq_tyex;
tuscheme$0tuscheme$1.eq_let_kind$5015 = function(v$5017,v$5018){switch (v$5017[0]) { case 0: {switch (v$5018[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$5018[0]) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.eq_pretoken$5019 = function(v$5021,v$5022){switch (v$5021[0]) { case 0: {switch (v$5022[0]) { case 0: {return v$5021[1] == v$5022[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$5022[0]) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$5022[0]) { case 2: {return v$5021[1] == v$5022[1];
 break; }default: {return false;
} };
 break; }case 3: {switch (v$5022[0]) { case 3: {return v$5021[1] == v$5022[1];
 break; }default: {return false;
} };
 break; } };
};
tuscheme$0tuscheme$1.en$TypeError$87 = new String("TypeError");
tuscheme$0tuscheme$1.en$BugInTypeChecking$88 = new String("BugInTypeChecking");
tuscheme$0tuscheme$1.id$89 = function(x$92){return x$92;
};
tuscheme$0tuscheme$1.fst$93 = function(v$13553,v$13554){return v$13553;
};
tuscheme$0tuscheme$1.snd$100 = function(v$13555,v$13556){return v$13556;
};
tuscheme$0tuscheme$1.pair$107 = function(x$110,y$113){return [x$110,y$113];
};
tuscheme$0tuscheme$1.curry$114 = function(f$117,x$120,y$123){return f$117([x$120,y$123]);
};
tuscheme$0tuscheme$1.curry3$124 = function(f$127,x$130,y$133,z$136){return f$127([x$130,y$133,z$136]);
};
tuscheme$0tuscheme$1.emptyEnv$137 = function(v$13695){return null;
};
tuscheme$0tuscheme$1.en$NotFound$138 = new String("NotFound");
var fix$13848 = {};
fix$13848.$find = function(v$13557,v$152){lab$find: while (true) {if (v$152 == null) {throw [tuscheme$0tuscheme$1.en$NotFound$138,v$13557];
} else {var v$159 = v$152;
var v$160 = v$159[0];
var v$161 = v$160[0];
var v$162 = v$160[1];
var v$163 = v$159[1];
if (v$13557 == v$161) {return v$162;
} else {var t$13849 = v$13557;
var t$13850 = v$163;
var v$13557 = t$13849;
var v$152 = t$13850;
continue lab$find;
};
};
};
};
tuscheme$0tuscheme$1.find$139 = fix$13848.$find;
tuscheme$0tuscheme$1.en$BindListLength$164 = new String("BindListLength");
tuscheme$0tuscheme$1.exn$BindListLength$164 = [tuscheme$0tuscheme$1.en$BindListLength$164];
tuscheme$0tuscheme$1.bind$165 = function(v$13558,v$13559,v$13560){return [[v$13558,v$13559],v$13560];
};
var fix$13851 = {};
fix$13851.$bindList = function(v$191,v$13561,v$13562){lab$bindList: while (true) {if (v$191 == null) {if (v$13561 == null) {return v$13562;
} else {throw tuscheme$0tuscheme$1.exn$BindListLength$164;
};
} else {if (v$13561 == null) {throw tuscheme$0tuscheme$1.exn$BindListLength$164;
} else {var v$195 = v$191;
var v$196 = v$195[0];
var v$197 = v$195[1];
var v$198 = v$13561;
var v$199 = v$198[0];
var v$200 = v$198[1];
var t$13852 = v$197;
var t$13853 = v$200;
var t$13854 = [[v$196,v$199],v$13562];
var v$191 = t$13852;
var v$13561 = t$13853;
var v$13562 = t$13854;
continue lab$bindList;
};
};
};
};
tuscheme$0tuscheme$1.bindList$174 = fix$13851.$bindList;
var fix$13855 = {};
fix$13855.$duplicatename = function(v$5033,v$208){lab$duplicatename: while (true) {if (v$208 == null) {return [1];
} else {var v$222 = v$208;
var v$223 = v$222[0];
var v$224 = v$222[1];
var t$13858;
var fix$13856 = {};
fix$13856.$exists = function(v$5147){lab$exists: while (true) {if (v$5147 == null) {return false;
} else {var v$5148 = v$5147;
var v$5149 = v$5148[0];
var v$5150 = v$5148[1];
if (v$5033([v$5149,v$223])) {return true;
} else {var t$13857 = v$5150;
var v$5147 = t$13857;
continue lab$exists;
};
};
};
};
var exists$5146 = fix$13856.$exists;
t$13858 = (exists$5146(v$224));
if (t$13858) {return [0,v$223];
} else {var t$13859 = v$5033;
var t$13860 = v$224;
var v$5033 = t$13859;
var v$208 = t$13860;
continue lab$duplicatename;
};
};
};
};
tuscheme$0tuscheme$1.duplicatename$205 = fix$13855.$duplicatename;
tuscheme$0tuscheme$1.en$RuntimeError$225 = new String("RuntimeError");
tuscheme$0tuscheme$1.errorIfDups$226 = function(v$238,v$239,v$240){var v$236;
var fix$13861 = {};
fix$13861.$duplicatename = function(v$5197){lab$duplicatename: while (true) {if (v$5197 == null) {return [1];
} else {var v$5200 = v$5197;
var v$5201 = v$5200[0];
var v$5202 = v$5200[1];
var t$13864;
var fix$13862 = {};
fix$13862.$exists = function(v$5212){lab$exists: while (true) {if (v$5212 == null) {return false;
} else {var v$5213 = v$5212;
var v$5214 = v$5213[0];
var v$5215 = v$5213[1];
if (v$5214 == v$5201) {return true;
} else {var t$13863 = v$5215;
var v$5212 = t$13863;
continue lab$exists;
};
};
};
};
var exists$5211 = fix$13862.$exists;
t$13864 = (exists$5211(v$5202));
if (t$13864) {return [0,v$5201];
} else {var t$13865 = v$5202;
var v$5197 = t$13865;
continue lab$duplicatename;
};
};
};
};
var duplicatename$5196 = fix$13861.$duplicatename;
v$236 = (duplicatename$5196(v$239));
switch (v$236[0]) { case 1: {return 0;
 break; }default: {var v$237 = v$236[1];
throw [tuscheme$0tuscheme$1.en$RuntimeError$225,(((v$238 + " ") + v$237) + " appears twice in ") + v$240];
} };
};
tuscheme$0tuscheme$1.en$InternalError$241 = new String("InternalError");
var fix$13866 = {};
fix$13866.$zip3 = function(v$261,v$13563,v$13564){if (v$261 == null) {if (v$13563 == null) {if (v$13564 == null) {return null;
} else {throw basis$0ListPair$1.exn$UnequalLengths$54;
};
} else {throw basis$0ListPair$1.exn$UnequalLengths$54;
};
} else {if (v$13563 == null) {throw basis$0ListPair$1.exn$UnequalLengths$54;
} else {if (v$13564 == null) {throw basis$0ListPair$1.exn$UnequalLengths$54;
} else {var v$269 = v$261;
var v$270 = v$269[0];
var v$271 = v$269[1];
var v$272 = v$13563;
var v$273 = v$272[0];
var v$274 = v$272[1];
var v$275 = v$13564;
var v$276 = v$275[0];
var v$277 = v$275[1];
return [[v$270,v$273,v$276],fix$13866.$zip3(v$271,v$274,v$277)];
};
};
};
};
tuscheme$0tuscheme$1.zip3$242 = fix$13866.$zip3;
var fix$13867 = {};
fix$13867.$unzip3 = function(v$281){if (v$281 == null) {return [null,null,null];
} else {var v$304 = v$281;
var v$305 = v$304[0];
var v$306 = v$304[1];
var v$301 = v$305[0];
var v$302 = v$305[1];
var v$303 = v$305[2];
var v$296 = fix$13867.$unzip3(v$306);
return [[v$301,v$296[0]],[v$302,v$296[1]],[v$303,v$296[2]]];
};
};
tuscheme$0tuscheme$1.unzip3$278 = fix$13867.$unzip3;
tuscheme$0tuscheme$1.reverse$307 = function(v$13696){return function(v$13699){return basis$0List$1.rev$682(v$13699);
};
};
var fix$13868 = {};
fix$13868.$optionList = function(v$311){if (v$311 == null) {return [0,null];
} else {var v$320 = v$311;
var v$321 = v$320[0];
switch (v$321[0]) { case 1: {return [1];
 break; }default: {var v$329 = v$321[1];
var v$330 = v$320[1];
var v$326 = fix$13868.$optionList(v$330);
switch (v$326[0]) { case 0: {return [0,[v$329,v$326[1]]];
 break; }default: {return [1];
} };
} };
};
};
tuscheme$0tuscheme$1.optionList$308 = fix$13868.$optionList;
tuscheme$0tuscheme$1.println$331 = function(s$334){tuscheme$0stubs$1.print$119(s$334);
return tuscheme$0stubs$1.print$119("\n");
};
tuscheme$0tuscheme$1.eprint$337 = function(s$340){return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$340);
};
tuscheme$0tuscheme$1.eprintln$341 = function(s$344){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$344);
return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
};
tuscheme$0tuscheme$1.predefinedFunctionError$347 = function(s$350){var s$5238 = "while reading predefined functions, " + s$350;
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$5238);
return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
};
tuscheme$0tuscheme$1.intString$351 = function(n$354){var a$5243 = basis$0Int32$1.toString$458(n$354);
var v$5244 = a$5243.length;
if ((v$5244 < 0)?true:(v$5244 > 16777211)) {throw CompilerInitial.exn$Size$53;
} else {var t$5245 = Array(v$5244);
var fix$13869 = {};
fix$13869.$loop = function(j$5247){lab$loop: while (true) {if (j$5247 < v$5244) {var t$13872 = t$5245;
var t$13871 = j$5247;
var t$13870;
var v$10532 = a$5243.charCodeAt(j$5247);
switch (v$10532) { case 126: {t$13870 = 45;
 break; }default: {t$13870 = v$10532;
} };
(t$13872[t$13871] = t$13870,0);
var t$13873 = SmlPrims.chk_ovf_i32(j$5247 + 1);
var j$5247 = t$13873;
continue lab$loop;
} else {return 0;
};
};
};
var loop$5246 = fix$13869.$loop;
loop$5246(0);
return SmlPrims.charArrayToString(t$5245);
};
};
tuscheme$0tuscheme$1.plural$360 = function(v$363,v$366){if (v$366 == null) {return v$363 + "s";
} else {var v$377 = v$366;
return (v$377[1] == null)?v$363:(v$363 + "s");
};
};
tuscheme$0tuscheme$1.countString$383 = function(xs$386,what$389){var t$13881;
var t$13880;
var t$13879 = tuscheme$0tuscheme$1.intString$351;
var t$13878;
var fix$13875 = {};
fix$13875.$acc = function(v$5259,v$5260){lab$acc: while (true) {if (v$5259 == null) {return v$5260;
} else {var v$5261 = v$5259;
var v$5262 = v$5261[1];
var t$13876 = v$5262;
var t$13877 = SmlPrims.chk_ovf_i32(v$5260 + 1);
var v$5259 = t$13876;
var v$5260 = t$13877;
continue lab$acc;
};
};
};
var acc$5258 = fix$13875.$acc;
t$13878 = (acc$5258(xs$386,0));
t$13880 = (t$13879(t$13878));
t$13881 = (t$13880 + " ");
var t$13874;
if (xs$386 == null) {t$13874 = (what$389 + "s");
} else {var v$5267 = xs$386;
t$13874 = ((v$5267[1] == null)?what$389:(what$389 + "s"));
};
return t$13881 + t$13874;
};
tuscheme$0tuscheme$1.separate$390 = function(v$412,v$413){var fix$13882 = {};
fix$13882.$s = function(v$398){if (v$398 == null) {return v$412;
} else {var v$408 = v$398;
var v$409 = v$408[1];
return (v$409 == null)?v$408[0]:((v$408[0] + v$413) + (fix$13882.$s(v$409)));
};
};
var s$395 = fix$13882.$s;
return function(v$13700){return s$395(v$13700);
};
};
tuscheme$0tuscheme$1.spaceSep$414;
var fix$13883 = {};
fix$13883.$s = function(v$5278){if (v$5278 == null) {return "";
} else {var v$5279 = v$5278;
var v$5280 = v$5279[1];
return (v$5280 == null)?v$5279[0]:((v$5279[0] + " ") + (fix$13883.$s(v$5280)));
};
};
var s$5277 = fix$13883.$s;
tuscheme$0tuscheme$1.spaceSep$414 = (function(v$13701){return s$5277(v$13701);
});
tuscheme$0tuscheme$1.commaSep$415;
var fix$13884 = {};
fix$13884.$s = function(v$5288){if (v$5288 == null) {return "";
} else {var v$5289 = v$5288;
var v$5290 = v$5289[1];
return (v$5290 == null)?v$5289[0]:((v$5289[0] + ", ") + (fix$13884.$s(v$5290)));
};
};
var s$5287 = fix$13884.$s;
tuscheme$0tuscheme$1.commaSep$415 = (function(v$13702){return s$5287(v$13702);
});
tuscheme$0tuscheme$1.printUTF8$416 = function(code$419){var w$420 = SmlPrims.i32_to_w32(code$419);
var t$13885;
var v$9372 = w$420 & 2097151;
t$13885 = ((v$9372 == w$420)?false:true);
if (t$13885) {throw [tuscheme$0tuscheme$1.en$RuntimeError$225,(tuscheme$0tuscheme$1.intString$351(code$419)) + " does not represent a Unicode code point"];
} else {0;
};
if (w$420 > 65535) {var l$5307 = [240 | (w$420 >>> 18),[128 | ((w$420 >>> 12) & 63),[128 | ((w$420 >>> 6) & 63),[128 | (w$420 & 63),null]]]];
var fix$13886 = {};
fix$13886.$app = function(v$5309){lab$app: while (true) {if (v$5309 == null) {return 0;
} else {var v$5310 = v$5309;
var v$5311 = v$5310[0];
var v$5312 = v$5310[1];
tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(v$5311)));
var t$13887 = v$5312;
var v$5309 = t$13887;
continue lab$app;
};
};
};
var app$5308 = fix$13886.$app;
return app$5308(l$5307);
} else {if (w$420 > 2047) {var l$5327 = [224 | (w$420 >>> 12),[128 | ((w$420 >>> 6) & 63),[128 | (w$420 & 63),null]]];
var fix$13888 = {};
fix$13888.$app = function(v$5329){lab$app: while (true) {if (v$5329 == null) {return 0;
} else {var v$5330 = v$5329;
var v$5331 = v$5330[0];
var v$5332 = v$5330[1];
tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(v$5331)));
var t$13889 = v$5332;
var v$5329 = t$13889;
continue lab$app;
};
};
};
var app$5328 = fix$13888.$app;
return app$5328(l$5327);
} else {if (w$420 > 127) {var l$5344 = [192 | (w$420 >>> 6),[128 | (w$420 & 63),null]];
var fix$13890 = {};
fix$13890.$app = function(v$5346){lab$app: while (true) {if (v$5346 == null) {return 0;
} else {var v$5347 = v$5346;
var v$5348 = v$5347[0];
var v$5349 = v$5347[1];
tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(v$5348)));
var t$13891 = v$5349;
var v$5346 = t$13891;
continue lab$app;
};
};
};
var app$5345 = fix$13890.$app;
return app$5345(l$5344);
} else {return tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(w$420)));
};
};
};
};
tuscheme$0tuscheme$1.stripNumericSuffix$454 = function(s$457){var fix$13892 = {};
fix$13892.$stripPrefix = function(v$461){lab$stripPrefix: while (true) {if (v$461 == null) {return s$457;
} else {var v$473 = v$461;
var v$474 = v$473[0];
switch (v$474) { case 45: {var v$475 = v$473[1];
return (v$475 == null)?s$457:(SmlPrims.implode(basis$0List$1.rev$682(v$475)));
 break; }default: {var v$480 = v$473[1];
if ((48 <= v$474)?(v$474 <= 57):false) {var t$13893 = v$480;
var v$461 = t$13893;
continue lab$stripPrefix;
} else {return SmlPrims.implode(basis$0List$1.rev$682([v$474,v$480]));
};
} };
};
};
};
var stripPrefix$458 = fix$13892.$stripPrefix;
var t$13900 = stripPrefix$458;
var t$13899;
var t$13898 = basis$0List$1.rev$682;
var t$13897;
var fix$13894 = {};
fix$13894.$h = function(v$5364,v$5365){lab$h: while (true) {if (v$5364 < 0) {return v$5365;
} else {var t$13895 = SmlPrims.chk_ovf_i32(v$5364 - 1);
var t$13896 = [s$457.charCodeAt(v$5364),v$5365];
var v$5364 = t$13895;
var v$5365 = t$13896;
continue lab$h;
};
};
};
var h$5362 = fix$13894.$h;
t$13897 = (h$5362(SmlPrims.chk_ovf_i32(s$457.length - 1),null));
t$13899 = (t$13898(t$13897));
return t$13900(t$13899);
};
tuscheme$0tuscheme$1.s$llk$483 = function(v$495,v$13565){switch (v$495[0]) { case 0: {var v$497 = v$495[1];
return v$13565(v$497);
 break; }default: {var v$499 = v$495[1];
return [1,v$499];
} };
};
tuscheme$0tuscheme$1.s$llkf$501 = function(v$507,v$508){switch (v$507[0]) { case 0: {var v$5368 = v$507[1];
var v$10571 = v$508(v$5368);
return [0,v$10571];
 break; }default: {var v$5370 = v$507[1];
return [1,v$5370];
} };
};
tuscheme$0tuscheme$1.errorList$509 = function(es$512){var b$5378 = [0,null];
var fix$13901 = {};
fix$13901.$foldr = function(v$5381){if (v$5381 == null) {return b$5378;
} else {var v$5382 = v$5381;
var v$5383 = v$5382[0];
var v$5384 = v$5382[1];
var v$13327 = fix$13901.$foldr(v$5384);
switch (v$5383[0]) { case 0: {switch (v$13327[0]) { case 0: {return [0,[v$5383[1],v$13327[1]]];
 break; }default: {var v$10575 = v$13327[1];
return [1,v$10575];
} };
 break; }default: {switch (v$13327[0]) { case 1: {return [1,(v$5383[1] + "; ") + v$13327[1]];
 break; }default: {var v$10577 = v$5383[1];
return [1,v$10577];
} };
} };
};
};
var foldr$5380 = fix$13901.$foldr;
return foldr$5380(es$512);
};
tuscheme$0tuscheme$1.noninteractive$547 = [1,1];
tuscheme$0tuscheme$1.prompts$548 = function(v$13566,v$13567){switch (v$13566) { case 0: {return true;
 break; }default: {return false;
} };
};
tuscheme$0tuscheme$1.prints$557 = function(v$13568,v$13569){switch (v$13569) { case 0: {return true;
 break; }default: {return false;
} };
};
tuscheme$0tuscheme$1.emptyset$566 = function(v$13697){return null;
};
tuscheme$0tuscheme$1.member$567 = function(v$5037,x$570){var fix$13902 = {};
fix$13902.$exists = function(v$5399){lab$exists: while (true) {if (v$5399 == null) {return false;
} else {var v$5400 = v$5399;
var v$5401 = v$5400[0];
var v$5402 = v$5400[1];
if (v$5037([v$5401,x$570])) {return true;
} else {var t$13903 = v$5402;
var v$5399 = t$13903;
continue lab$exists;
};
};
};
};
var exists$5398 = fix$13902.$exists;
return function(v$13703){return exists$5398(v$13703);
};
};
tuscheme$0tuscheme$1.insert$574 = function(v$5038,v$578){var v$583 = v$578[0];
var v$584 = v$578[1];
var t$13906;
var fix$13904 = {};
fix$13904.$exists = function(v$5415){lab$exists: while (true) {if (v$5415 == null) {return false;
} else {var v$5416 = v$5415;
var v$5417 = v$5416[0];
var v$5418 = v$5416[1];
if (v$5038([v$5417,v$583])) {return true;
} else {var t$13905 = v$5418;
var v$5415 = t$13905;
continue lab$exists;
};
};
};
};
var exists$5414 = fix$13904.$exists;
t$13906 = (exists$5414(v$584));
return t$13906?v$584:[v$583,v$584];
};
tuscheme$0tuscheme$1.union$585 = function(v$5039,v$589){var v$590 = v$589[0];
var v$591 = v$589[1];
var fix$13907 = {};
fix$13907.$foldl = function(v$5427,v$5428){lab$foldl: while (true) {if (v$5428 == null) {return v$5427;
} else {var v$5429 = v$5428;
var v$5430 = v$5429[0];
var v$5431 = v$5429[1];
var t$13911;
var t$13910;
var fix$13908 = {};
fix$13908.$exists = function(v$13453){lab$exists: while (true) {if (v$13453 == null) {return false;
} else {var v$13454 = v$13453;
var v$13455 = v$13454[0];
var v$13456 = v$13454[1];
if (v$5039([v$13455,v$5430])) {return true;
} else {var t$13909 = v$13456;
var v$13453 = t$13909;
continue lab$exists;
};
};
};
};
var exists$13452 = fix$13908.$exists;
t$13910 = (exists$13452(v$5427));
t$13911 = (t$13910?v$5427:[v$5430,v$5427]);
var t$13912 = t$13911;
var t$13913 = v$5431;
var v$5427 = t$13912;
var v$5428 = t$13913;
continue lab$foldl;
};
};
};
var foldl$5426 = fix$13907.$foldl;
return foldl$5426(v$591,v$590);
};
tuscheme$0tuscheme$1.inter$592 = function(v$5040,v$596){var v$600 = v$596[0];
var v$601 = v$596[1];
return basis$0List$1.filter$417(function(x$599){var fix$13914 = {};
fix$13914.$exists = function(v$5435){lab$exists: while (true) {if (v$5435 == null) {return false;
} else {var v$5436 = v$5435;
var v$5437 = v$5436[0];
var v$5438 = v$5436[1];
if (v$5040([v$5437,x$599])) {return true;
} else {var t$13915 = v$5438;
var v$5435 = t$13915;
continue lab$exists;
};
};
};
};
var exists$5434 = fix$13914.$exists;
return exists$5434(v$601);
},v$600);
};
tuscheme$0tuscheme$1.diff$602 = function(v$5041,v$606){var v$610 = v$606[0];
var v$611 = v$606[1];
return basis$0List$1.filter$417(function(x$609){var t$13918;
var fix$13916 = {};
fix$13916.$exists = function(v$5447){lab$exists: while (true) {if (v$5447 == null) {return false;
} else {var v$5448 = v$5447;
var v$5449 = v$5448[0];
var v$5450 = v$5448[1];
if (v$5041([v$5449,x$609])) {return true;
} else {var t$13917 = v$5450;
var v$5447 = t$13917;
continue lab$exists;
};
};
};
};
var exists$5446 = fix$13916.$exists;
t$13918 = (exists$5446(v$611));
return t$13918?false:true;
},v$610);
};
tuscheme$0tuscheme$1.elemsC$613 = function(v$616){return v$616[1];
};
tuscheme$0tuscheme$1.singleC$621 = function(x$624){return [0,[x$624,null]];
};
tuscheme$0tuscheme$1.emptyC$625 = function(v$13698){return [0,null];
};
tuscheme$0tuscheme$1.joinC$626 = function(v$629){var v$633 = v$629[1];
return [0,basis$0List$1.concat$296(basis$0List$1.map$697(function(v$5479){return v$5479[1];
},v$633))];
};
tuscheme$0tuscheme$1.mapC$634 = function(f$637,v$640){var v$647 = v$640[1];
return [0,basis$0List$1.map$697(f$637,v$647)];
};
tuscheme$0tuscheme$1.filterC$648 = function(p$651,v$654){var v$661 = v$654[1];
return [0,basis$0List$1.filter$417(p$651,v$661)];
};
tuscheme$0tuscheme$1.mapC2$662 = function(f$665,v$669){var v$676 = v$669[0];
var v$677 = v$669[1];
var v$5480;
var v$5488 = v$676[1];
v$5480 = [0,basis$0List$1.map$697(function(x$10625){var v$10626 = v$677[1];
return [0,basis$0List$1.map$697(function(y$10627){return f$665([x$10625,y$10627]);
},v$10626)];
},v$5488)];
var v$5481 = v$5480[1];
return [0,basis$0List$1.concat$296(basis$0List$1.map$697(function(v$5482){return v$5482[1];
},v$5481))];
};
tuscheme$0tuscheme$1.delay$680 = function(f$683){return [[1,f$683]];
};
tuscheme$0tuscheme$1.demand$684 = function(cell$687){var v$693 = cell$687[0];
switch (v$693[0]) { case 1: {var v$698 = v$693[1];
var result$695 = v$698(0);
(cell$687[0] = [0,result$695],0);
return result$695;
 break; }default: {return v$693[1];
} };
};
var fix$13919 = {};
fix$13919.$streamGet = function(v$706){lab$streamGet: while (true) {switch (v$706[0]) { case 1: {return [1];
 break; }case 2: {var v$717 = v$706[1];
return [0,[v$717[0],v$717[1]]];
 break; }default: {var v$720 = v$706[1];
var t$13920;
var v$5498 = v$720[0];
switch (v$5498[0]) { case 1: {var v$5499 = v$5498[1];
var result$5500 = v$5499(0);
(v$720[0] = [0,result$5500],0);
t$13920 = result$5500;
 break; }default: {t$13920 = v$5498[1];
} };
var t$13921 = t$13920;
var v$706 = t$13921;
continue lab$streamGet;
} };
};
};
tuscheme$0tuscheme$1.streamGet$703 = fix$13919.$streamGet;
tuscheme$0tuscheme$1.streamOfList$721 = function(xs$724){var b$5503 = [1];
var fix$13922 = {};
fix$13922.$foldr = function(v$5506){if (v$5506 == null) {return b$5503;
} else {var v$5507 = v$5506;
var v$5508 = v$5507[0];
var v$5509 = v$5507[1];
var v$10628 = [v$5508,fix$13922.$foldr(v$5509)];
return [2,v$10628];
};
};
var foldr$5505 = fix$13922.$foldr;
return foldr$5505(xs$724);
};
var fix$13923 = {};
fix$13923.$listOfStream = function(xs$729){var v$735 = tuscheme$0tuscheme$1.streamGet$703(xs$729);
switch (v$735[0]) { case 1: {return null;
 break; }default: {var v$736 = v$735[1];
var v$737 = v$736[0];
var v$738 = v$736[1];
return [v$737,fix$13923.$listOfStream(v$738)];
} };
};
tuscheme$0tuscheme$1.listOfStream$726 = fix$13923.$listOfStream;
tuscheme$0tuscheme$1.delayedStream$739 = function(action$742){return [0,[[1,action$742]]];
};
var fix$13924 = {};
fix$13924.$streamOfEffects = function(action$746){return [0,[[1,function(v$748){var v$753 = action$746(0);
switch (v$753[0]) { case 1: {return [1];
 break; }default: {return [2,[v$753[1],fix$13924.$streamOfEffects(action$746)]];
} };
}]]];
};
tuscheme$0tuscheme$1.streamOfEffects$743 = fix$13924.$streamOfEffects;
tuscheme$0tuscheme$1.filelines$755 = function(infile$758){return tuscheme$0tuscheme$1.streamOfEffects$743(function(v$760){return tuscheme$0stubs$1.inputLine$85(infile$758[0],infile$758[1]);
});
};
var fix$13925 = {};
fix$13925.$streamRepeat = function(x$764){return [0,[[1,function(v$766){return [2,[x$764,fix$13925.$streamRepeat(x$764)]];
}]]];
};
tuscheme$0tuscheme$1.streamRepeat$761 = fix$13925.$streamRepeat;
var fix$13926 = {};
fix$13926.$streamOfUnfold = function(next$770,state$773){return [0,[[1,function(v$775){var v$781 = next$770(state$773);
switch (v$781[0]) { case 1: {return [1];
 break; }default: {var v$782 = v$781[1];
var v$783 = v$782[0];
var v$784 = v$782[1];
return [2,[v$783,fix$13926.$streamOfUnfold(next$770,v$784)]];
} };
}]]];
};
tuscheme$0tuscheme$1.streamOfUnfold$767 = fix$13926.$streamOfUnfold;
tuscheme$0tuscheme$1.naturals$785;
var fix$13927 = {};
fix$13927.$streamOfUnfold = function(state$10632){return [0,[[1,function(v$10633){var v$10634 = [0,[state$10632,SmlPrims.chk_ovf_i32(state$10632 + 1)]];
switch (v$10634[0]) { case 1: {return [1];
 break; }default: {var v$10635 = v$10634[1];
var v$10636 = v$10635[0];
var v$10637 = v$10635[1];
return [2,[v$10636,fix$13927.$streamOfUnfold(v$10637)]];
} };
}]]];
};
var streamOfUnfold$10631 = fix$13927.$streamOfUnfold;
tuscheme$0tuscheme$1.naturals$785 = (streamOfUnfold$10631(0));
tuscheme$0tuscheme$1.preStream$789 = function(v$799,v$800){var fix$13928 = {};
fix$13928.$streamOfUnfold = function(state$10642){return [0,[[1,function(v$10643){var v$10644;
v$799(0);
v$10644 = (tuscheme$0tuscheme$1.streamGet$703(state$10642));
switch (v$10644[0]) { case 1: {return [1];
 break; }default: {var v$10645 = v$10644[1];
var v$10646 = v$10645[0];
var v$10647 = v$10645[1];
return [2,[v$10646,fix$13928.$streamOfUnfold(v$10647)]];
} };
}]]];
};
var streamOfUnfold$10641 = fix$13928.$streamOfUnfold;
return streamOfUnfold$10641(v$800);
};
tuscheme$0tuscheme$1.postStream$801 = function(v$819,v$820){var fix$13929 = {};
fix$13929.$streamOfUnfold = function(state$10655){return [0,[[1,function(v$10656){var v$10657;
var v$10662 = tuscheme$0tuscheme$1.streamGet$703(state$10655);
switch (v$10662[0]) { case 1: {v$10657 = [1];
 break; }default: {var v$10663 = v$10662[1];
var v$10664 = v$10663[0];
v$820(v$10664);
v$10657 = v$10662;
} };
switch (v$10657[0]) { case 1: {return [1];
 break; }default: {var v$10658 = v$10657[1];
var v$10659 = v$10658[0];
var v$10660 = v$10658[1];
return [2,[v$10659,fix$13929.$streamOfUnfold(v$10660)]];
} };
}]]];
};
var streamOfUnfold$10654 = fix$13929.$streamOfUnfold;
return streamOfUnfold$10654(v$819);
};
var fix$13930 = {};
fix$13930.$streamMap = function(f$824,xs$827){return [0,[[1,function(v$829){var v$835 = tuscheme$0tuscheme$1.streamGet$703(xs$827);
switch (v$835[0]) { case 1: {return [1];
 break; }default: {var v$836 = v$835[1];
var v$837 = v$836[0];
var v$838 = v$836[1];
return [2,[f$824(v$837),fix$13930.$streamMap(f$824,v$838)]];
} };
}]]];
};
tuscheme$0tuscheme$1.streamMap$821 = fix$13930.$streamMap;
var fix$13931 = {};
fix$13931.$streamFilter = function(p$842,xs$845){return [0,[[1,function(v$847){var v$853 = tuscheme$0tuscheme$1.streamGet$703(xs$845);
switch (v$853[0]) { case 1: {return [1];
 break; }default: {var v$858 = v$853[1];
var v$859 = v$858[0];
var v$860 = v$858[1];
if (p$842(v$859)) {return [2,[v$859,fix$13931.$streamFilter(p$842,v$860)]];
} else {return fix$13931.$streamFilter(p$842,v$860);
};
} };
}]]];
};
tuscheme$0tuscheme$1.streamFilter$839 = fix$13931.$streamFilter;
var fix$13932 = {};
fix$13932.$streamFold = function(f$864,z$867,xs$870){lab$streamFold: while (true) {var v$876 = tuscheme$0tuscheme$1.streamGet$703(xs$870);
switch (v$876[0]) { case 1: {return z$867;
 break; }default: {var v$877 = v$876[1];
var v$878 = v$877[0];
var v$879 = v$877[1];
var t$13933 = f$864;
var t$13934 = f$864([v$878,z$867]);
var t$13935 = v$879;
var f$864 = t$13933;
var z$867 = t$13934;
var xs$870 = t$13935;
continue lab$streamFold;
} };
};
};
tuscheme$0tuscheme$1.streamFold$861 = fix$13932.$streamFold;
var fix$13936 = {};
fix$13936.$streamZip = function(v$907,v$908){return [0,[[1,function(v$886){var v$9422 = tuscheme$0tuscheme$1.streamGet$703(v$907);
var v$9423 = tuscheme$0tuscheme$1.streamGet$703(v$908);
switch (v$9422[0]) { case 0: {switch (v$9423[0]) { case 0: {var v$900 = v$9422[1];
var v$901 = v$900[0];
var v$902 = v$900[1];
var v$903 = v$9423[1];
var v$904 = v$903[0];
var v$905 = v$903[1];
return [2,[[v$901,v$904],fix$13936.$streamZip(v$902,v$905)]];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
}]]];
};
tuscheme$0tuscheme$1.streamZip$880 = fix$13936.$streamZip;
tuscheme$0tuscheme$1.streamConcat$909 = function(xss$912){var fix$13937 = {};
fix$13937.$get = function(v$938,v$939){lab$get: while (true) {var v$923 = tuscheme$0tuscheme$1.streamGet$703(v$938);
switch (v$923[0]) { case 0: {var v$925 = v$923[1];
return [0,[v$925[0],[v$925[1],v$939]]];
 break; }default: {var v$933 = tuscheme$0tuscheme$1.streamGet$703(v$939);
switch (v$933[0]) { case 0: {var v$935 = v$933[1];
var v$936 = v$935[0];
var v$937 = v$935[1];
var t$13938 = v$936;
var t$13939 = v$937;
var v$938 = t$13938;
var v$939 = t$13939;
continue lab$get;
 break; }default: {return [1];
} };
} };
};
};
var get$913 = fix$13937.$get;
var fix$13940 = {};
fix$13940.$streamOfUnfold = function(state$10667){return [0,[[1,function(v$10668){var v$10669 = get$913(state$10667[0],state$10667[1]);
switch (v$10669[0]) { case 1: {return [1];
 break; }default: {var v$10670 = v$10669[1];
var v$10671 = v$10670[0];
var v$10672 = v$10670[1];
return [2,[v$10671,fix$13940.$streamOfUnfold(v$10672)]];
} };
}]]];
};
var streamOfUnfold$10666 = fix$13940.$streamOfUnfold;
return streamOfUnfold$10666([[1],xss$912]);
};
tuscheme$0tuscheme$1.streamConcatMap$940 = function(f$943,xs$946){var t$13943 = tuscheme$0tuscheme$1.streamConcat$909;
var t$13942;
var fix$13941 = {};
fix$13941.$streamMap = function(xs$10675){return [0,[[1,function(v$10676){var v$10677 = tuscheme$0tuscheme$1.streamGet$703(xs$10675);
switch (v$10677[0]) { case 1: {return [1];
 break; }default: {var v$10678 = v$10677[1];
var v$10679 = v$10678[0];
var v$10680 = v$10678[1];
return [2,[f$943(v$10679),fix$13941.$streamMap(v$10680)]];
} };
}]]];
};
var streamMap$10674 = fix$13941.$streamMap;
t$13942 = (streamMap$10674(xs$946));
return t$13943(t$13942);
};
tuscheme$0tuscheme$1.s$nnn$947 = function(v$952,v$953){var t$13946 = tuscheme$0tuscheme$1.streamConcat$909;
var t$13944;
var xs$5519 = [v$952,[v$953,null]];
var b$5522 = [1];
var fix$13945 = {};
fix$13945.$foldr = function(v$5525){if (v$5525 == null) {return b$5522;
} else {var v$5526 = v$5525;
var v$5527 = v$5526[0];
var v$5528 = v$5526[1];
var v$5529 = [v$5527,fix$13945.$foldr(v$5528)];
return [2,v$5529];
};
};
var foldr$5524 = fix$13945.$foldr;
t$13944 = (foldr$5524(xs$5519));
return t$13946(t$13944);
};
var fix$13947 = {};
fix$13947.$streamTake = function(v$965,v$13570){switch (v$965) { case 0: {return null;
 break; }default: {var v$972 = tuscheme$0tuscheme$1.streamGet$703(v$13570);
switch (v$972[0]) { case 0: {var v$974 = v$972[1];
var v$975 = v$974[0];
var v$976 = v$974[1];
return [v$975,fix$13947.$streamTake(SmlPrims.chk_ovf_i32(v$965 - 1),v$976)];
 break; }default: {return null;
} };
} };
};
tuscheme$0tuscheme$1.streamTake$954 = fix$13947.$streamTake;
var fix$13948 = {};
fix$13948.$streamDrop = function(v$989,v$13571){lab$streamDrop: while (true) {switch (v$989) { case 0: {return v$13571;
 break; }default: {var v$995 = tuscheme$0tuscheme$1.streamGet$703(v$13571);
switch (v$995[0]) { case 0: {var v$997 = v$995[1];
var v$998 = v$997[1];
var t$13949 = SmlPrims.chk_ovf_i32(v$989 - 1);
var t$13950 = v$998;
var v$989 = t$13949;
var v$13571 = t$13950;
continue lab$streamDrop;
 break; }default: {return [1];
} };
} };
};
};
tuscheme$0tuscheme$1.streamDrop$978 = fix$13948.$streamDrop;
tuscheme$0tuscheme$1.pure$1000 = function(y$1003,xs$1006){return [0,[[0,y$1003],xs$1006]];
};
tuscheme$0tuscheme$1.s$jtl$1007 = function(v$1049,v$1050){return function(xs$1014){var v$1024 = v$1049(xs$1014);
switch (v$1024[0]) { case 1: {return [1];
 break; }default: {var v$1025 = v$1024[1];
var v$1026 = v$1025[0];
switch (v$1026[0]) { case 1: {return [0,[[1,v$1026[1]],v$1025[1]]];
 break; }default: {var v$1047 = v$1026[1];
var v$1048 = v$1025[1];
var v$1039 = v$1050(v$1048);
switch (v$1039[0]) { case 1: {return [1];
 break; }default: {var v$1040 = v$1039[1];
var v$1041 = v$1040[0];
switch (v$1041[0]) { case 1: {return [0,[[1,v$1041[1]],v$1040[1]]];
 break; }default: {var v$1045 = v$1041[1];
var v$1046 = v$1040[1];
return [0,[[0,v$1047(v$1045)],v$1046]];
} };
} };
} };
} };
};
};
tuscheme$0tuscheme$1.s$jdl$1051 = function(v$1056,v$1057){return tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5531){return [0,[[0,v$1056],xs$5531]];
},v$1057);
};
tuscheme$0tuscheme$1.s$jsl$1058 = function(v$1073,v$1074){return function(xs$1065){var v$1070 = v$1073(xs$1065);
switch (v$1070[0]) { case 0: {var v$1072 = v$1070[1];
return [0,v$1072];
 break; }default: {return v$1074(xs$1065);
} };
};
};
tuscheme$0tuscheme$1.pzero$1075 = function(v$1077){return [1];
};
tuscheme$0tuscheme$1.anyParser$1078 = function(ts$1081){var fix$13951 = {};
fix$13951.$foldr = function(v$5536){if (v$5536 == null) {return function(v$10681){return [1];
};
} else {var v$5537 = v$5536;
var v$5538 = v$5537[0];
var v$5539 = v$5537[1];
var v$13329 = fix$13951.$foldr(v$5539);
return function(xs$10685){var v$10686 = v$5538(xs$10685);
switch (v$10686[0]) { case 0: {var v$10687 = v$10686[1];
return [0,v$10687];
 break; }default: {return v$13329(xs$10685);
} };
};
};
};
var foldr$5535 = fix$13951.$foldr;
return foldr$5535(ts$1081);
};
tuscheme$0tuscheme$1.s$jt$1082 = function(v$1087,v$1088){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5551){return [0,[[0,function(x$10691){return function(y$10692){return x$10691;
};
}],xs$5551]];
},v$1087),v$1088);
};
tuscheme$0tuscheme$1.s$tl$1089 = function(v$1094,v$1095){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5560){return [0,[[0,function(x$10696){return function(y$10697){return y$10697;
};
}],xs$5560]];
},v$1094),v$1095);
};
tuscheme$0tuscheme$1.s$jd$1096 = function(v$1103,v$1104){return tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5569){return [0,[[0,function(v$10699){return v$1103;
}],xs$5569]];
},v$1104);
};
tuscheme$0tuscheme$1.one$1105 = function(xs$1108){var v$1114 = tuscheme$0tuscheme$1.streamGet$703(xs$1108);
switch (v$1114[0]) { case 1: {return [1];
 break; }default: {var v$1115 = v$1114[1];
return [0,[[0,v$1115[0]],v$1115[1]]];
} };
};
tuscheme$0tuscheme$1.eos$1118 = function(xs$1121){switch ((tuscheme$0tuscheme$1.streamGet$703(xs$1121))[0]) { case 1: {return [0,[[0,0],[1]]];
 break; }default: {return [1];
} };
};
tuscheme$0tuscheme$1.peek$1126 = function(tx$1129,xs$1132){var v$1138 = tx$1129(xs$1132);
switch (v$1138[0]) { case 0: {var v$1140 = v$1138[1];
var v$1141 = v$1140[0];
switch (v$1141[0]) { case 0: {var v$1143 = v$1141[1];
return [0,v$1143];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
tuscheme$0tuscheme$1.rewind$1145 = function(tx$1148,xs$1151){var v$1156 = tx$1148(xs$1151);
switch (v$1156[0]) { case 0: {return [0,[v$1156[1][0],xs$1151]];
 break; }default: {return [1];
} };
};
tuscheme$0tuscheme$1.sat$1160 = function(p$1163,tx$1166,xs$1169){var v$1178 = tx$1166(xs$1169);
switch (v$1178[0]) { case 0: {var v$1180 = v$1178[1];
var v$1181 = v$1180[0];
switch (v$1181[0]) { case 0: {var v$1187 = v$1181[1];
return (p$1163(v$1187))?v$1178:[1];
 break; }default: {return v$1178;
} };
 break; }default: {return v$1178;
} };
};
tuscheme$0tuscheme$1.eqx$1190 = function(v$5047,y$1193,tx$5575,xs$5576){var v$5577 = tx$5575(xs$5576);
switch (v$5577[0]) { case 0: {var v$5578 = v$5577[1];
var v$5579 = v$5578[0];
switch (v$5579[0]) { case 0: {var v$5580 = v$5579[1];
return (v$5047([y$1193,v$5580]))?v$5577:[1];
 break; }default: {return v$5577;
} };
 break; }default: {return v$5577;
} };
};
tuscheme$0tuscheme$1.s$jdlm$1197 = function(v$1228,v$1229){return function(xs$1204){var v$1214 = v$1229(xs$1204);
switch (v$1214[0]) { case 1: {return [1];
 break; }default: {var v$1215 = v$1214[1];
var v$1216 = v$1215[0];
switch (v$1216[0]) { case 1: {return [0,[[1,v$1216[1]],v$1215[1]]];
 break; }default: {var v$1226 = v$1216[1];
var v$1227 = v$1215[1];
var v$1224 = v$1228(v$1226);
switch (v$1224[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$1224[1]],v$1227]];
} };
} };
} };
};
};
tuscheme$0tuscheme$1.s$jcl$1230 = function(v$1248,v$1249){return function(xs$1237){var v$1243 = v$1248(xs$1237);
switch (v$1243[0]) { case 0: {var v$1245 = v$1243[1];
switch (v$1245[0][0]) { case 0: {return v$1249(xs$1237);
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
};
tuscheme$0tuscheme$1.notFollowedBy$1250 = function(t$1253,xs$1256){switch ((t$1253(xs$1256))[0]) { case 1: {return [0,[[0,0],xs$1256]];
 break; }default: {return [1];
} };
};
var fix$13952 = {};
fix$13952.$many = function(t$1264){var v$9432 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5613){return [0,[[0,function(x$10704){return function(y$10705){return [x$10704,y$10705];
};
}],xs$5613]];
},t$1264),function(xs$1268){return (fix$13952.$many(t$1264))(xs$1268);
});
var v$9433;
var y$5617 = null;
v$9433 = (function(xs$5618){return [0,[[0,y$5617],xs$5618]];
});
return function(xs$5606){var v$5607 = v$9432(xs$5606);
switch (v$5607[0]) { case 0: {var v$5608 = v$5607[1];
return [0,v$5608];
 break; }default: {return v$9433(xs$5606);
} };
};
};
tuscheme$0tuscheme$1.many$1261 = fix$13952.$many;
tuscheme$0tuscheme$1.many1$1269 = function(t$1272){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5623){return [0,[[0,function(x$10709){return function(y$10710){return [x$10709,y$10710];
};
}],xs$5623]];
},t$1272),tuscheme$0tuscheme$1.many$1261(t$1272));
};
tuscheme$0tuscheme$1.optional$1274 = function(t$1277){var v$9438 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5637){return [0,[[0,function(v$10712){return [0,v$10712];
}],xs$5637]];
},t$1277);
var v$9439;
var y$5638 = [1];
v$9439 = (function(xs$5639){return [0,[[0,y$5638],xs$5639]];
});
return function(xs$5630){var v$5631 = v$9438(xs$5630);
switch (v$5631[0]) { case 0: {var v$5632 = v$5631[1];
return [0,v$5632];
 break; }default: {return v$9439(xs$5630);
} };
};
};
tuscheme$0tuscheme$1.s$jtla$1279 = function(v$1312,v$1313){return function(xs$1286){var v$1300 = (tuscheme$0tuscheme$1.s$jtl$1007(v$1312,v$1313))(xs$1286);
switch (v$1300[0]) { case 1: {return [1];
 break; }default: {var v$1301 = v$1300[1];
var v$1302 = v$1301[0];
switch (v$1302[0]) { case 0: {var v$1304 = v$1302[1];
switch (v$1304[0]) { case 0: {return [0,[[0,v$1304[1]],v$1301[1]]];
 break; }default: {return [0,[[1,v$1304[1]],v$1301[1]]];
} };
 break; }default: {return [0,[[1,v$1302[1]],v$1301[1]]];
} };
} };
};
};
tuscheme$0tuscheme$1.s$jdla$1314 = function(v$1319,v$1320){return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$5641){return [0,[[0,v$1319],xs$5641]];
},v$1320);
};
tuscheme$0tuscheme$1.srclocString$1321 = function(v$1326,v$1327){return (v$1326 + ", line ") + (tuscheme$0tuscheme$1.intString$351(v$1327));
};
tuscheme$0tuscheme$1.toplevel_error_format$1330 = [0];
tuscheme$0tuscheme$1.synerrormsg$1331 = function(v$1347,v$1348){return function(strings$1338){var t$13954;
var t$13953;
var v$9446 = tuscheme$0tuscheme$1.toplevel_error_format$1330[0];
var v$9447 = 1;
switch (v$9446) { case 0: {switch (v$9447) { case 0: {t$13953 = true;
 break; }default: {t$13953 = false;
} };
 break; }case 1: {switch (v$9447) { case 1: {t$13953 = true;
 break; }default: {t$13953 = false;
} };
 break; } };
t$13954 = (t$13953?(v$1347 == "standard input"):false);
return t$13954?(SmlPrims.concat(["syntax error: ",strings$1338])):(SmlPrims.concat(["syntax error in ",[(v$1347 + ", line ") + (tuscheme$0tuscheme$1.intString$351(v$1348)),[": ",strings$1338]]]));
};
};
tuscheme$0tuscheme$1.en$Located$1349 = new String("Located");
tuscheme$0tuscheme$1.atLoc$1350 = function(loc$1353,f$1356,a$1359){try {return f$1356(a$1359);
} catch(v$13955) {return (function(v$1387){var t$13956 = v$1387;
if (t$13956[0] == tuscheme$0tuscheme$1.en$RuntimeError$225) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == tuscheme$0tuscheme$1.en$NotFound$138) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == tuscheme$0stubs$1.en$IO_Io$64) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == CompilerInitial.en$Div$47) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == CompilerInitial.en$Overflow$50) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == CompilerInitial.en$Subscript$52) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == CompilerInitial.en$Size$53) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == tuscheme$0tuscheme$1.en$TypeError$87) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {if (t$13956[0] == tuscheme$0tuscheme$1.en$BugInTypeChecking$88) {throw [tuscheme$0tuscheme$1.en$Located$1349,[loc$1353,v$1387]];
} else {throw v$1387;
};
};
};
};
};
};
};
};
};
})(v$13955);
};
};
tuscheme$0tuscheme$1.fillComplaintTemplate$1388 = function(v$1424,v$1425){var v$1421 = basis$0Substring$1.position$841(" <at loc>",[v$1424,0,v$1424.length]);
var v$1422 = v$1421[0];
var v$1423 = v$1421[1];
var v$5666 = v$1423[0];
var v$5667 = v$1423[1];
var v$5668 = v$1423[2];
var suffix$1397 = (9 > v$5668)?[v$5666,SmlPrims.chk_ovf_i32(v$5667 + v$5668),0]:[v$5666,SmlPrims.chk_ovf_i32(v$5667 + 9),SmlPrims.chk_ovf_i32(v$5668 - 9)];
var splice_in$1398;
var s$5670;
switch (v$1425[0]) { case 1: {s$5670 = "";
 break; }default: {var v$1414 = v$1425[1];
var v$1415 = v$1414[0];
var t$13958;
var t$13957;
var v$9456 = tuscheme$0tuscheme$1.toplevel_error_format$1330[0];
var v$9457 = 1;
switch (v$9456) { case 0: {switch (v$9457) { case 0: {t$13957 = true;
 break; }default: {t$13957 = false;
} };
 break; }case 1: {switch (v$9457) { case 1: {t$13957 = true;
 break; }default: {t$13957 = false;
} };
 break; } };
t$13958 = (t$13957?(v$1415 == "standard input"):false);
if (t$13958) {s$5670 = "";
} else {var v$5685 = v$1414[0];
var v$5686 = v$1414[1];
s$5670 = (" in " + ((v$5685 + ", line ") + (tuscheme$0tuscheme$1.intString$351(v$5686))));
};
} };
splice_in$1398 = [s$5670,0,s$5670.length];
if (v$1423[2] == 0) {return v$1424;
} else {return basis$0Substring$1.concat$355([v$1422,[splice_in$1398,[suffix$1397,null]]]);
};
};
tuscheme$0tuscheme$1.errorAt$1426 = function(msg$1429,loc$1432){return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(loc$1432[0],loc$1432[1]))([msg$1429,null])];
};
tuscheme$0tuscheme$1.locatedStream$1433 = function(v$1439,v$1440){var locations$1438 = tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(v$1439),tuscheme$0tuscheme$1.streamDrop$978(1,tuscheme$0tuscheme$1.naturals$785));
return tuscheme$0tuscheme$1.streamZip$880(locations$1438,v$1440);
};
var fix$13959 = {};
fix$13959.$drainLine = function(v$1446){lab$drainLine: while (true) {switch (v$1446[0]) { case 1: {return [1];
 break; }case 0: {var v$1459 = v$1446[1];
var t$13960;
var v$5691 = v$1459[0];
switch (v$5691[0]) { case 1: {var v$5692 = v$5691[1];
var result$5693 = v$5692(0);
(v$1459[0] = [0,result$5693],0);
t$13960 = result$5693;
 break; }default: {t$13960 = v$5691[1];
} };
var t$13961 = t$13960;
var v$1446 = t$13961;
continue lab$drainLine;
 break; }default: {var v$1460 = v$1446[1];
switch (v$1460[0][0]) { case 1: {return v$1460[1];
 break; }default: {var v$1464 = v$1460[1];
var t$13962 = v$1464;
var v$1446 = t$13962;
continue lab$drainLine;
} };
} };
};
};
tuscheme$0tuscheme$1.drainLine$1443 = fix$13959.$drainLine;
tuscheme$0tuscheme$1.eol$1487 = function(xs$1490){var v$5699;
var v$10727 = tuscheme$0tuscheme$1.streamGet$703(xs$1490);
switch (v$10727[0]) { case 1: {v$5699 = [1];
 break; }default: {var v$10728 = v$10727[1];
v$5699 = [0,[[0,v$10728[0]],v$10728[1]]];
} };
switch (v$5699[0]) { case 1: {return [1];
 break; }default: {var v$5700 = v$5699[1];
var v$5701 = v$5700[0];
switch (v$5701[0]) { case 1: {return [0,[[1,v$5701[1]],v$5700[1]]];
 break; }default: {var v$5702 = v$5701[1];
var v$5703 = v$5700[1];
var v$5704;
switch (v$5702[0]) { case 1: {var v$10730 = v$5702[1];
v$5704 = [0,v$10730];
 break; }default: {v$5704 = [1];
} };
switch (v$5704[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$5704[1]],v$5703]];
} };
} };
} };
};
tuscheme$0tuscheme$1.inline$1491 = function(xs$1494){var v$9471;
var v$9472 = tuscheme$0tuscheme$1.many$1261(function(v$13704){return tuscheme$0tuscheme$1.eol$1487(v$13704);
});
v$9471 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5732){return [0,[[0,function(x$10736){return function(y$10737){return y$10737;
};
}],xs$5732]];
},v$9472),function(xs$10738){var v$10739 = tuscheme$0tuscheme$1.streamGet$703(xs$10738);
switch (v$10739[0]) { case 1: {return [1];
 break; }default: {var v$10740 = v$10739[1];
return [0,[[0,v$10740[0]],v$10740[1]]];
} };
}));
var v$5714 = v$9471(xs$1494);
switch (v$5714[0]) { case 1: {return [1];
 break; }default: {var v$5715 = v$5714[1];
var v$5716 = v$5715[0];
switch (v$5716[0]) { case 1: {return [0,[[1,v$5716[1]],v$5715[1]]];
 break; }default: {var v$5717 = v$5716[1];
var v$5718 = v$5715[1];
var v$5719;
switch (v$5717[0]) { case 0: {var v$10744 = v$5717[1];
v$5719 = [0,v$10744];
 break; }default: {v$5719 = [1];
} };
switch (v$5719[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$5719[1]],v$5718]];
} };
} };
} };
};
tuscheme$0tuscheme$1.srcloc$1495 = function(xs$1498){var tx$5737 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5744){return [0,[[0,function(v$10746){return v$10746[0];
}],xs$5744]];
},function(v$13705){return tuscheme$0tuscheme$1.inline$1491(v$13705);
});
var v$5739 = tx$5737(xs$1498);
switch (v$5739[0]) { case 0: {return [0,[v$5739[1][0],xs$1498]];
 break; }default: {return [1];
} };
};
tuscheme$0tuscheme$1.isDelim$1499 = function(c$1502){if ((c$1502 == 32)?true:((9 <= c$1502)?(c$1502 <= 13):false)) {return true;
} else {var fix$13963 = {};
fix$13963.$loop = function(j$5751){lab$loop: while (true) {if (j$5751 >= 7) {return false;
} else {if (("()[]{};".charCodeAt(j$5751)) == c$1502) {return true;
} else {var t$13964 = SmlPrims.chk_ovf_i32(j$5751 + 1);
var j$5751 = t$13964;
continue lab$loop;
};
};
};
};
var loop$5750 = fix$13963.$loop;
return loop$5750(0);
};
};
tuscheme$0tuscheme$1.whitespace$1507 = tuscheme$0tuscheme$1.many$1261(function(xs$5754){var v$5755;
var v$10748 = tuscheme$0tuscheme$1.streamGet$703(xs$5754);
switch (v$10748[0]) { case 1: {v$5755 = [1];
 break; }default: {var v$10749 = v$10748[1];
v$5755 = [0,[[0,v$10749[0]],v$10749[1]]];
} };
switch (v$5755[0]) { case 0: {var v$5756 = v$5755[1];
var v$5757 = v$5756[0];
switch (v$5757[0]) { case 0: {var v$5758 = v$5757[1];
return ((v$5758 == 32)?true:((9 <= v$5758)?(v$5758 <= 13):false))?v$5755:[1];
 break; }default: {return v$5755;
} };
 break; }default: {return v$5755;
} };
});
tuscheme$0tuscheme$1.intChars$1508 = function(isDelim$1511){var t$13968 = tuscheme$0tuscheme$1.s$jtl$1007;
var t$13967;
var v$9478 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5773){return [0,[[0,function(x$10767){return function(y$10768){return [x$10767,y$10768];
};
}],xs$5773]];
},function(xs$10769){var v$10770;
var v$10771 = tuscheme$0tuscheme$1.streamGet$703(xs$10769);
switch (v$10771[0]) { case 1: {v$10770 = [1];
 break; }default: {var v$10772 = v$10771[1];
v$10770 = [0,[[0,v$10772[0]],v$10772[1]]];
} };
switch (v$10770[0]) { case 0: {var v$10773 = v$10770[1];
var v$10774 = v$10773[0];
switch (v$10774[0]) { case 0: {var v$10775 = v$10774[1];
return (45 == v$10775)?v$10770:[1];
 break; }default: {return v$10770;
} };
 break; }default: {return v$10770;
} };
});
t$13967 = (function(xs$5766){var v$5767 = v$9478(xs$5766);
switch (v$5767[0]) { case 0: {var v$5768 = v$5767[1];
return [0,v$5768];
 break; }default: {return [0,[[0,function(x$10781){return x$10781;
}],xs$5766]];
} };
});
var t$13965;
var v$9484 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5821){return [0,[[0,function(x$10804){return function(y$10805){return [x$10804,y$10805];
};
}],xs$5821]];
},function(xs$10806){var v$10807;
var v$10808 = tuscheme$0tuscheme$1.streamGet$703(xs$10806);
switch (v$10808[0]) { case 1: {v$10807 = [1];
 break; }default: {var v$10809 = v$10808[1];
v$10807 = [0,[[0,v$10809[0]],v$10809[1]]];
} };
switch (v$10807[0]) { case 0: {var v$10810 = v$10807[1];
var v$10811 = v$10810[0];
switch (v$10811[0]) { case 0: {var v$10812 = v$10811[1];
return ((48 <= v$10812)?(v$10812 <= 57):false)?v$10807:[1];
 break; }default: {return v$10807;
} };
 break; }default: {return v$10807;
} };
}),tuscheme$0tuscheme$1.many$1261(function(xs$10813){var v$10814;
var v$10816 = tuscheme$0tuscheme$1.streamGet$703(xs$10813);
switch (v$10816[0]) { case 1: {v$10814 = [1];
 break; }default: {var v$10817 = v$10816[1];
v$10814 = [0,[[0,v$10817[0]],v$10817[1]]];
} };
switch (v$10814[0]) { case 0: {var v$10818 = v$10814[1];
var v$10819 = v$10818[0];
switch (v$10819[0]) { case 0: {var v$10820 = v$10819[1];
return ((48 <= v$10820)?(v$10820 <= 57):false)?v$10814:[1];
 break; }default: {return v$10814;
} };
 break; }default: {return v$10814;
} };
}));
t$13965 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5811){return [0,[[0,function(x$10847){return function(y$10848){return x$10847;
};
}],xs$5811]];
},v$9484),function(xs$10849){var t$13966;
var v$10850;
var v$10851 = tuscheme$0tuscheme$1.streamGet$703(xs$10849);
switch (v$10851[0]) { case 1: {v$10850 = [1];
 break; }default: {var v$10852 = v$10851[1];
v$10850 = [0,[[0,v$10852[0]],v$10852[1]]];
} };
switch (v$10850[0]) { case 0: {var v$10853 = v$10850[1];
var v$10854 = v$10853[0];
switch (v$10854[0]) { case 0: {var v$10855 = v$10854[1];
t$13966 = (((isDelim$1511(v$10855))?false:true)?v$10850:[1]);
 break; }default: {t$13966 = v$10850;
} };
 break; }default: {t$13966 = v$10850;
} };
switch (t$13966[0]) { case 1: {return [0,[[0,0],xs$10849]];
 break; }default: {return [1];
} };
}));
return t$13968(t$13967,t$13965);
};
var fix$13969 = {};
fix$13969.$intFromChars = function(v$1516){if (v$1516 == null) {try {var x$10886 = SmlPrims.implode(v$1516);
var x$10887 = basis$0Int32$1.fromString$462(x$10886);
var v$10888 = basis$0General$1.valOf$130(x$10887);
return [0,v$10888];
} catch(v$14710) {return (function(Overflow$10889){var t$14711 = Overflow$10889;
if (t$14711[0] == CompilerInitial.en$Overflow$50) {return [1,"this interpreter can't read arbitrarily large integers"];
} else {throw Overflow$10889;
};
})(v$14710);
};
} else {var v$1525 = v$1516;
switch (v$1525[0]) { case 45: {var v$1527 = v$1525[1];
var v$9498 = fix$13969.$intFromChars(v$1527);
switch (v$9498[0]) { case 0: {var v$5874 = v$9498[1];
var v$10879 = SmlPrims.chk_ovf_i32(-(v$5874));
return [0,v$10879];
 break; }default: {var v$5876 = v$9498[1];
return [1,v$5876];
} };
 break; }default: {try {var x$10881 = SmlPrims.implode(v$1516);
var x$10882 = basis$0Int32$1.fromString$462(x$10881);
var v$10883 = basis$0General$1.valOf$130(x$10882);
return [0,v$10883];
} catch(v$14712) {return (function(Overflow$10884){var t$14713 = Overflow$10884;
if (t$14713[0] == CompilerInitial.en$Overflow$50) {return [1,"this interpreter can't read arbitrarily large integers"];
} else {throw Overflow$10884;
};
})(v$14712);
};
} };
};
};
tuscheme$0tuscheme$1.intFromChars$1513 = fix$13969.$intFromChars;
tuscheme$0tuscheme$1.intToken$1533 = function(isDelim$1536){var v$9505 = tuscheme$0tuscheme$1.intChars$1508(isDelim$1536);
return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$5882){return [0,[[0,function(v$13706){return tuscheme$0tuscheme$1.intFromChars$1513(v$13706);
}],xs$5882]];
},v$9505);
};
tuscheme$0tuscheme$1.leftString$1540 = function(v$1543){switch (v$1543) { case 1: {return "(";
 break; }case 0: {return "[";
 break; }default: {return "{";
} };
};
tuscheme$0tuscheme$1.rightString$1550 = function(v$1553){switch (v$1553) { case 1: {return ")";
 break; }case 0: {return "]";
 break; }default: {return "}";
} };
};
tuscheme$0tuscheme$1.bracketLexer$1563 = function(pretoken$1566){var v$9506;
var v$9508;
var v$9510;
var v$9512;
var v$9514;
var v$9516;
var v$9518 = [2,1];
v$9516 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5926){return [0,[[0,function(v$10920){return v$9518;
}],xs$5926]];
},function(xs$10921){var v$10922;
var v$10923 = tuscheme$0tuscheme$1.streamGet$703(xs$10921);
switch (v$10923[0]) { case 1: {v$10922 = [1];
 break; }default: {var v$10924 = v$10923[1];
v$10922 = [0,[[0,v$10924[0]],v$10924[1]]];
} };
switch (v$10922[0]) { case 0: {var v$10925 = v$10922[1];
var v$10926 = v$10925[0];
switch (v$10926[0]) { case 0: {var v$10927 = v$10926[1];
return (40 == v$10927)?v$10922:[1];
 break; }default: {return v$10922;
} };
 break; }default: {return v$10922;
} };
}));
var v$9517;
var v$9524 = [2,0];
v$9517 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5955){return [0,[[0,function(v$10959){return v$9524;
}],xs$5955]];
},function(xs$10960){var v$10961;
var v$10962 = tuscheme$0tuscheme$1.streamGet$703(xs$10960);
switch (v$10962[0]) { case 1: {v$10961 = [1];
 break; }default: {var v$10963 = v$10962[1];
v$10961 = [0,[[0,v$10963[0]],v$10963[1]]];
} };
switch (v$10961[0]) { case 0: {var v$10964 = v$10961[1];
var v$10965 = v$10964[0];
switch (v$10965[0]) { case 0: {var v$10966 = v$10965[1];
return (91 == v$10966)?v$10961:[1];
 break; }default: {return v$10961;
} };
 break; }default: {return v$10961;
} };
}));
v$9514 = (function(xs$5916){var v$5917 = v$9516(xs$5916);
switch (v$5917[0]) { case 0: {var v$5918 = v$5917[1];
return [0,v$5918];
 break; }default: {return v$9517(xs$5916);
} };
});
var v$9515;
var v$9530 = [2,2];
v$9515 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$5984){return [0,[[0,function(v$10998){return v$9530;
}],xs$5984]];
},function(xs$10999){var v$11000;
var v$11001 = tuscheme$0tuscheme$1.streamGet$703(xs$10999);
switch (v$11001[0]) { case 1: {v$11000 = [1];
 break; }default: {var v$11002 = v$11001[1];
v$11000 = [0,[[0,v$11002[0]],v$11002[1]]];
} };
switch (v$11000[0]) { case 0: {var v$11003 = v$11000[1];
var v$11004 = v$11003[0];
switch (v$11004[0]) { case 0: {var v$11005 = v$11004[1];
return (123 == v$11005)?v$11000:[1];
 break; }default: {return v$11000;
} };
 break; }default: {return v$11000;
} };
}));
v$9512 = (function(xs$5910){var v$5911 = v$9514(xs$5910);
switch (v$5911[0]) { case 0: {var v$5912 = v$5911[1];
return [0,v$5912];
 break; }default: {return v$9515(xs$5910);
} };
});
var v$9513;
var v$9536 = [0,1];
v$9513 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6013){return [0,[[0,function(v$11037){return v$9536;
}],xs$6013]];
},function(xs$11038){var v$11039;
var v$11040 = tuscheme$0tuscheme$1.streamGet$703(xs$11038);
switch (v$11040[0]) { case 1: {v$11039 = [1];
 break; }default: {var v$11041 = v$11040[1];
v$11039 = [0,[[0,v$11041[0]],v$11041[1]]];
} };
switch (v$11039[0]) { case 0: {var v$11042 = v$11039[1];
var v$11043 = v$11042[0];
switch (v$11043[0]) { case 0: {var v$11044 = v$11043[1];
return (41 == v$11044)?v$11039:[1];
 break; }default: {return v$11039;
} };
 break; }default: {return v$11039;
} };
}));
v$9510 = (function(xs$5904){var v$5905 = v$9512(xs$5904);
switch (v$5905[0]) { case 0: {var v$5906 = v$5905[1];
return [0,v$5906];
 break; }default: {return v$9513(xs$5904);
} };
});
var v$9511;
var v$9542 = [0,0];
v$9511 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6042){return [0,[[0,function(v$11076){return v$9542;
}],xs$6042]];
},function(xs$11077){var v$11078;
var v$11079 = tuscheme$0tuscheme$1.streamGet$703(xs$11077);
switch (v$11079[0]) { case 1: {v$11078 = [1];
 break; }default: {var v$11080 = v$11079[1];
v$11078 = [0,[[0,v$11080[0]],v$11080[1]]];
} };
switch (v$11078[0]) { case 0: {var v$11081 = v$11078[1];
var v$11082 = v$11081[0];
switch (v$11082[0]) { case 0: {var v$11083 = v$11082[1];
return (93 == v$11083)?v$11078:[1];
 break; }default: {return v$11078;
} };
 break; }default: {return v$11078;
} };
}));
v$9508 = (function(xs$5898){var v$5899 = v$9510(xs$5898);
switch (v$5899[0]) { case 0: {var v$5900 = v$5899[1];
return [0,v$5900];
 break; }default: {return v$9511(xs$5898);
} };
});
var v$9509;
var v$9548 = [0,2];
v$9509 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6071){return [0,[[0,function(v$11115){return v$9548;
}],xs$6071]];
},function(xs$11116){var v$11117;
var v$11118 = tuscheme$0tuscheme$1.streamGet$703(xs$11116);
switch (v$11118[0]) { case 1: {v$11117 = [1];
 break; }default: {var v$11119 = v$11118[1];
v$11117 = [0,[[0,v$11119[0]],v$11119[1]]];
} };
switch (v$11117[0]) { case 0: {var v$11120 = v$11117[1];
var v$11121 = v$11120[0];
switch (v$11121[0]) { case 0: {var v$11122 = v$11121[1];
return (125 == v$11122)?v$11117:[1];
 break; }default: {return v$11117;
} };
 break; }default: {return v$11117;
} };
}));
v$9506 = (function(xs$5892){var v$5893 = v$9508(xs$5892);
switch (v$5893[0]) { case 0: {var v$5894 = v$5893[1];
return [0,v$5894];
 break; }default: {return v$9509(xs$5892);
} };
});
var v$9507 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6097){return [0,[[0,function(v$11125){return [1,v$11125];
}],xs$6097]];
},pretoken$1566);
return function(xs$5886){var v$5887 = v$9506(xs$5886);
switch (v$5887[0]) { case 0: {var v$5888 = v$5887[1];
return [0,v$5888];
 break; }default: {return v$9507(xs$5886);
} };
};
};
tuscheme$0tuscheme$1.plusBracketsString$1568 = function(v$1571,v$1574){switch (v$1574[0]) { case 2: {switch (v$1574[1]) { case 1: {return "(";
 break; }case 0: {return "[";
 break; }default: {return "{";
} };
 break; }case 0: {switch (v$1574[1]) { case 1: {return ")";
 break; }case 0: {return "]";
 break; }default: {return "}";
} };
 break; }default: {var v$1591 = v$1574[1];
return v$1571(v$1591);
} };
};
tuscheme$0tuscheme$1.token$1592 = function(stream$1595){return (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6104){return [0,[[0,function(v$11127){return v$11127[1];
}],xs$6104]];
},function(v$13707){return tuscheme$0tuscheme$1.inline$1491(v$13707);
}))(stream$1595);
};
tuscheme$0tuscheme$1.noTokens$1596 = function(stream$1599){switch (((tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11131){return [0,[[0,function(v$11132){return v$11132[1];
}],xs$11131]];
},function(v$13708){return tuscheme$0tuscheme$1.inline$1491(v$13708);
}))(stream$1599))[0]) { case 1: {return [0,[[0,0],stream$1599]];
 break; }default: {return [1];
} };
};
tuscheme$0tuscheme$1.s$nn$1600 = function(p$1603){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6118){return [0,[[0,function(x$11142){return function(y$11143){return [x$11142,y$11143];
};
}],xs$6118]];
},function(xs$11144){var tx$11145 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11146){return [0,[[0,function(v$11147){return v$11147[0];
}],xs$11146]];
},function(v$13709){return tuscheme$0tuscheme$1.inline$1491(v$13709);
});
var v$11148 = tx$11145(xs$11144);
switch (v$11148[0]) { case 0: {return [0,[v$11148[1][0],xs$11144]];
 break; }default: {return [1];
} };
}),p$1603);
};
tuscheme$0tuscheme$1.s$jml$1604 = function(v$1609,v$1610){var v$9567;
var v$9568;
var msg$6141 = "expected " + v$1610;
v$9568 = (function(loc$6142){return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(loc$6142[0],loc$6142[1]))([msg$6141,null])];
});
v$9567 = (tuscheme$0tuscheme$1.s$jtla$1279(function(xs$6140){return [0,[[0,v$9568],xs$6140]];
},function(xs$11156){var tx$11157 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11158){return [0,[[0,function(v$11159){return v$11159[0];
}],xs$11158]];
},function(v$13710){return tuscheme$0tuscheme$1.inline$1491(v$13710);
});
var v$11160 = tx$11157(xs$11156);
switch (v$11160[0]) { case 0: {return [0,[v$11160[1][0],xs$11156]];
 break; }default: {return [1];
} };
}));
return function(xs$6133){var v$6134 = v$1609(xs$6133);
switch (v$6134[0]) { case 0: {var v$6135 = v$6134[1];
return [0,v$6135];
 break; }default: {return v$9567(xs$6133);
} };
};
};
tuscheme$0tuscheme$1.s$jal$1611 = function(v$1638,v$1639){return function(tokens$1618){var v$1624 = v$1638(tokens$1618);
switch (v$1624[0]) { case 0: {var v$1626 = v$1624[1];
switch (v$1626[0][0]) { case 0: {var v$1636 = v$1626[1];
var v$1633;
var v$6155;
var tx$11164 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11165){return [0,[[0,function(v$11166){return v$11166[0];
}],xs$11165]];
},function(v$13711){return tuscheme$0tuscheme$1.inline$1491(v$13711);
});
var v$11167 = tx$11164(tokens$1618);
switch (v$11167[0]) { case 0: {v$6155 = [0,[v$11167[1][0],tokens$1618]];
 break; }default: {v$6155 = [1];
} };
switch (v$6155[0]) { case 0: {var v$6156 = v$6155[1];
var v$6157 = v$6156[0];
switch (v$6157[0]) { case 0: {var v$6158 = v$6157[1];
v$1633 = [0,v$6158];
 break; }default: {v$1633 = [1];
} };
 break; }default: {v$1633 = [1];
} };
switch (v$1633[0]) { case 0: {var v$1635 = v$1633[1];
return [0,[[1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$1635[0],v$1635[1]))([v$1639,null])],v$1636]];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
};
tuscheme$0tuscheme$1.nodups$1640 = function(v$1671,v$1672){return function(v$1648){var v$1669 = v$1648[0];
var v$1670 = v$1648[1];
var fix$13970 = {};
fix$13970.$dup = function(v$1652){lab$dup: while (true) {if (v$1652 == null) {return [0,v$1670];
} else {var v$1666 = v$1652;
var v$1667 = v$1666[0];
var v$1668 = v$1666[1];
var t$13973;
var fix$13971 = {};
fix$13971.$exists = function(v$6177){lab$exists: while (true) {if (v$6177 == null) {return false;
} else {var v$6178 = v$6177;
var v$6179 = v$6178[0];
var v$6180 = v$6178[1];
if (v$6179 == v$1667) {return true;
} else {var t$13972 = v$6180;
var v$6177 = t$13972;
continue lab$exists;
};
};
};
};
var exists$6176 = fix$13971.$exists;
t$13973 = (exists$6176(v$1668));
if (t$13973) {var msg$6192 = (((v$1671 + " ") + v$1667) + " appears twice in ") + v$1672;
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$1669[0],v$1669[1]))([msg$6192,null])];
} else {var t$13974 = v$1668;
var v$1652 = t$13974;
continue lab$dup;
};
};
};
};
var dup$1649 = fix$13970.$dup;
return dup$1649(v$1670);
};
};
tuscheme$0tuscheme$1.notCurly$1673 = function(v$13572,v$13573){switch (v$13573) { case 2: {return false;
 break; }default: {return true;
} };
};
tuscheme$0tuscheme$1.left$1682 = function(tokens$1685){var v$6202 = tuscheme$0tuscheme$1.inline$1491(tokens$1685);
switch (v$6202[0]) { case 1: {return [1];
 break; }default: {var v$6203 = v$6202[1];
var v$6204 = v$6203[0];
switch (v$6204[0]) { case 1: {return [0,[[1,v$6204[1]],v$6203[1]]];
 break; }default: {var v$6205 = v$6204[1];
var v$6206 = v$6203[1];
var v$6207;
var v$11171 = v$6205[1];
switch (v$11171[0]) { case 2: {v$6207 = [0,[v$6205[0],v$11171[1]]];
 break; }default: {v$6207 = [1];
} };
switch (v$6207[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$6207[1]],v$6206]];
} };
} };
} };
};
tuscheme$0tuscheme$1.right$1696 = function(tokens$1699){var v$6212 = tuscheme$0tuscheme$1.inline$1491(tokens$1699);
switch (v$6212[0]) { case 1: {return [1];
 break; }default: {var v$6213 = v$6212[1];
var v$6214 = v$6213[0];
switch (v$6214[0]) { case 1: {return [0,[[1,v$6214[1]],v$6213[1]]];
 break; }default: {var v$6215 = v$6214[1];
var v$6216 = v$6213[1];
var v$6217;
var v$11175 = v$6215[1];
switch (v$11175[0]) { case 0: {v$6217 = [0,[v$6215[0],v$11175[1]]];
 break; }default: {v$6217 = [1];
} };
switch (v$6217[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$6217[1]],v$6216]];
} };
} };
} };
};
tuscheme$0tuscheme$1.leftCurly$1710 = function(tokens$1713){var v$6221 = tuscheme$0tuscheme$1.left$1682(tokens$1713);
switch (v$6221[0]) { case 0: {var v$6222 = v$6221[1];
var v$6223 = v$6222[0];
switch (v$6223[0]) { case 0: {var v$6224 = v$6223[1];
var t$13976;
var t$13975;
switch (v$6224[1]) { case 2: {t$13975 = false;
 break; }default: {t$13975 = true;
} };
t$13976 = (t$13975?false:true);
return t$13976?v$6221:[1];
 break; }default: {return v$6221;
} };
 break; }default: {return v$6221;
} };
};
tuscheme$0tuscheme$1.atRight$1714 = function(expected$1717){return tuscheme$0tuscheme$1.s$jml$1604(function(xs$6232){var v$6233 = tuscheme$0tuscheme$1.right$1696(xs$6232);
switch (v$6233[0]) { case 0: {return [0,[v$6233[1][0],xs$6232]];
 break; }default: {return [1];
} };
},expected$1717);
};
tuscheme$0tuscheme$1.badRight$1718 = function(msg$1721){return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$6238){return [0,[[0,function(v$11186){var v$11187 = v$11186[0];
var v$11188 = v$11186[1];
var msg$11189;
var t$13978 = msg$1721 + " ";
var t$13977;
switch (v$11188) { case 1: {t$13977 = ")";
 break; }case 0: {t$13977 = "]";
 break; }default: {t$13977 = "}";
} };
msg$11189 = (t$13978 + t$13977);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$11187[0],v$11187[1]))([msg$11189,null])];
}],xs$6238]];
},function(v$13712){return tuscheme$0tuscheme$1.right$1696(v$13712);
});
};
tuscheme$0tuscheme$1.scanToClose$1731 = function(tokens$1734){var loc$1735;
var t$13980 = basis$0General$1.getOpt$107;
var t$13979;
var v$6246;
var tx$11193 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11194){return [0,[[0,function(v$11195){return v$11195[0];
}],xs$11194]];
},function(v$13713){return tuscheme$0tuscheme$1.inline$1491(v$13713);
});
var v$11196 = tx$11193(tokens$1734);
switch (v$11196[0]) { case 0: {v$6246 = [0,[v$11196[1][0],tokens$1734]];
 break; }default: {v$6246 = [1];
} };
switch (v$6246[0]) { case 0: {var v$6247 = v$6246[1];
var v$6248 = v$6247[0];
switch (v$6248[0]) { case 0: {var v$6249 = v$6248[1];
t$13979 = [0,v$6249];
 break; }default: {t$13979 = [1];
} };
 break; }default: {t$13979 = [1];
} };
loc$1735 = (t$13980(t$13979,["end of stream",9999]));
var fix$13981 = {};
fix$13981.$scan = function(lpcount$1739,tokens$1742){lab$scan: while (true) {switch (tokens$1742[0]) { case 2: {var v$1763 = tokens$1742[1];
var v$1764 = v$1763[0];
switch (v$1764[0]) { case 1: {var v$1766 = v$1763[1];
var t$13982 = lpcount$1739;
var t$13983 = v$1766;
var lpcount$1739 = t$13982;
var tokens$1742 = t$13983;
continue lab$scan;
 break; }default: {var v$1767 = v$1764[1];
switch (v$1767[1][0]) { case 2: {var v$1778 = v$1763[1];
var t$13986 = SmlPrims.chk_ovf_i32(lpcount$1739 + 1);
var t$13987 = v$1778;
var lpcount$1739 = t$13986;
var tokens$1742 = t$13987;
continue lab$scan;
 break; }case 0: {var v$1775 = v$1763[1];
if (lpcount$1739 == 0) {return [0,[[0,[0,loc$1735]],v$1775]];
} else {var t$13984 = SmlPrims.chk_ovf_i32(lpcount$1739 - 1);
var t$13985 = v$1775;
var lpcount$1739 = t$13984;
var tokens$1742 = t$13985;
continue lab$scan;
};
 break; }default: {var v$1779 = v$1763[1];
var t$13988 = lpcount$1739;
var t$13989 = v$1779;
var lpcount$1739 = t$13988;
var tokens$1742 = t$13989;
continue lab$scan;
} };
} };
 break; }case 1: {return [0,[[0,[1]],tokens$1742]];
 break; }default: {var v$1780 = tokens$1742[1];
var t$13991 = lpcount$1739;
var t$13990;
var v$6264 = v$1780[0];
switch (v$6264[0]) { case 1: {var v$6265 = v$6264[1];
var result$6266 = v$6265(0);
(v$1780[0] = [0,result$6266],0);
t$13990 = result$6266;
 break; }default: {t$13990 = v$6264[1];
} };
var t$13992 = t$13991;
var t$13993 = t$13990;
var lpcount$1739 = t$13992;
var tokens$1742 = t$13993;
continue lab$scan;
} };
};
};
var scan$1736 = fix$13981.$scan;
return scan$1736(0,tokens$1734);
};
tuscheme$0tuscheme$1.matchingRight$1781 = function(tokens$1784){var v$9604 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6278){return [0,[[0,function(v$11198){return [2,v$11198];
}],xs$6278]];
},function(v$13714){return tuscheme$0tuscheme$1.right$1696(v$13714);
});
var v$6272 = v$9604(tokens$1784);
switch (v$6272[0]) { case 0: {var v$6273 = v$6272[1];
return [0,v$6273];
 break; }default: {return tuscheme$0tuscheme$1.scanToClose$1731(tokens$1784);
} };
};
tuscheme$0tuscheme$1.matchBrackets$1786 = function(v$1789,v$1792,v$1795,v$1798){switch (v$1798[0]) { case 1: {var v$1824 = v$1792[0];
var v$1825 = v$1792[1];
var msg$6279;
var t$13995 = "unmatched ";
var t$13994;
switch (v$1825) { case 1: {t$13994 = "(";
 break; }case 0: {t$13994 = "[";
 break; }default: {t$13994 = "{";
} };
msg$6279 = (t$13995 + t$13994);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$1824[0],v$1824[1]))([msg$6279,null])];
 break; }case 0: {var v$1820 = v$1792[0];
var msg$6283 = "expected " + v$1789;
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$1820[0],v$1820[1]))([msg$6283,null])];
 break; }default: {var v$1835 = v$1792[0];
var v$1836 = v$1792[1];
var v$1838 = v$1798[1];
var v$1839 = v$1838[0];
var v$1840 = v$1838[1];
var t$14001;
switch (v$1836) { case 0: {switch (v$1840) { case 0: {t$14001 = true;
 break; }default: {t$14001 = false;
} };
 break; }case 1: {switch (v$1840) { case 1: {t$14001 = true;
 break; }default: {t$14001 = false;
} };
 break; }case 2: {switch (v$1840) { case 2: {t$14001 = true;
 break; }default: {t$14001 = false;
} };
 break; } };
if (t$14001) {return [0,v$1795];
} else {var msg$6293;
var t$14000;
var t$13999;
var t$13998;
switch (v$1840) { case 1: {t$13998 = ")";
 break; }case 0: {t$13998 = "]";
 break; }default: {t$13998 = "}";
} };
t$13999 = (t$13998 + " does not match ");
var t$13997;
switch (v$1836) { case 1: {t$13997 = "(";
 break; }case 0: {t$13997 = "[";
 break; }default: {t$13997 = "{";
} };
t$14000 = (t$13999 + t$13997);
var t$13996;
if (((v$1835[0] == v$1839[0])?(v$1835[1] == v$1839[1]):false)?false:true) {var v$6306 = v$1835[0];
var v$6307 = v$1835[1];
t$13996 = (" at " + ((v$6306 + ", line ") + (tuscheme$0tuscheme$1.intString$351(v$6307))));
} else {t$13996 = "";
};
msg$6293 = (t$14000 + t$13996);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$1839[0],v$1839[1]))([msg$6293,null])];
};
} };
};
tuscheme$0tuscheme$1.liberalBracket$1841 = function(v$1846,v$1847){return tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6314){return [0,[[0,function(v$13667){return function(v$13668){return function(v$13669){return tuscheme$0tuscheme$1.matchBrackets$1786(v$1846,v$13667,v$13668,v$13669);
};
};
}],xs$6314]];
},function(xs$11210){var v$11211 = tuscheme$0tuscheme$1.left$1682(xs$11210);
switch (v$11211[0]) { case 0: {var v$11212 = v$11211[1];
var v$11213 = v$11212[0];
switch (v$11213[0]) { case 0: {var v$11214 = v$11213[1];
var t$14002;
switch (v$11214[1]) { case 2: {t$14002 = false;
 break; }default: {t$14002 = true;
} };
return t$14002?v$11211:[1];
 break; }default: {return v$11211;
} };
 break; }default: {return v$11211;
} };
}),v$1847),function(tokens$6323){var v$9638 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6329){return [0,[[0,function(v$11216){return [2,v$11216];
}],xs$6329]];
},function(v$13715){return tuscheme$0tuscheme$1.right$1696(v$13715);
});
var v$6333 = v$9638(tokens$6323);
switch (v$6333[0]) { case 0: {var v$6334 = v$6333[1];
return [0,v$6334];
 break; }default: {return tuscheme$0tuscheme$1.scanToClose$1731(tokens$6323);
} };
});
};
tuscheme$0tuscheme$1.bracketKeyword$1848 = function(v$1854,v$1855,v$1856){var t$14005 = tuscheme$0tuscheme$1.liberalBracket$1841;
var t$14004 = v$1855;
var t$14003;
var v$9643 = tuscheme$0tuscheme$1.s$jml$1604(v$1856,v$1855);
t$14003 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6345){return [0,[[0,function(x$11219){return function(y$11220){return y$11220;
};
}],xs$6345]];
},v$1854),v$9643));
return t$14005(t$14004,t$14003);
};
tuscheme$0tuscheme$1.bracket$1857 = function(v$1862,v$1863){return tuscheme$0tuscheme$1.liberalBracket$1841(v$1862,tuscheme$0tuscheme$1.s$jml$1604(v$1863,v$1862));
};
tuscheme$0tuscheme$1.curlyBracket$1864 = function(v$1869,v$1870){return tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6351){return [0,[[0,function(v$13670){return function(v$13671){return function(v$13672){return tuscheme$0tuscheme$1.matchBrackets$1786(v$1869,v$13670,v$13671,v$13672);
};
};
}],xs$6351]];
},function(tokens$11232){var v$11233 = tuscheme$0tuscheme$1.left$1682(tokens$11232);
switch (v$11233[0]) { case 0: {var v$11234 = v$11233[1];
var v$11235 = v$11234[0];
switch (v$11235[0]) { case 0: {var v$11236 = v$11235[1];
var t$14007;
var t$14006;
switch (v$11236[1]) { case 2: {t$14006 = false;
 break; }default: {t$14006 = true;
} };
t$14007 = (t$14006?false:true);
return t$14007?v$11233:[1];
 break; }default: {return v$11233;
} };
 break; }default: {return v$11233;
} };
}),tuscheme$0tuscheme$1.s$jml$1604(v$1870,v$1869)),function(tokens$6352){var v$9648 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6358){return [0,[[0,function(v$11238){return [2,v$11238];
}],xs$6358]];
},function(v$13716){return tuscheme$0tuscheme$1.right$1696(v$13716);
});
var v$6362 = v$9648(tokens$6352);
switch (v$6362[0]) { case 0: {var v$6363 = v$6362[1];
return [0,v$6363];
 break; }default: {return tuscheme$0tuscheme$1.scanToClose$1731(tokens$6352);
} };
});
};
tuscheme$0tuscheme$1.usageParser$1871 = function(keyword$1874){var getkeyword$1875;
var v$9653;
var v$9657;
var t$6403 = function(xs$6415){var v$6416;
var v$11252 = tuscheme$0tuscheme$1.streamGet$703(xs$6415);
switch (v$11252[0]) { case 1: {v$6416 = [1];
 break; }default: {var v$11253 = v$11252[1];
v$6416 = [0,[[0,v$11253[0]],v$11253[1]]];
} };
switch (v$6416[0]) { case 0: {var v$6417 = v$6416[1];
var v$6418 = v$6417[0];
switch (v$6418[0]) { case 0: {var v$6419 = v$6418[1];
var t$14011;
var t$14010;
if ((v$6419 == 32)?true:((9 <= v$6419)?(v$6419 <= 13):false)) {t$14010 = true;
} else {var fix$14008 = {};
fix$14008.$loop = function(j$11257){lab$loop: while (true) {if (j$11257 >= 7) {return false;
} else {if (("()[]{};".charCodeAt(j$11257)) == v$6419) {return true;
} else {var t$14009 = SmlPrims.chk_ovf_i32(j$11257 + 1);
var j$11257 = t$14009;
continue lab$loop;
};
};
};
};
var loop$11256 = fix$14008.$loop;
t$14010 = (loop$11256(0));
};
t$14011 = (t$14010?false:true);
return t$14011?v$6416:[1];
 break; }default: {return v$6416;
} };
 break; }default: {return v$6416;
} };
};
v$9657 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6411){return [0,[[0,function(x$11260){return function(y$11261){return [x$11260,y$11261];
};
}],xs$6411]];
},function(v$13717){return t$6403(v$13717);
}),tuscheme$0tuscheme$1.many$1261(function(v$13718){return t$6403(v$13718);
})));
v$9653 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6401){return [0,[[0,function(chars$11263){return SmlPrims.implode(chars$11263);
}],xs$6401]];
},v$9657));
getkeyword$1875 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$6374){return [0,[[0,function(x$11291){return function(y$11292){return y$11292;
};
}],xs$6374]];
},function(xs$11293){var v$11294;
var v$11295 = tuscheme$0tuscheme$1.streamGet$703(xs$11293);
switch (v$11295[0]) { case 1: {v$11294 = [1];
 break; }default: {var v$11296 = v$11295[1];
v$11294 = [0,[[0,v$11296[0]],v$11296[1]]];
} };
switch (v$11294[0]) { case 0: {var v$11297 = v$11294[1];
var v$11298 = v$11297[0];
switch (v$11298[0]) { case 0: {var v$11299 = v$11298[1];
return (40 == v$11299)?v$11294:[1];
 break; }default: {return v$11294;
} };
 break; }default: {return v$11294;
} };
}),v$9653));
return function(v$1879){var v$1893 = v$1879[0];
var v$1894 = v$1879[1];
var v$1885;
var t$14017 = getkeyword$1875;
var t$14015;
var xs$6435;
var fix$14012 = {};
fix$14012.$h = function(v$6449,v$6450){lab$h: while (true) {if (v$6449 < 0) {return v$6450;
} else {var t$14013 = SmlPrims.chk_ovf_i32(v$6449 - 1);
var t$14014 = [v$1893.charCodeAt(v$6449),v$6450];
var v$6449 = t$14013;
var v$6450 = t$14014;
continue lab$h;
};
};
};
var h$6447 = fix$14012.$h;
xs$6435 = (h$6447(SmlPrims.chk_ovf_i32(v$1893.length - 1),null));
var b$6438 = [1];
var fix$14016 = {};
fix$14016.$foldr = function(v$6441){if (v$6441 == null) {return b$6438;
} else {var v$6442 = v$6441;
var v$6443 = v$6442[0];
var v$6444 = v$6442[1];
var v$6445 = [v$6443,fix$14016.$foldr(v$6444)];
return [2,v$6445];
};
};
var foldr$6440 = fix$14016.$foldr;
t$14015 = (foldr$6440(xs$6435));
v$1885 = (t$14017(t$14015));
switch (v$1885[0]) { case 0: {var v$1887 = v$1885[1];
var v$1888 = v$1887[0];
switch (v$1888[0]) { case 0: {var v$1890 = v$1888[1];
var v$13358 = keyword$1874(v$1890);
var t$14020 = tuscheme$0tuscheme$1.liberalBracket$1841;
var t$14019 = v$1893;
var t$14018;
var v$11305 = tuscheme$0tuscheme$1.s$jml$1604(v$1894,v$1893);
t$14018 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$11306){return [0,[[0,function(x$11307){return function(y$11308){return y$11308;
};
}],xs$11306]];
},v$13358),v$11305));
return t$14020(t$14019,t$14018);
 break; }default: {var en$BadUsage$1891 = new String("BadUsage");
throw [en$BadUsage$1891,v$1893];
} };
 break; }default: {var en$BadUsage$1891 = new String("BadUsage");
throw [en$BadUsage$1891,v$1893];
} };
};
};
tuscheme$0tuscheme$1.safeTokens$1906 = function(stream$1909){var fix$14021 = {};
fix$14021.$tokens = function(v$1953,v$1954){var fix$14022 = {};
fix$14022.$get = function(v$1918){lab$get: while (true) {switch (v$1918[0]) { case 2: {var v$1935 = v$1918[1];
var v$1936 = v$1935[0];
switch (v$1936[0]) { case 1: {var v$1942 = v$1935[1];
return v$1954?null:((fix$14021.$tokens(true,false))(v$1942));
 break; }default: {var v$1943 = v$1936[1];
var v$1944 = v$1943[1];
var v$1945 = v$1935[1];
return [v$1944,fix$14022.$get(v$1945)];
} };
 break; }case 1: {return null;
 break; }default: {var v$1946 = v$1918[1];
switch (v$1946[0][0]) { case 0: {var v$1948 = v$1946[0][1];
var t$14023 = v$1948;
var v$1918 = t$14023;
continue lab$get;
 break; }default: {if (v$1953) {return null;
} else {var t$14025 = fix$14021.$tokens(false,true);
var t$14024;
var v$6454 = v$1946[0];
switch (v$6454[0]) { case 1: {var v$6455 = v$6454[1];
var result$6456 = v$6455(0);
(v$1946[0] = [0,result$6456],0);
t$14024 = result$6456;
 break; }default: {t$14024 = v$6454[1];
} };
return t$14025(t$14024);
};
} };
} };
};
};
var get$1915 = fix$14022.$get;
return function(v$13719){return get$1915(v$13719);
};
};
var tokens$1910 = fix$14021.$tokens;
return (tokens$1910(false,false))(stream$1909);
};
tuscheme$0tuscheme$1.showErrorInput$1955 = function(asString$1958,p$1961,tokens$1964){var v$1973 = p$1961(tokens$1964);
switch (v$1973[0]) { case 0: {var v$1975 = v$1973[1];
var v$1976 = v$1975[0];
switch (v$1976[0]) { case 1: {var v$1982 = v$1976[1];
var v$1983 = v$1975[1];
return (basis$0String$1.isSubstring$268(" [input: ",v$1982))?v$1973:[0,[[1,((v$1982 + " [input: ") + (tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(asString$1958,tuscheme$0tuscheme$1.safeTokens$1906(tokens$1964))))) + "]"],v$1983]];
 break; }default: {return v$1973;
} };
 break; }default: {return v$1973;
} };
};
tuscheme$0tuscheme$1.wrapAround$1985 = function(tokenString$1988,what$1991,p$1994,tokens$1997){try {var l$6465 = ["Looking for ",[what$1991,[" at",null]]];
var fix$14027 = {};
fix$14027.$app = function(v$6467){lab$app: while (true) {if (v$6467 == null) {return 0;
} else {var v$6468 = v$6467;
var v$6469 = v$6468[0];
var v$6470 = v$6468[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$6469);
var t$14028 = v$6470;
var v$6467 = t$14028;
continue lab$app;
};
};
};
var app$6466 = fix$14027.$app;
app$6466(l$6465);
var l$6473 = tuscheme$0tuscheme$1.safeTokens$1906(tokens$1997);
var fix$14029 = {};
fix$14029.$app = function(v$6475){lab$app: while (true) {if (v$6475 == null) {return 0;
} else {var v$6476 = v$6475;
var v$6477 = v$6476[0];
var v$6478 = v$6476[1];
var s$11316 = " " + (tokenString$1988(v$6477));
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$11316);
var t$14030 = v$6478;
var v$6475 = t$14030;
continue lab$app;
};
};
};
var app$6474 = fix$14029.$app;
app$6474(l$6473);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
var answer$2002 = p$1994(tokens$1997);
var l$6488;
var t$14032;
var t$14031;
switch (answer$2002[0]) { case 1: {t$14031 = "Didn't find ";
 break; }default: {t$14031 = "Found ";
} };
t$14032 = [t$14031,[what$1991,["\n",null]]];
l$6488 = t$14032;
var fix$14033 = {};
fix$14033.$app = function(v$6490){lab$app: while (true) {if (v$6490 == null) {return 0;
} else {var v$6491 = v$6490;
var v$6492 = v$6491[0];
var v$6493 = v$6491[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$6492);
var t$14034 = v$6493;
var v$6490 = t$14034;
continue lab$app;
};
};
};
var app$6489 = fix$14033.$app;
app$6489(l$6488);
return answer$2002;
} catch(v$14026) {return (function(e$2009){var l$6496 = ["Search for ",[what$1991,[" raised ",[e$2009[0],["\n",null]]]]];
var fix$14035 = {};
fix$14035.$app = function(v$6498){lab$app: while (true) {if (v$6498 == null) {return 0;
} else {var v$6499 = v$6498;
var v$6500 = v$6499[0];
var v$6501 = v$6499[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$6500);
var t$14036 = v$6501;
var v$6498 = t$14036;
continue lab$app;
};
};
};
var app$6497 = fix$14035.$app;
app$6497(l$6496);
throw e$2009;
})(v$14026);
};
};
tuscheme$0tuscheme$1.echoTagStream$2012 = function(lines$2015){var fix$14037 = {};
fix$14037.$streamOfUnfold = function(state$11327){return [0,[[1,function(v$11328){var v$11329;
var v$11336 = tuscheme$0tuscheme$1.streamGet$703(state$11327);
switch (v$11336[0]) { case 1: {v$11329 = [1];
 break; }default: {var v$11337 = v$11336[1];
var v$11338 = v$11337[0];
var t$14039;
try {t$14039 = ((basis$0String$1.substring$169(v$11338,0,2)) == ";#");
} catch(v$14038) {t$14039 = ((function(v$11340){return false;
})(v$14038));
};
t$14039?(tuscheme$0stubs$1.print$119(v$11338)):0;
v$11329 = v$11336;
} };
switch (v$11329[0]) { case 1: {return [1];
 break; }default: {var v$11330 = v$11329[1];
var v$11331 = v$11330[0];
var v$11332 = v$11330[1];
return [2,[v$11331,fix$14037.$streamOfUnfold(v$11332)]];
} };
}]]];
};
var streamOfUnfold$11326 = fix$14037.$streamOfUnfold;
return streamOfUnfold$11326(lines$2015);
};
tuscheme$0tuscheme$1.stripAndReportErrors$2026 = function(xs$2029){var fix$14040 = {};
fix$14040.$next = function(xs$2033){lab$next: while (true) {var v$2043 = tuscheme$0tuscheme$1.streamGet$703(xs$2033);
switch (v$2043[0]) { case 0: {var v$2045 = v$2043[1];
var v$2046 = v$2045[0];
switch (v$2046[0]) { case 1: {var v$2050 = v$2046[1];
var v$2051 = v$2045[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$2050);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
var t$14041 = v$2051;
var xs$2033 = t$14041;
continue lab$next;
 break; }default: {return [0,[v$2046[1],v$2045[1]]];
} };
 break; }default: {return [1];
} };
};
};
var next$2030 = fix$14040.$next;
var fix$14042 = {};
fix$14042.$streamOfUnfold = function(state$11343){return [0,[[1,function(v$11344){var v$11345 = next$2030(state$11343);
switch (v$11345[0]) { case 1: {return [1];
 break; }default: {var v$11346 = v$11345[1];
var v$11347 = v$11346[0];
var v$11348 = v$11346[1];
return [2,[v$11347,fix$14042.$streamOfUnfold(v$11348)]];
} };
}]]];
};
var streamOfUnfold$11342 = fix$14042.$streamOfUnfold;
return streamOfUnfold$11342(xs$2029);
};
tuscheme$0tuscheme$1.lexLineWith$2054 = function(lexer$2057){var v$9682;
var v$9684;
var v$9687;
var fix$14043 = {};
fix$14043.$streamOfUnfold = function(state$11351){return [0,[[1,function(v$11352){var v$11353 = lexer$2057(state$11351);
switch (v$11353[0]) { case 1: {return [1];
 break; }default: {var v$11354 = v$11353[1];
var v$11355 = v$11354[0];
var v$11356 = v$11354[1];
return [2,[v$11355,fix$14043.$streamOfUnfold(v$11356)]];
} };
}]]];
};
var streamOfUnfold$11350 = fix$14043.$streamOfUnfold;
v$9687 = (function(v$13720){return streamOfUnfold$11350(v$13720);
});
v$9684 = (function(x$6537){return tuscheme$0tuscheme$1.stripAndReportErrors$2026(v$9687(x$6537));
});
v$9682 = (function(x$6533){var t$14046 = v$9684;
var t$14044;
var b$11366 = [1];
var fix$14045 = {};
fix$14045.$foldr = function(v$11368){if (v$11368 == null) {return b$11366;
} else {var v$11369 = v$11368;
var v$11370 = v$11369[0];
var v$11371 = v$11369[1];
var v$11372 = [v$11370,fix$14045.$foldr(v$11371)];
return [2,v$11372];
};
};
var foldr$11367 = fix$14045.$foldr;
t$14044 = (foldr$11367(x$6533));
return t$14046(t$14044);
});
return function(x$6529){var t$14051 = v$9682;
var t$14050;
var fix$14047 = {};
fix$14047.$h = function(v$11381,v$11382){lab$h: while (true) {if (v$11381 < 0) {return v$11382;
} else {var t$14048 = SmlPrims.chk_ovf_i32(v$11381 - 1);
var t$14049 = [x$6529.charCodeAt(v$11381),v$11382];
var v$11381 = t$14048;
var v$11382 = t$14049;
continue lab$h;
};
};
};
var h$11379 = fix$14047.$h;
t$14050 = (h$11379(SmlPrims.chk_ovf_i32(x$6529.length - 1),null));
return t$14051(t$14050);
};
};
tuscheme$0tuscheme$1.parseWithErrors$2058 = function(parser$2061){var fix$14052 = {};
fix$14052.$streamOfUnfold = function(state$11395){return [0,[[1,function(v$11396){var v$11397;
var v$11412 = parser$2061(state$11395);
switch (v$11412[0]) { case 0: {var v$11413 = v$11412[1];
var v$11414 = v$11413[0];
switch (v$11414[0]) { case 1: {var v$11415 = v$11414[1];
var v$11416 = v$11413[1];
v$11397 = [0,[[1,v$11415],tuscheme$0tuscheme$1.drainLine$1443(v$11416)]];
 break; }default: {v$11397 = v$11412;
} };
 break; }default: {v$11397 = v$11412;
} };
switch (v$11397[0]) { case 1: {return [1];
 break; }default: {var v$11398 = v$11397[1];
var v$11399 = v$11398[0];
var v$11400 = v$11398[1];
return [2,[v$11399,fix$14052.$streamOfUnfold(v$11400)]];
} };
}]]];
};
var streamOfUnfold$11394 = fix$14052.$streamOfUnfold;
return function(v$13721){return streamOfUnfold$11394(v$13721);
};
};
tuscheme$0tuscheme$1.stdPrompts$2081 = ["-> ","   "];
tuscheme$0tuscheme$1.noPrompts$2082 = ["",""];
tuscheme$0tuscheme$1.interactiveParsedStream$2083 = function(v$2122,v$2123){return function(v$2092){var v$2119 = v$2092[0];
var v$2120 = v$2092[1];
var v$2121 = v$2092[2];
var v$2117 = v$2121[0];
var v$2118 = v$2121[1];
var thePrompt$2096 = [v$2117];
var lines$2103;
var v$9691 = tuscheme$0tuscheme$1.echoTagStream$2012(v$2120);
var fix$14053 = {};
fix$14053.$streamOfUnfold = function(state$11421){return [0,[[1,function(v$11422){var v$11423;
tuscheme$0stubs$1.print$119(thePrompt$2096[0]);
v$11423 = (tuscheme$0tuscheme$1.streamGet$703(state$11421));
switch (v$11423[0]) { case 1: {return [1];
 break; }default: {var v$11424 = v$11423[1];
var v$11425 = v$11424[0];
var v$11426 = v$11424[1];
return [2,[v$11425,fix$14053.$streamOfUnfold(v$11426)]];
} };
}]]];
};
var streamOfUnfold$11420 = fix$14053.$streamOfUnfold;
lines$2103 = (streamOfUnfold$11420(v$9691));
var xdefs_with_errors$2115;
var v$9698;
var v$9700;
var fix$14054 = {};
fix$14054.$streamOfUnfold = function(state$11467){return [0,[[1,function(v$11468){var v$11469;
var v$11484 = v$2123(state$11467);
switch (v$11484[0]) { case 0: {var v$11485 = v$11484[1];
var v$11486 = v$11485[0];
switch (v$11486[0]) { case 1: {var v$11487 = v$11486[1];
var v$11488 = v$11485[1];
v$11469 = [0,[[1,v$11487],tuscheme$0tuscheme$1.drainLine$1443(v$11488)]];
 break; }default: {v$11469 = v$11484;
} };
 break; }default: {v$11469 = v$11484;
} };
switch (v$11469[0]) { case 1: {return [1];
 break; }default: {var v$11470 = v$11469[1];
var v$11471 = v$11470[0];
var v$11472 = v$11470[1];
return [2,[v$11471,fix$14054.$streamOfUnfold(v$11472)]];
} };
}]]];
};
var streamOfUnfold$11466 = fix$14054.$streamOfUnfold;
v$9700 = (function(v$13722){return streamOfUnfold$11466(v$13722);
});
v$9698 = (function(x$6611){var t$14067 = v$9700;
var t$14066;
var t$14065 = tuscheme$0tuscheme$1.streamConcat$909;
var t$14056;
var fix$14055 = {};
fix$14055.$streamMap = function(xs$11661){return [0,[[1,function(v$11662){var v$11663 = tuscheme$0tuscheme$1.streamGet$703(xs$11661);
switch (v$11663[0]) { case 1: {return [1];
 break; }default: {var v$11664 = v$11663[1];
var v$11665 = v$11664[0];
var v$11666 = v$11664[1];
var t$14064;
var t$14057;
var v$11667 = v$11665[0];
var v$11668 = v$11665[1];
var tokens$11669;
var v$11670 = (tuscheme$0tuscheme$1.lexLineWith$2054(v$2122))(v$11668);
var fix$14058 = {};
fix$14058.$streamOfUnfold = function(state$11672){return [0,[[1,function(v$11673){var v$11674;
var v$11675 = tuscheme$0tuscheme$1.streamGet$703(state$11672);
switch (v$11675[0]) { case 1: {v$11674 = [1];
 break; }default: {(thePrompt$2096[0] = v$2118,0);
v$11674 = v$11675;
} };
switch (v$11674[0]) { case 1: {return [1];
 break; }default: {var v$11676 = v$11674[1];
var v$11677 = v$11676[0];
var v$11678 = v$11676[1];
return [2,[v$11677,fix$14058.$streamOfUnfold(v$11678)]];
} };
}]]];
};
var streamOfUnfold$11671 = fix$14058.$streamOfUnfold;
tokens$11669 = (streamOfUnfold$11671(v$11670));
var v$11679;
var fix$14059 = {};
fix$14059.$streamMap = function(xs$11681){return [0,[[1,function(v$11682){var v$11683 = tuscheme$0tuscheme$1.streamGet$703(xs$11681);
switch (v$11683[0]) { case 1: {return [1];
 break; }default: {var v$11684 = v$11683[1];
var v$11685 = v$11684[0];
var v$11686 = v$11684[1];
return [2,[[0,v$11685],fix$14059.$streamMap(v$11686)]];
} };
}]]];
};
var streamMap$11680 = fix$14059.$streamMap;
v$11679 = (streamMap$11680(tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(v$11667),tokens$11669)));
var v$11687;
var xs$11688 = [[1,v$11667[1]],null];
var b$11689 = [1];
var fix$14060 = {};
fix$14060.$foldr = function(v$11691){if (v$11691 == null) {return b$11689;
} else {var v$11692 = v$11691;
var v$11693 = v$11692[0];
var v$11694 = v$11692[1];
var v$11695 = [v$11693,fix$14060.$foldr(v$11694)];
return [2,v$11695];
};
};
var foldr$11690 = fix$14060.$foldr;
v$11687 = (foldr$11690(xs$11688));
var t$14063 = tuscheme$0tuscheme$1.streamConcat$909;
var t$14061;
var xs$11696 = [v$11679,[v$11687,null]];
var b$11697 = [1];
var fix$14062 = {};
fix$14062.$foldr = function(v$11699){if (v$11699 == null) {return b$11697;
} else {var v$11700 = v$11699;
var v$11701 = v$11700[0];
var v$11702 = v$11700[1];
var v$11703 = [v$11701,fix$14062.$foldr(v$11702)];
return [2,v$11703];
};
};
var foldr$11698 = fix$14062.$foldr;
t$14061 = (foldr$11698(xs$11696));
t$14057 = (t$14063(t$14061));
t$14064 = [t$14057,fix$14055.$streamMap(v$11666)];
return [2,t$14064];
} };
}]]];
};
var streamMap$11660 = fix$14055.$streamMap;
t$14056 = (streamMap$11660(x$6611));
t$14066 = (t$14065(t$14056));
return t$14067(t$14066);
});
var t$14069 = v$9698;
var t$14068;
var locations$11711 = tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(v$2119),tuscheme$0tuscheme$1.streamDrop$978(1,tuscheme$0tuscheme$1.naturals$785));
t$14068 = (tuscheme$0tuscheme$1.streamZip$880(locations$11711,lines$2103));
xdefs_with_errors$2115 = (t$14069(t$14068));
var t$14072 = tuscheme$0tuscheme$1.stripAndReportErrors$2026;
var t$14071;
var fix$14070 = {};
fix$14070.$streamOfUnfold = function(state$11716){return [0,[[1,function(v$11717){var v$11718;
(thePrompt$2096[0] = v$2117,0);
v$11718 = (tuscheme$0tuscheme$1.streamGet$703(state$11716));
switch (v$11718[0]) { case 1: {return [1];
 break; }default: {var v$11719 = v$11718[1];
var v$11720 = v$11719[0];
var v$11721 = v$11719[1];
return [2,[v$11720,fix$14070.$streamOfUnfold(v$11721)]];
} };
}]]];
};
var streamOfUnfold$11715 = fix$14070.$streamOfUnfold;
t$14071 = (streamOfUnfold$11715(xdefs_with_errors$2115));
return t$14072(t$14071);
};
};
tuscheme$0tuscheme$1.override_if_testing$2124 = function(v$2126){return (basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC")))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0):0;
};
tuscheme$0tuscheme$1.setup_error_format$2131 = function(v$13574,v$13575){var t$14073;
switch (v$13574) { case 0: {t$14073 = true;
 break; }default: {t$14073 = false;
} };
return t$14073?[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0),(basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC")))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0):0][0]:[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 0,0),(basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC")))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0):0][0];
};
tuscheme$0tuscheme$1.forward$2139 = function(what$2142,v$2144){var en$UnresolvedForwardDeclaration$2145 = new String("UnresolvedForwardDeclaration");
throw [en$UnresolvedForwardDeclaration$2145,what$2142];
};
tuscheme$0tuscheme$1.en$LeftAsExercise$2146 = new String("LeftAsExercise");
var fix$14074 = {};
fix$14074.$eqKind = function(v$2165,v$13577){if (v$2165 == null) {return (v$13577 == null)?true:false;
} else {if (v$13577 == null) {return false;
} else {var v$2174 = v$2165;
var v$2175 = v$2174[0];
var v$2176 = v$2174[1];
var v$2177 = v$13577;
var v$2178 = v$2177[0];
var v$2179 = v$2177[1];
if (fix$14074.$eqKinds(v$2175,v$2178)) {return fix$14074.$eqKind(v$2176,v$2179);
} else {return false;
};
};
};
};
fix$14074.$eqKinds = function(v$2184,v$2185){return basis$0ListPair$1.allEq$384(function(v$13576){return fix$14074.$eqKind(v$13576[0],v$13576[1]);
},[v$2184,v$2185]);
};
tuscheme$0tuscheme$1.eqKind$2150 = fix$14074.$eqKind;
tuscheme$0tuscheme$1.eqKinds$2149 = fix$14074.$eqKinds;
tuscheme$0tuscheme$1.inttype$2191 = [1,"int"];
tuscheme$0tuscheme$1.booltype$2192 = [1,"bool"];
tuscheme$0tuscheme$1.symtype$2193 = [1,"sym"];
tuscheme$0tuscheme$1.unittype$2194 = [1,"unit"];
tuscheme$0tuscheme$1.tyvarA$2195 = [0,"'a"];
tuscheme$0tuscheme$1.listtype$2196 = function(ty$2199){return [4,[[1,"list"],[ty$2199,null]]];
};
var fix$14075 = {};
fix$14075.$typeString = function(v$2203){lab$typeString: while (true) {switch (v$2203[0]) { case 1: {return v$2203[1];
 break; }case 0: {return v$2203[1];
 break; }case 2: {var v$2231 = v$2203[1];
var v$2232 = v$2231[0];
var v$2233 = v$2231[1];
return ((("(" + (tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697((function(env$14079){return function(v$13723){var v$14078 = env$14079[0];
return v$14078(v$13723);
};
})([fix$14075.$typeString]),v$2232)))) + " -> ") + (fix$14075.$typeString(v$2233))) + ")";
 break; }case 4: {var v$2226 = v$2203[1];
var v$2227 = v$2226[1];
if (v$2227 == null) {var v$2228 = v$2226[0];
return ("(" + (fix$14075.$typeString(v$2228))) + ")";
} else {var v$2229 = v$2226[0];
return ((("(" + (fix$14075.$typeString(v$2229))) + " ") + (tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697((function(env$14077){return function(v$13724){var v$14076 = env$14077[0];
return v$14076(v$13724);
};
})([fix$14075.$typeString]),v$2227)))) + ")";
};
 break; }default: {var v$2238 = v$2203[1];
var v$2239 = v$2238[0];
var v$2240 = v$2238[1];
return ((("(forall (" + (tuscheme$0tuscheme$1.spaceSep$414(v$2239))) + ") ") + (fix$14075.$typeString(v$2240))) + ")";
} };
};
};
tuscheme$0tuscheme$1.typeString$2200 = fix$14075.$typeString;
tuscheme$0tuscheme$1.freetyvars$2241 = function(t$2244){var fix$14080 = {};
fix$14080.$free = function(v$2271,v$13578){switch (v$2271[0]) { case 0: {var v$2285 = v$2271[1];
var t$14089;
var fix$14087 = {};
fix$14087.$exists = function(v$11729){lab$exists: while (true) {if (v$11729 == null) {return false;
} else {var v$11730 = v$11729;
var v$11731 = v$11730[0];
var v$11732 = v$11730[1];
if (v$11731 == v$2285) {return true;
} else {var t$14088 = v$11732;
var v$11729 = t$14088;
continue lab$exists;
};
};
};
};
var exists$11728 = fix$14087.$exists;
t$14089 = (exists$11728(v$13578));
return t$14089?v$13578:[v$2285,v$13578];
 break; }case 1: {return v$13578;
 break; }case 4: {var v$2278 = v$2271[1];
var v$2279 = v$2278[0];
var v$2280 = v$2278[1];
var b$6662 = fix$14080.$free(v$2279,v$13578);
var fix$14084 = {};
fix$14084.$foldl = function(v$6665,v$6666){lab$foldl: while (true) {if (v$6666 == null) {return v$6665;
} else {var v$6667 = v$6666;
var v$6668 = v$6667[0];
var v$6669 = v$6667[1];
var t$14085 = fix$14080.$free(v$6668,v$6665);
var t$14086 = v$6669;
var v$6665 = t$14085;
var v$6666 = t$14086;
continue lab$foldl;
};
};
};
var foldl$6664 = fix$14084.$foldl;
return foldl$6664(b$6662,v$2280);
 break; }case 2: {var v$2273 = v$2271[1];
var v$2274 = v$2273[0];
var v$2275 = v$2273[1];
var b$6671 = fix$14080.$free(v$2275,v$13578);
var fix$14081 = {};
fix$14081.$foldl = function(v$6674,v$6675){lab$foldl: while (true) {if (v$6675 == null) {return v$6674;
} else {var v$6676 = v$6675;
var v$6677 = v$6676[0];
var v$6678 = v$6676[1];
var t$14082 = fix$14080.$free(v$6677,v$6674);
var t$14083 = v$6678;
var v$6674 = t$14082;
var v$6675 = t$14083;
continue lab$foldl;
};
};
};
var foldl$6673 = fix$14081.$foldl;
return foldl$6673(b$6671,v$2274);
 break; }default: {var v$2287 = v$2271[1];
var v$2288 = v$2287[0];
var v$2289 = v$2287[1];
var v$9746;
var v$13363 = fix$14080.$free(v$2289,tuscheme$0tuscheme$1.emptyset$566(0));
v$9746 = (basis$0List$1.filter$417(function(x$11737){var t$14092;
var fix$14090 = {};
fix$14090.$exists = function(v$11739){lab$exists: while (true) {if (v$11739 == null) {return false;
} else {var v$11740 = v$11739;
var v$11741 = v$11740[0];
var v$11742 = v$11740[1];
if (v$11741 == x$11737) {return true;
} else {var t$14091 = v$11742;
var v$11739 = t$14091;
continue lab$exists;
};
};
};
};
var exists$11738 = fix$14090.$exists;
t$14092 = (exists$11738(v$2288));
return t$14092?false:true;
},v$13363));
var fix$14093 = {};
fix$14093.$foldl = function(v$6687,v$6688){lab$foldl: while (true) {if (v$6688 == null) {return v$6687;
} else {var v$6689 = v$6688;
var v$6690 = v$6689[0];
var v$6691 = v$6689[1];
var t$14097;
var t$14096;
var fix$14094 = {};
fix$14094.$exists = function(v$11759){lab$exists: while (true) {if (v$11759 == null) {return false;
} else {var v$11760 = v$11759;
var v$11761 = v$11760[0];
var v$11762 = v$11760[1];
if (v$11761 == v$6690) {return true;
} else {var t$14095 = v$11762;
var v$11759 = t$14095;
continue lab$exists;
};
};
};
};
var exists$11758 = fix$14094.$exists;
t$14096 = (exists$11758(v$6687));
t$14097 = (t$14096?v$6687:[v$6690,v$6687]);
var t$14098 = t$14097;
var t$14099 = v$6691;
var v$6687 = t$14098;
var v$6688 = t$14099;
continue lab$foldl;
};
};
};
var foldl$6686 = fix$14093.$foldl;
return foldl$6686(v$13578,v$9746);
} };
};
var free$2245 = fix$14080.$free;
return basis$0List$1.rev$682(free$2245(t$2244,tuscheme$0tuscheme$1.emptyset$566(0)));
};
tuscheme$0tuscheme$1.freetyvarsGamma$2291 = function(Gamma$2294){var fix$14100 = {};
fix$14100.$foldl = function(v$6696,v$6697){lab$foldl: while (true) {if (v$6697 == null) {return v$6696;
} else {var v$6698 = v$6697;
var v$6699 = v$6698[0];
var v$6700 = v$6698[1];
var t$14101;
var v$11787 = v$6699[1];
var v$11789 = tuscheme$0tuscheme$1.freetyvars$2241(v$11787);
var fix$14102 = {};
fix$14102.$foldl = function(v$11791,v$11792){lab$foldl: while (true) {if (v$11792 == null) {return v$11791;
} else {var v$11793 = v$11792;
var v$11794 = v$11793[0];
var v$11795 = v$11793[1];
var t$14106;
var t$14105;
var fix$14103 = {};
fix$14103.$exists = function(v$11800){lab$exists: while (true) {if (v$11800 == null) {return false;
} else {var v$11801 = v$11800;
var v$11802 = v$11801[0];
var v$11803 = v$11801[1];
if (v$11802 == v$11794) {return true;
} else {var t$14104 = v$11803;
var v$11800 = t$14104;
continue lab$exists;
};
};
};
};
var exists$11799 = fix$14103.$exists;
t$14105 = (exists$11799(v$11791));
t$14106 = (t$14105?v$11791:[v$11794,v$11791]);
var t$14107 = t$14106;
var t$14108 = v$11795;
var v$11791 = t$14107;
var v$11792 = t$14108;
continue lab$foldl;
};
};
};
var foldl$11790 = fix$14102.$foldl;
t$14101 = (foldl$11790(v$11789,v$6696));
var t$14109 = t$14101;
var t$14110 = v$6700;
var v$6696 = t$14109;
var v$6697 = t$14110;
continue lab$foldl;
};
};
};
var foldl$6695 = fix$14100.$foldl;
return foldl$6695(tuscheme$0tuscheme$1.emptyset$566(0),Gamma$2294);
};
tuscheme$0tuscheme$1.freshName$2304 = function(v$2327,v$2328){var basename$2309 = tuscheme$0tuscheme$1.stripNumericSuffix$454(v$2327);
var candidates$2310;
var fix$14111 = {};
fix$14111.$streamMap = function(xs$11812){return [0,[[1,function(v$11813){var v$11814 = tuscheme$0tuscheme$1.streamGet$703(xs$11812);
switch (v$11814[0]) { case 1: {return [1];
 break; }default: {var v$11815 = v$11814[1];
var v$11816 = v$11815[0];
var v$11817 = v$11815[1];
return [2,[(basename$2309 + "-") + (tuscheme$0tuscheme$1.intString$351(v$11816)),fix$14111.$streamMap(v$11817)]];
} };
}]]];
};
var streamMap$11811 = fix$14111.$streamMap;
candidates$2310 = (streamMap$11811(tuscheme$0tuscheme$1.naturals$785));
var v$2322;
var t$14118 = tuscheme$0tuscheme$1.streamGet$703;
var t$14113;
var fix$14112 = {};
fix$14112.$streamFilter = function(xs$11833){return [0,[[1,function(v$11834){var v$11835 = tuscheme$0tuscheme$1.streamGet$703(xs$11833);
switch (v$11835[0]) { case 1: {return [1];
 break; }default: {var v$11836 = v$11835[1];
var v$11837 = v$11836[0];
var v$11838 = v$11836[1];
var t$14117;
var t$14116;
var fix$14114 = {};
fix$14114.$exists = function(v$11841){lab$exists: while (true) {if (v$11841 == null) {return false;
} else {var v$11842 = v$11841;
var v$11843 = v$11842[0];
var v$11844 = v$11842[1];
if (v$11843 == v$11837) {return true;
} else {var t$14115 = v$11844;
var v$11841 = t$14115;
continue lab$exists;
};
};
};
};
var exists$11840 = fix$14114.$exists;
t$14116 = (exists$11840(v$2328));
t$14117 = (t$14116?false:true);
if (t$14117) {return [2,[v$11837,fix$14112.$streamFilter(v$11838)]];
} else {return fix$14112.$streamFilter(v$11838);
};
} };
}]]];
};
var streamFilter$11832 = fix$14112.$streamFilter;
t$14113 = (streamFilter$11832(candidates$2310));
v$2322 = (t$14118(t$14113));
switch (v$2322[0]) { case 0: {return v$2322[1][0];
 break; }default: {var en$ThisCan$tHappen$2326 = new String("ThisCan'tHappen");
var exn$ThisCan$tHappen$2326 = [en$ThisCan$tHappen$2326];
throw exn$ThisCan$tHappen$2326;
} };
};
var fix$14119 = {};
fix$14119.$kindof = function(v$2414,v$2415){var fix$14693 = {};
fix$14693.$kind = function(v$2337){lab$kind: while (true) {switch (v$2337[0]) { case 0: {var v$2399 = v$2337[1];
try {return tuscheme$0tuscheme$1.find$139(v$2399,v$2415);
} catch(v$14703) {return ((function(env$14705){return function(v$2398){var v$14704 = env$14705[0];
var t$14706 = v$2398;
if (t$14706[0] == tuscheme$0tuscheme$1.en$NotFound$138) {throw [tuscheme$0tuscheme$1.en$TypeError$87,"unknown type variable " + v$14704];
} else {throw v$2398;
};
};
})([v$2399]))(v$14703);
};
 break; }case 1: {var v$2394 = v$2337[1];
try {return tuscheme$0tuscheme$1.find$139(v$2394,v$2415);
} catch(v$14699) {return ((function(env$14701){return function(v$2393){var v$14700 = env$14701[0];
var t$14702 = v$2393;
if (t$14702[0] == tuscheme$0tuscheme$1.en$NotFound$138) {throw [tuscheme$0tuscheme$1.en$TypeError$87,"unknown type constructor " + v$14700];
} else {throw v$2393;
};
};
})([v$2394]))(v$14699);
};
 break; }case 2: {var v$2387 = v$2337[1];
var v$2388 = v$2387[0];
var v$2389 = v$2387[1];
if ((tuscheme$0tuscheme$1.eqKind$2150(fix$14693.$kind(v$2389),null))?false:true) {throw [tuscheme$0tuscheme$1.en$TypeError$87,"function result is not a type"];
} else {var t$14698;
var fix$14696 = {};
fix$14696.$exists = function(v$6747){lab$exists: while (true) {if (v$6747 == null) {return false;
} else {var v$6748 = v$6747;
var v$6749 = v$6748[0];
var v$6750 = v$6748[1];
if ((tuscheme$0tuscheme$1.eqKind$2150(fix$14693.$kind(v$6749),null))?false:true) {return true;
} else {var t$14697 = v$6750;
var v$6747 = t$14697;
continue lab$exists;
};
};
};
};
var exists$6746 = fix$14696.$exists;
t$14698 = (exists$6746(v$2388));
if (t$14698) {throw [tuscheme$0tuscheme$1.en$TypeError$87,"argument list includes a non-type"];
} else {return null;
};
};
 break; }case 4: {var v$2371 = v$2337[1];
var v$2372 = v$2371[0];
var v$2373 = v$2371[1];
var v$2362 = fix$14693.$kind(v$2372);
if (v$2362 == null) {throw [tuscheme$0tuscheme$1.en$TypeError$87,("tried to apply type " + (tuscheme$0tuscheme$1.typeString$2200(v$2372))) + " as type constructor"];
} else {var v$2368 = v$2362;
var v$2369 = v$2368[0];
var v$2370 = v$2368[1];
if (tuscheme$0tuscheme$1.eqKinds$2149(v$2369,basis$0List$1.map$697((function(env$14695){return function(v$13725){var v$14694 = env$14695[0];
return v$14694(v$13725);
};
})([fix$14693.$kind]),v$2373))) {return v$2370;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,("type constructor " + (tuscheme$0tuscheme$1.typeString$2200(v$2372))) + " applied to the wrong arguments"];
};
};
 break; }default: {var v$2411 = v$2337[1];
var v$2412 = v$2411[0];
var v$2413 = v$2411[1];
var Delta$$2400;
var fix$14707 = {};
fix$14707.$foldl = function(v$6761,v$6762){lab$foldl: while (true) {if (v$6762 == null) {return v$6761;
} else {var v$6763 = v$6762;
var v$6764 = v$6763[0];
var v$6765 = v$6763[1];
var t$14708 = [[v$6764,null],v$6761];
var t$14709 = v$6765;
var v$6761 = t$14708;
var v$6762 = t$14709;
continue lab$foldl;
};
};
};
var foldl$6760 = fix$14707.$foldl;
Delta$$2400 = (foldl$6760(v$2415,v$2412));
if ((fix$14119.$kindof(v$2413,Delta$$2400)) == null) {return null;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,"quantifed a non-nullary type constructor"];
};
} };
};
};
var kind$2334 = fix$14693.$kind;
return kind$2334(v$2414);
};
tuscheme$0tuscheme$1.kindof$2329 = fix$14119.$kindof;
tuscheme$0tuscheme$1.asType$2416 = function(v$2425,v$2426){if ((tuscheme$0tuscheme$1.kindof$2329(v$2425,v$2426)) == null) {return v$2425;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,("used type constructor `" + (tuscheme$0tuscheme$1.typeString$2200(v$2425))) + "' as a type"];
};
};
var fix$14120 = {};
fix$14120.$valueString = function(v$2462){switch (v$2462[0]) { case 4: {return "()";
 break; }case 6: {return v$2462[1]?"#t":"#f";
 break; }case 3: {var v$2507 = v$2462[1];
return tuscheme$0tuscheme$1.intString$351(v$2507);
 break; }case 0: {return v$2462[1];
 break; }case 2: {var v$2501 = v$2462[1];
var v$2502 = v$2501[0];
var v$2503 = v$2501[1];
var fix$14692 = {};
fix$14692.$tail = function(v$2487){switch (v$2487[0]) { case 2: {var v$2498 = v$2487[1];
var v$2499 = v$2498[0];
var v$2500 = v$2498[1];
return (" " + (fix$14120.$valueString(v$2499))) + (fix$14692.$tail(v$2500));
 break; }case 4: {return ")";
 break; }default: {return (" . " + (fix$14120.$valueString(v$2487))) + ")";
} };
};
var tail$2484 = fix$14692.$tail;
return ("(" + (fix$14120.$valueString(v$2502))) + (tail$2484(v$2503));
 break; }case 5: {return "<procedure>";
 break; }default: {return "<procedure>";
} };
};
tuscheme$0tuscheme$1.valueString$2459 = fix$14120.$valueString;
var fix$14121 = {};
fix$14121.$expString = function(e$2517){lab$expString: while (true) {switch (e$2517[0]) { case 5: {var v$2637 = e$2517[1];
return tuscheme$0tuscheme$1.valueString$2459(v$2637);
 break; }case 1: {return e$2517[1];
 break; }case 4: {var v$2631 = e$2517[1];
var v$2632 = v$2631[0];
var v$2633 = v$2631[1];
var x$11848 = ["set",[v$2632,[fix$14121.$expString(v$2633),null]]];
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11848))) + ")";
 break; }case 8: {var v$2626 = e$2517[1];
var v$2627 = v$2626[0];
var v$2628 = v$2626[1];
var v$2629 = v$2626[2];
var x$11849;
var t$14142;
var t$14141 = "if";
var t$14138;
var es$6800 = [v$2627,[v$2628,[v$2629,null]]];
t$14138 = (basis$0List$1.map$697((function(env$14140){return function(v$13726){var v$14139 = env$14140[0];
return v$14139(v$13726);
};
})([fix$14121.$expString]),es$6800));
t$14142 = [t$14141,t$14138];
x$11849 = t$14142;
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11849))) + ")";
 break; }case 0: {var v$2622 = e$2517[1];
var v$2623 = v$2622[0];
var v$2624 = v$2622[1];
var x$11850 = ["while",[fix$14121.$expString(v$2623),[fix$14121.$expString(v$2624),null]]];
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11850))) + ")";
 break; }case 9: {var v$2620 = e$2517[1];
var x$11851 = ["begin",basis$0List$1.map$697((function(env$14137){return function(v$13727){var v$14136 = env$14137[0];
return v$14136(v$13727);
};
})([fix$14121.$expString]),v$2620)];
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11851))) + ")";
 break; }case 10: {var v$2616 = e$2517[1];
var v$2617 = v$2616[0];
var v$2618 = v$2616[1];
var x$11852;
var es$6802 = [v$2617,v$2618];
x$11852 = (basis$0List$1.map$697((function(env$14135){return function(v$13728){var v$14134 = env$14135[0];
return v$14134(v$13728);
};
})([fix$14121.$expString]),es$6802));
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11852))) + ")";
 break; }case 6: {var v$2611 = e$2517[1];
var v$2612 = v$2611[0];
var v$2613 = v$2611[1];
var v$2614 = v$2611[2];
var x$11853;
var t$14133;
var t$14132;
switch (v$2612[0]) { case 1: {t$14132 = "let";
 break; }default: {t$14132 = "let*";
} };
t$14133 = [t$14132,[("(" + (tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697((function(env$14131){return function(v$6806){var v$14130 = env$14131[0];
var v$6807 = v$6806[0];
var v$6808 = v$6806[1];
return ("(" + ((v$6807 + " ") + (v$14130(v$6808)))) + ")";
};
})([fix$14121.$expString]),v$2613)))) + ")",[fix$14121.$expString(v$2614),null]]];
x$11853 = t$14133;
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11853))) + ")";
 break; }case 7: {var v$2607 = e$2517[1];
var v$2608 = v$2607[0];
var v$2609 = v$2607[1];
var x$11854;
var t$14129;
var t$14128 = "lambda";
var t$14127;
var t$14126;
var t$14125;
var x$11855 = basis$0List$1.map$697((function(env$14124){return function(v$6816){var v$14122 = env$14124[0];
var v$14123 = env$14124[1];
var v$6817 = v$6816[0];
var v$6818 = v$6816[1];
var x$11856 = [v$14123(v$6818),[v$6817,null]];
return ("(" + (v$14122(x$11856))) + ")";
};
})([tuscheme$0tuscheme$1.spaceSep$414,tuscheme$0tuscheme$1.typeString$2200]),v$2608);
t$14125 = (("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11855))) + ")");
t$14126 = [t$14125,[fix$14121.$expString(v$2609),null]];
t$14127 = t$14126;
t$14129 = [t$14128,t$14127];
x$11854 = t$14129;
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11854))) + ")";
 break; }case 2: {var v$2603 = e$2517[1];
var v$2604 = v$2603[0];
var v$2605 = v$2603[1];
var x$11857 = ["lambda",[("(" + (tuscheme$0tuscheme$1.spaceSep$414(v$2604))) + ")",[fix$14121.$expString(v$2605),null]]];
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11857))) + ")";
 break; }default: {var v$2638 = e$2517[1];
var v$2639 = v$2638[0];
var v$2640 = v$2638[1];
var x$11859 = ["@",[fix$14121.$expString(v$2639),basis$0List$1.map$697((function(env$14144){return function(v$13729){var v$14143 = env$14144[0];
return v$14143(v$13729);
};
})([tuscheme$0tuscheme$1.typeString$2200]),v$2640)]];
return ("(" + (tuscheme$0tuscheme$1.spaceSep$414(x$11859))) + ")";
} };
};
};
tuscheme$0tuscheme$1.expString$2514 = fix$14121.$expString;
tuscheme$0tuscheme$1.unitVal$2641 = [4];
var fix$14145 = {};
fix$14145.$embedList = function(v$2645){if (v$2645 == null) {return [4];
} else {var v$2652 = v$2645;
var v$2653 = v$2652[0];
var v$2654 = v$2652[1];
return [2,[v$2653,fix$14145.$embedList(v$2654)]];
};
};
tuscheme$0tuscheme$1.embedList$2642 = fix$14145.$embedList;
tuscheme$0tuscheme$1.embedBool$2655 = function(b$2658){return [6,b$2658];
};
tuscheme$0tuscheme$1.bool$2659 = function(v$2662){switch (v$2662[0]) { case 6: {return v$2662[1];
 break; }default: {return true;
} };
};
tuscheme$0tuscheme$1.equalatoms$2670 = function(v$2694,v$13579){switch (v$2694[0]) { case 4: {switch (v$13579[0]) { case 4: {return true;
 break; }default: {return false;
} };
 break; }case 3: {switch (v$13579[0]) { case 3: {return v$2694[1] == v$13579[1];
 break; }default: {return false;
} };
 break; }case 0: {switch (v$13579[0]) { case 0: {return v$2694[1] == v$13579[1];
 break; }default: {return false;
} };
 break; }case 6: {switch (v$13579[0]) { case 6: {return v$2694[1] == v$13579[1];
 break; }default: {return false;
} };
 break; }default: {return false;
} };
};
var fix$14146 = {};
fix$14146.$equalpairs = function(v$2727,v$13580){lab$equalpairs: while (true) {switch (v$2727[0]) { case 2: {switch (v$13580[0]) { case 2: {var v$2735 = v$2727[1];
var v$2736 = v$2735[0];
var v$2737 = v$2735[1];
var v$2738 = v$13580[1];
var v$2739 = v$2738[0];
var v$2740 = v$2738[1];
if (fix$14146.$equalpairs(v$2736,v$2739)) {var t$14147 = v$2737;
var t$14148 = v$2740;
var v$2727 = t$14147;
var v$13580 = t$14148;
continue lab$equalpairs;
} else {return false;
};
 break; }default: {switch (v$2727[0]) { case 4: {switch (v$13580[0]) { case 4: {return true;
 break; }default: {return false;
} };
 break; }case 3: {switch (v$13580[0]) { case 3: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }case 0: {switch (v$13580[0]) { case 0: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }case 6: {switch (v$13580[0]) { case 6: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }default: {return false;
} };
} };
 break; }default: {switch (v$2727[0]) { case 4: {switch (v$13580[0]) { case 4: {return true;
 break; }default: {return false;
} };
 break; }case 3: {switch (v$13580[0]) { case 3: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }case 0: {switch (v$13580[0]) { case 0: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }case 6: {switch (v$13580[0]) { case 6: {return v$2727[1] == v$13580[1];
 break; }default: {return false;
} };
 break; }default: {return false;
} };
} };
};
};
tuscheme$0tuscheme$1.equalpairs$2712 = fix$14146.$equalpairs;
tuscheme$0tuscheme$1.testEqual$2744 = function(v$13581){return tuscheme$0tuscheme$1.equalpairs$2712(v$13581[0],v$13581[1]);
};
tuscheme$0tuscheme$1.cycleThrough$2745 = function(xs$2748){var remaining$2749 = [xs$2748];
var fix$14149 = {};
fix$14149.$next = function(v$2752){lab$next: while (true) {var v$2758 = remaining$2749[0];
if (v$2758 == null) {(remaining$2749[0] = xs$2748,0);
var t$14150 = 0;
var v$2752 = t$14150;
continue lab$next;
} else {var v$2763 = v$2758;
var v$2764 = v$2763[0];
var v$2765 = v$2763[1];
(remaining$2749[0] = v$2765,0);
return v$2764;
};
};
};
var next$2750 = fix$14149.$next;
if ((xs$2748 == null)?true:false) {throw [tuscheme$0tuscheme$1.en$InternalError$241,"empty list given to cycleThrough"];
} else {return function(v$13730){return next$2750(v$13730);
};
};
};
tuscheme$0tuscheme$1.unspecified$2770;
var xs$11862 = [[6,true],[[3,39],[[0,"this value is unspecified"],[[4],[[1,function(v$2772){var en$Unspecified$2773 = new String("Unspecified");
var exn$Unspecified$2773 = [en$Unspecified$2773];
throw exn$Unspecified$2773;
}],null]]]]];
var remaining$11863 = [xs$11862];
var fix$14151 = {};
fix$14151.$next = function(v$11865){lab$next: while (true) {var v$11866 = remaining$11863[0];
if (v$11866 == null) {(remaining$11863[0] = xs$11862,0);
var t$14152 = 0;
var v$11865 = t$14152;
continue lab$next;
} else {var v$11867 = v$11866;
var v$11868 = v$11867[0];
var v$11869 = v$11867[1];
(remaining$11863[0] = v$11869,0);
return v$11868;
};
};
};
var next$11864 = fix$14151.$next;
if ((xs$11862 == null)?true:false) {throw [tuscheme$0tuscheme$1.en$InternalError$241,"empty list given to cycleThrough"];
} else {tuscheme$0tuscheme$1.unspecified$2770 = (function(v$13731){return next$11864(v$13731);
});
};
var fix$14153 = {};
fix$14153.$tysubst = function(v$2839,v$2840){var fix$14661 = {};
fix$14661.$subst = function(v$2791){lab$subst: while (true) {switch (v$2791[0]) { case 0: {var v$2824 = v$2791[1];
try {return tuscheme$0tuscheme$1.find$139(v$2824,v$2840);
} catch(v$14666) {return ((function(env$14668){return function(v$2823){var v$14667 = env$14668[0];
var t$14669 = v$2823;
if (t$14669[0] == tuscheme$0tuscheme$1.en$NotFound$138) {return [0,v$14667];
} else {throw v$2823;
};
};
})([v$2824]))(v$14666);
};
 break; }case 1: {var v$2819 = v$2791[1];
return [1,v$2819];
 break; }case 4: {var v$2815 = v$2791[1];
var v$2816 = v$2815[0];
var v$2817 = v$2815[1];
return [4,[fix$14661.$subst(v$2816),basis$0List$1.map$697((function(env$14665){return function(v$13732){var v$14664 = env$14665[0];
return v$14664(v$13732);
};
})([fix$14661.$subst]),v$2817)]];
 break; }case 2: {var v$2811 = v$2791[1];
var v$2812 = v$2811[0];
var v$2813 = v$2811[1];
return [2,[basis$0List$1.map$697((function(env$14663){return function(v$13733){var v$14662 = env$14663[0];
return v$14662(v$13733);
};
})([fix$14661.$subst]),v$2812),fix$14661.$subst(v$2813)]];
 break; }default: {var v$2836 = v$2791[1];
var v$2837 = v$2836[0];
var v$2838 = v$2836[1];
var free$2825 = tuscheme$0tuscheme$1.freetyvars$2241([3,[v$2837,v$2838]]);
var new_taus$2826 = basis$0List$1.map$697((function(env$14671){return function(x$6845){var v$14670 = env$14671[0];
return v$14670([0,x$6845]);
};
})([fix$14661.$subst]),free$2825);
var potential_captures$2828;
var c$6848 = basis$0List$1.map$697((function(env$14673){return function(v$13734){var v$14672 = env$14673[0];
return v$14672(v$13734);
};
})([tuscheme$0tuscheme$1.freetyvars$2241]),new_taus$2826);
var fix$14674 = {};
fix$14674.$foldl = function(v$6850,v$6851){lab$foldl: while (true) {if (v$6851 == null) {return v$6850;
} else {var v$6852 = v$6851;
var v$6853 = v$6852[0];
var v$6854 = v$6852[1];
var t$14682;
var fix$14675 = {};
fix$14675.$foldl = function(v$11897,v$11898){lab$foldl: while (true) {if (v$11898 == null) {return v$11897;
} else {var v$11899 = v$11898;
var v$11900 = v$11899[0];
var v$11901 = v$11899[1];
var t$14679;
var t$14678;
var fix$14676 = {};
fix$14676.$exists = function(v$11906){lab$exists: while (true) {if (v$11906 == null) {return false;
} else {var v$11907 = v$11906;
var v$11908 = v$11907[0];
var v$11909 = v$11907[1];
if (v$11908 == v$11900) {return true;
} else {var t$14677 = v$11909;
var v$11906 = t$14677;
continue lab$exists;
};
};
};
};
var exists$11905 = fix$14676.$exists;
t$14678 = (exists$11905(v$11897));
t$14679 = (t$14678?v$11897:[v$11900,v$11897]);
var t$14680 = t$14679;
var t$14681 = v$11901;
var v$11897 = t$14680;
var v$11898 = t$14681;
continue lab$foldl;
};
};
};
var foldl$11896 = fix$14675.$foldl;
t$14682 = (foldl$11896(v$6850,v$6853));
var t$14683 = t$14682;
var t$14684 = v$6854;
var v$6850 = t$14683;
var v$6851 = t$14684;
continue lab$foldl;
};
};
};
var foldl$6849 = fix$14674.$foldl;
potential_captures$2828 = (foldl$6849(tuscheme$0tuscheme$1.emptyset$566(0),c$6848));
var actual_captures$2829 = basis$0List$1.filter$417((function(env$14686){return function(x$11915){var v$14685 = env$14686[0];
var fix$14687 = {};
fix$14687.$exists = function(v$11917){lab$exists: while (true) {if (v$11917 == null) {return false;
} else {var v$11918 = v$11917;
var v$11919 = v$11918[0];
var v$11920 = v$11918[1];
if (v$11919 == x$11915) {return true;
} else {var t$14688 = v$11920;
var v$11917 = t$14688;
continue lab$exists;
};
};
};
};
var exists$11916 = fix$14687.$exists;
return exists$11916(v$14685);
};
})([v$2837]),potential_captures$2828);
if ((actual_captures$2829 == null)?true:false) {var varenv$$2834 = tuscheme$0tuscheme$1.bindList$174(v$2837,basis$0List$1.map$697((function(env$14689){return function(v$2835){return [0,v$2835];
};
})([]),v$2837),v$2840);
return [3,[v$2837,fix$14153.$tysubst(v$2838,varenv$$2834)]];
} else {var t$14690;
throw [tuscheme$0tuscheme$1.en$LeftAsExercise$2146,"renameForallAvoiding"];
var t$14691 = t$14690;
var v$2791 = t$14691;
continue lab$subst;
};
} };
};
};
var subst$2788 = fix$14661.$subst;
return subst$2788(v$2839);
};
tuscheme$0tuscheme$1.tysubst$2774 = fix$14153.$tysubst;
tuscheme$0tuscheme$1.rename$2841 = function(v$2848,v$2849,v$2850){return tuscheme$0tuscheme$1.tysubst$2774(v$2850,tuscheme$0tuscheme$1.bindList$174(v$2848,basis$0List$1.map$697(function(v$2847){return [0,v$2847];
},v$2849),tuscheme$0tuscheme$1.emptyEnv$137(0)));
};
tuscheme$0tuscheme$1.instantiate$2851 = function(v$2864,v$13582,v$13583){switch (v$2864[0]) { case 3: {var v$2879 = v$2864[1];
var v$2880 = v$2879[0];
var v$2881 = v$2879[1];
var v$2870 = basis$0List$1.find$392(function(t$2878){return (tuscheme$0tuscheme$1.eqKind$2150(tuscheme$0tuscheme$1.kindof$2329(t$2878,v$13583),null))?false:true;
},v$13582);
switch (v$2870[0]) { case 0: {var v$2872 = v$2870[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("instantiated at type constructor `" + (tuscheme$0tuscheme$1.typeString$2200(v$2872))) + "', which is not a type"];
 break; }default: {try {return tuscheme$0tuscheme$1.tysubst$2774(v$2881,tuscheme$0tuscheme$1.bindList$174(v$2880,v$13582,tuscheme$0tuscheme$1.emptyEnv$137(0)));
} catch(v$14154) {return (function(BindListLength$2875){var t$14155 = BindListLength$2875;
if (t$14155[0] == tuscheme$0tuscheme$1.en$BindListLength$164) {throw [tuscheme$0tuscheme$1.en$TypeError$87,"instantiated polymorphic term at wrong number of types"];
} else {throw BindListLength$2875;
};
})(v$14154);
};
} };
 break; }default: {throw [tuscheme$0tuscheme$1.en$TypeError$87,"tried to instantiate term of non-quantified type " + (tuscheme$0tuscheme$1.typeString$2200(v$2864))];
} };
};
tuscheme$0tuscheme$1.infiniteTyvars$2884;
var fix$14156 = {};
fix$14156.$streamMap = function(xs$11926){return [0,[[1,function(v$11927){var v$11928 = tuscheme$0tuscheme$1.streamGet$703(xs$11926);
switch (v$11928[0]) { case 1: {return [1];
 break; }default: {var v$11929 = v$11928[1];
var v$11930 = v$11929[0];
var v$11931 = v$11929[1];
return [2,["'b-" + (tuscheme$0tuscheme$1.intString$351(v$11930)),fix$14156.$streamMap(v$11931)]];
} };
}]]];
};
var streamMap$11925 = fix$14156.$streamMap;
tuscheme$0tuscheme$1.infiniteTyvars$2884 = (streamMap$11925(tuscheme$0tuscheme$1.naturals$785));
var fix$14157 = {};
fix$14157.$eqType = function(v$2925,v$13585){switch (v$2925[0]) { case 0: {switch (v$13585[0]) { case 0: {return v$2925[1] == v$13585[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$13585[0]) { case 1: {return v$2925[1] == v$13585[1];
 break; }default: {return false;
} };
 break; }case 4: {switch (v$13585[0]) { case 4: {var v$2947 = v$2925[1];
var v$2948 = v$2947[0];
var v$2949 = v$2947[1];
var v$2950 = v$13585[1];
var v$2951 = v$2950[0];
var v$2952 = v$2950[1];
if (fix$14157.$eqType(v$2948,v$2951)) {return fix$14157.$eqTypes(v$2949,v$2952);
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 2: {switch (v$13585[0]) { case 2: {var v$2933 = v$2925[1];
var v$2934 = v$2933[0];
var v$2935 = v$2933[1];
var v$2936 = v$13585[1];
var v$2937 = v$2936[0];
var v$2938 = v$2936[1];
if (fix$14157.$eqType(v$2935,v$2938)) {return fix$14157.$eqTypes(v$2934,v$2937);
} else {return false;
};
 break; }default: {return false;
} };
 break; }default: {switch (v$13585[0]) { case 3: {var v$2978 = v$2925[1];
var v$2979 = v$2978[0];
var v$2980 = v$2978[1];
var v$2981 = v$13585[1];
var v$2982 = v$2981[0];
var v$2983 = v$2981[1];
var betas$2973;
var t$14651 = tuscheme$0tuscheme$1.streamTake$954;
var t$14650;
var fix$14647 = {};
fix$14647.$acc = function(v$6914,v$6915){lab$acc: while (true) {if (v$6914 == null) {return v$6915;
} else {var v$6916 = v$6914;
var v$6917 = v$6916[1];
var t$14648 = v$6917;
var t$14649 = SmlPrims.chk_ovf_i32(v$6915 + 1);
var v$6914 = t$14648;
var v$6915 = t$14649;
continue lab$acc;
};
};
};
var acc$6913 = fix$14647.$acc;
t$14650 = (acc$6913(v$2979,0));
var t$14639;
var fix$14638 = {};
fix$14638.$streamFilter = function(xs$11960){return [0,[[1,function(v$11961){var v$11962 = tuscheme$0tuscheme$1.streamGet$703(xs$11960);
switch (v$11962[0]) { case 1: {return [1];
 break; }default: {var v$11963 = v$11962[1];
var v$11964 = v$11963[0];
var v$11965 = v$11963[1];
var t$14646;
var t$14645;
var t$14644;
var fix$14642 = {};
fix$14642.$exists = function(v$11968){lab$exists: while (true) {if (v$11968 == null) {return false;
} else {var v$11969 = v$11968;
var v$11970 = v$11969[0];
var v$11971 = v$11969[1];
if (v$11970 == v$11964) {return true;
} else {var t$14643 = v$11971;
var v$11968 = t$14643;
continue lab$exists;
};
};
};
};
var exists$11967 = fix$14642.$exists;
t$14644 = (exists$11967(tuscheme$0tuscheme$1.freetyvars$2241(v$2980)));
if (t$14644) {t$14645 = true;
} else {var fix$14640 = {};
fix$14640.$exists = function(v$11973){lab$exists: while (true) {if (v$11973 == null) {return false;
} else {var v$11974 = v$11973;
var v$11975 = v$11974[0];
var v$11976 = v$11974[1];
if (v$11975 == v$11964) {return true;
} else {var t$14641 = v$11976;
var v$11973 = t$14641;
continue lab$exists;
};
};
};
};
var exists$11972 = fix$14640.$exists;
t$14645 = (exists$11972(tuscheme$0tuscheme$1.freetyvars$2241(v$2983)));
};
t$14646 = (t$14645?false:true);
if (t$14646) {return [2,[v$11964,fix$14638.$streamFilter(v$11965)]];
} else {return fix$14638.$streamFilter(v$11965);
};
} };
}]]];
};
var streamFilter$11959 = fix$14638.$streamFilter;
t$14639 = (streamFilter$11959(tuscheme$0tuscheme$1.infiniteTyvars$2884));
betas$2973 = (t$14651(t$14650,t$14639));
var t$14660;
var t$14659;
var fix$14656 = {};
fix$14656.$acc = function(v$6945,v$6946){lab$acc: while (true) {if (v$6945 == null) {return v$6946;
} else {var v$6947 = v$6945;
var v$6948 = v$6947[1];
var t$14657 = v$6948;
var t$14658 = SmlPrims.chk_ovf_i32(v$6946 + 1);
var v$6945 = t$14657;
var v$6946 = t$14658;
continue lab$acc;
};
};
};
var acc$6944 = fix$14656.$acc;
t$14659 = (acc$6944(v$2979,0));
var t$14655;
var fix$14652 = {};
fix$14652.$acc = function(v$6951,v$6952){lab$acc: while (true) {if (v$6951 == null) {return v$6952;
} else {var v$6953 = v$6951;
var v$6954 = v$6953[1];
var t$14653 = v$6954;
var t$14654 = SmlPrims.chk_ovf_i32(v$6952 + 1);
var v$6951 = t$14653;
var v$6952 = t$14654;
continue lab$acc;
};
};
};
var acc$6950 = fix$14652.$acc;
t$14655 = (acc$6950(v$2982,0));
t$14660 = (t$14659 == t$14655);
if (t$14660) {return fix$14157.$eqType(tuscheme$0tuscheme$1.tysubst$2774(v$2980,tuscheme$0tuscheme$1.bindList$174(v$2979,basis$0List$1.map$697(function(v$6959){return [0,v$6959];
},betas$2973),tuscheme$0tuscheme$1.emptyEnv$137(0))),tuscheme$0tuscheme$1.tysubst$2774(v$2983,tuscheme$0tuscheme$1.bindList$174(v$2982,basis$0List$1.map$697(function(v$6964){return [0,v$6964];
},betas$2973),tuscheme$0tuscheme$1.emptyEnv$137(0))));
} else {return false;
};
 break; }default: {return false;
} };
} };
};
fix$14157.$eqTypes = function(v$2998,v$13584){if (v$2998 == null) {return (v$13584 == null)?true:false;
} else {if (v$13584 == null) {return false;
} else {var v$3006 = v$2998;
var v$3007 = v$3006[0];
var v$3008 = v$3006[1];
var v$3009 = v$13584;
var v$3010 = v$3009[0];
var v$3011 = v$3009[1];
if (fix$14157.$eqType(v$3007,v$3010)) {return fix$14157.$eqTypes(v$3008,v$3011);
} else {return false;
};
};
};
};
tuscheme$0tuscheme$1.eqType$2889 = fix$14157.$eqType;
tuscheme$0tuscheme$1.eqTypes$2888 = fix$14157.$eqTypes;
tuscheme$0tuscheme$1.appearsUnprotectedIn$3014 = function(v$3159,v$3160){var fix$14158 = {};
fix$14158.$evaluatesX = function(v$3022){lab$evaluatesX: while (true) {switch (v$3022[0]) { case 5: {return false;
 break; }case 1: {return v$3022[1] == v$3159;
 break; }case 4: {var v$3150 = v$3022[1];
var v$3151 = v$3150[1];
var t$14177 = v$3151;
var v$3022 = t$14177;
continue lab$evaluatesX;
 break; }case 0: {var v$3146 = v$3022[1];
var v$3147 = v$3146[0];
var v$3148 = v$3146[1];
if (fix$14158.$evaluatesX(v$3147)) {return true;
} else {var t$14176 = v$3148;
var v$3022 = t$14176;
continue lab$evaluatesX;
};
 break; }case 10: {var v$3138 = v$3022[1];
var v$3139 = v$3138[0];
var v$3140 = v$3138[1];
if (fix$14158.$evaluatesX(v$3139)) {return true;
} else {var fix$14174 = {};
fix$14174.$exists = function(v$6972){lab$exists: while (true) {if (v$6972 == null) {return false;
} else {var v$6973 = v$6972;
var v$6974 = v$6973[0];
var v$6975 = v$6973[1];
if (fix$14158.$evaluatesX(v$6974)) {return true;
} else {var t$14175 = v$6975;
var v$6972 = t$14175;
continue lab$exists;
};
};
};
};
var exists$6971 = fix$14174.$exists;
return exists$6971(v$3140);
};
 break; }case 6: {var v$3097 = v$3022[1];
switch (v$3097[0][0]) { case 0: {var v$3099 = v$3097[1];
if (v$3099 == null) {var v$3100 = v$3097[2];
var t$14163 = v$3100;
var v$3022 = t$14163;
continue lab$evaluatesX;
} else {var v$3109 = v$3099;
var v$3110 = v$3109[0];
var v$3111 = v$3110[0];
var v$3112 = v$3110[1];
var v$3113 = v$3109[1];
var v$3114 = v$3097[2];
if (fix$14158.$evaluatesX(v$3112)) {return true;
} else {if ((v$3159 == v$3111)?false:true) {var t$14164 = [6,[[0],v$3113,v$3114]];
var v$3022 = t$14164;
continue lab$evaluatesX;
} else {return false;
};
};
};
 break; }default: {var v$3131 = v$3097[1];
var v$3132 = v$3097[2];
var t$14172;
var fix$14169 = {};
fix$14169.$exists = function(v$6985){lab$exists: while (true) {if (v$6985 == null) {return false;
} else {var v$6986 = v$6985;
var v$6987 = v$6986[0];
var v$6988 = v$6986[1];
var t$14170;
var v$6990 = v$6987[1];
t$14170 = (fix$14158.$evaluatesX(v$6990));
if (t$14170) {return true;
} else {var t$14171 = v$6988;
var v$6985 = t$14171;
continue lab$exists;
};
};
};
};
var exists$6984 = fix$14169.$exists;
t$14172 = (exists$6984(v$3131));
if (t$14172) {return true;
} else {var t$14168;
var t$14167;
var fix$14165 = {};
fix$14165.$exists = function(v$6998){lab$exists: while (true) {if (v$6998 == null) {return false;
} else {var v$6999 = v$6998;
var v$7000 = v$6999[0];
var v$7001 = v$6999[1];
if (v$7000[0] == v$3159) {return true;
} else {var t$14166 = v$7001;
var v$6998 = t$14166;
continue lab$exists;
};
};
};
};
var exists$6997 = fix$14165.$exists;
t$14167 = (exists$6997(v$3131));
t$14168 = (t$14167?false:true);
if (t$14168) {var t$14173 = v$3132;
var v$3022 = t$14173;
continue lab$evaluatesX;
} else {return false;
};
};
} };
 break; }case 8: {var v$3092 = v$3022[1];
var v$3093 = v$3092[0];
var v$3094 = v$3092[1];
var v$3095 = v$3092[2];
if (fix$14158.$evaluatesX(v$3093)) {return true;
} else {if (fix$14158.$evaluatesX(v$3094)) {return true;
} else {var t$14162 = v$3095;
var v$3022 = t$14162;
continue lab$evaluatesX;
};
};
 break; }case 9: {var v$3082 = v$3022[1];
var fix$14160 = {};
fix$14160.$exists = function(v$7016){lab$exists: while (true) {if (v$7016 == null) {return false;
} else {var v$7017 = v$7016;
var v$7018 = v$7017[0];
var v$7019 = v$7017[1];
if (fix$14158.$evaluatesX(v$7018)) {return true;
} else {var t$14161 = v$7019;
var v$7016 = t$14161;
continue lab$exists;
};
};
};
};
var exists$7015 = fix$14160.$exists;
return exists$7015(v$3082);
 break; }case 7: {return false;
 break; }case 3: {var v$3074 = v$3022[1];
var v$3075 = v$3074[0];
var t$14159 = v$3075;
var v$3022 = t$14159;
continue lab$evaluatesX;
 break; }default: {var v$3156 = v$3022[1];
var v$3158 = v$3156[1];
var t$14178 = v$3158;
var v$3022 = t$14178;
continue lab$evaluatesX;
} };
};
};
var evaluatesX$3019 = fix$14158.$evaluatesX;
return evaluatesX$3019(v$3160);
};
var fix$14179 = {};
fix$14179.$typeof = function(v$3421,v$3422,v$3423){var fix$14609 = {};
fix$14609.$literal = function(v$3171){switch (v$3171[0]) { case 4: {return [3,[["'a",null],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]]]];
 break; }case 2: {var v$3190 = v$3171[1];
var v$3191 = v$3190[0];
var v$3192 = v$3190[1];
return fix$14609.$listLiteral(fix$14609.$literal(v$3191),v$3192);
 break; }case 6: {return tuscheme$0tuscheme$1.booltype$2192;
 break; }case 3: {return tuscheme$0tuscheme$1.inttype$2191;
 break; }case 0: {return tuscheme$0tuscheme$1.symtype$2193;
 break; }default: {var en$ThisCan$tHappen$3193 = new String("ThisCan'tHappen");
var exn$ThisCan$tHappen$3193 = [en$ThisCan$tHappen$3193];
throw exn$ThisCan$tHappen$3193;
} };
};
fix$14609.$listLiteral = function(v$3196,v$3199){switch (v$3199[0]) { case 4: {return [4,[[1,"list"],[v$3196,null]]];
 break; }case 2: {var v$3217 = v$3199[1];
var v$3218 = v$3217[0];
var v$3219 = v$3217[1];
if (tuscheme$0tuscheme$1.eqType$2889(v$3196,fix$14609.$literal(v$3218))) {return fix$14609.$listLiteral(v$3196,v$3219);
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,"mixed types in list literal"];
};
 break; }default: {var en$ThisCan$tHappen$3221 = new String("ThisCan'tHappen");
var exn$ThisCan$tHappen$3221 = [en$ThisCan$tHappen$3221];
throw exn$ThisCan$tHappen$3221;
} };
};
var literal$3168 = fix$14609.$literal;
var listLiteral$3167 = fix$14609.$listLiteral;
var fix$14610 = {};
fix$14610.$ty = function(v$3225){lab$ty: while (true) {switch (v$3225[0]) { case 5: {var v$3410 = v$3225[1];
return literal$3168(v$3410);
 break; }case 1: {var v$3408 = v$3225[1];
return tuscheme$0tuscheme$1.find$139(v$3408,v$3423);
 break; }case 4: {var v$3404 = v$3225[1];
var v$3405 = v$3404[0];
var v$3406 = v$3404[1];
var tau_x$3398 = tuscheme$0tuscheme$1.find$139(v$3405,v$3423);
var tau_e$3399 = fix$14610.$ty(v$3406);
if (tuscheme$0tuscheme$1.eqType$2889(tau_x$3398,tau_e$3399)) {return tau_x$3398;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,(((("Set variable " + v$3405) + " of type ") + (tuscheme$0tuscheme$1.typeString$2200(tau_x$3398))) + " to value of type ") + (tuscheme$0tuscheme$1.typeString$2200(tau_e$3399))];
};
 break; }case 0: {var v$3394 = v$3225[1];
var v$3395 = v$3394[0];
var v$3396 = v$3394[1];
var tau1$3388 = fix$14610.$ty(v$3395);
fix$14610.$ty(v$3396);
if (tuscheme$0tuscheme$1.eqType$2889(tau1$3388,tuscheme$0tuscheme$1.booltype$2192)) {return tuscheme$0tuscheme$1.unittype$2194;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,(("Condition in while expression has type " + (tuscheme$0tuscheme$1.typeString$2200(tau1$3388))) + ", which should be ") + (tuscheme$0tuscheme$1.typeString$2200(tuscheme$0tuscheme$1.booltype$2192))];
};
 break; }case 10: {var v$3384 = v$3225[1];
var v$3385 = v$3384[0];
var v$3386 = v$3384[1];
var atys$3366 = basis$0List$1.map$697((function(env$14632){return function(v$13735){var v$14631 = env$14632[0];
return v$14631(v$13735);
};
})([fix$14610.$ty]),v$3386);
var v$3374 = fix$14610.$ty(v$3385);
switch (v$3374[0]) { case 2: {var v$3381 = v$3374[1];
var v$3382 = v$3381[0];
var v$3383 = v$3381[1];
if (tuscheme$0tuscheme$1.eqTypes$2888(atys$3366,v$3382)) {return v$3383;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,((("function of type " + (tuscheme$0tuscheme$1.typeString$2200(fix$14610.$ty(v$3385)))) + " received arguments of types (") + (tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697((function(env$14634){return function(v$13736){var v$14633 = env$14634[0];
return v$14633(v$13736);
};
})([tuscheme$0tuscheme$1.typeString$2200]),atys$3366)))) + ")"];
};
 break; }case 3: {throw [tuscheme$0tuscheme$1.en$TypeError$87,"function is polymorphic; instantiate before applying"];
 break; }default: {throw [tuscheme$0tuscheme$1.en$TypeError$87,"tried to apply non-function of type " + (tuscheme$0tuscheme$1.typeString$2200(fix$14610.$ty(v$3385)))];
} };
 break; }case 6: {var v$3345 = v$3225[1];
switch (v$3345[0][0]) { case 0: {var v$3347 = v$3345[1];
if (v$3347 == null) {var v$3348 = v$3345[2];
var t$14625 = v$3348;
var v$3225 = t$14625;
continue lab$ty;
} else {var v$3349 = v$3347;
var v$3350 = v$3349[0];
var v$3351 = v$3349[1];
var v$3352 = v$3345[2];
var t$14626 = [6,[[1],[v$3350,null],[6,[[0],v$3351,v$3352]]]];
var v$3225 = t$14626;
continue lab$ty;
};
 break; }default: {var v$3363 = v$3345[1];
var v$3364 = v$3345[2];
var Gamma$$3353;
var fix$14627 = {};
fix$14627.$foldl = function(v$7046,v$7047){lab$foldl: while (true) {if (v$7047 == null) {return v$7046;
} else {var v$7048 = v$7047;
var v$7049 = v$7048[0];
var v$7050 = v$7048[1];
var t$14628;
var v$7054 = v$7049[0];
var v$7055 = v$7049[1];
t$14628 = [[v$7054,fix$14610.$ty(v$7055)],v$7046];
var t$14629 = t$14628;
var t$14630 = v$7050;
var v$7046 = t$14629;
var v$7047 = t$14630;
continue lab$foldl;
};
};
};
var foldl$7045 = fix$14627.$foldl;
Gamma$$3353 = (foldl$7045(v$3423,v$3363));
return fix$14179.$typeof(v$3364,v$3422,Gamma$$3353);
} };
 break; }case 8: {var v$3340 = v$3225[1];
var v$3341 = v$3340[0];
var v$3342 = v$3340[1];
var v$3343 = v$3340[2];
if (tuscheme$0tuscheme$1.eqType$2889(fix$14610.$ty(v$3341),tuscheme$0tuscheme$1.booltype$2192)) {var v$9886 = fix$14610.$ty(v$3342);
var v$9887 = fix$14610.$ty(v$3343);
if (tuscheme$0tuscheme$1.eqType$2889(v$9886,v$9887)) {return v$9886;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,((("incompatible types " + (tuscheme$0tuscheme$1.typeString$2200(v$9886))) + " and ") + (tuscheme$0tuscheme$1.typeString$2200(v$9887))) + " across branches of if"];
};
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,"condition in if has type " + (tuscheme$0tuscheme$1.typeString$2200(fix$14610.$ty(v$3341)))];
};
 break; }case 9: {var v$3324 = v$3225[1];
var bodytypes$3302 = basis$0List$1.map$697((function(env$14621){return function(v$13737){var v$14620 = env$14621[0];
return v$14620(v$13737);
};
})([fix$14610.$ty]),v$3324);
var fix$14622 = {};
fix$14622.$last = function(v$3306,v$3309){lab$last: while (true) {if (v$3309 == null) {return v$3306;
} else {var v$3321 = v$3309;
var v$3322 = v$3321[0];
var v$3323 = v$3321[1];
var t$14623 = v$3322;
var t$14624 = v$3323;
var v$3306 = t$14623;
var v$3309 = t$14624;
continue lab$last;
};
};
};
var last$3303 = fix$14622.$last;
return last$3303(tuscheme$0tuscheme$1.unittype$2194,bodytypes$3302);
 break; }case 7: {var v$3298 = v$3225[1];
var v$3299 = v$3298[0];
var v$3300 = v$3298[1];
var newGamma$3281;
var fix$14611 = {};
fix$14611.$foldl = function(v$7073,v$7074){lab$foldl: while (true) {if (v$7074 == null) {return v$7073;
} else {var v$7075 = v$7074;
var v$7076 = v$7075[0];
var v$7077 = v$7075[1];
var t$14612;
var v$7086 = v$7076[0];
var v$7087 = v$7076[1];
var t$14616;
var t$14615;
var t$14614 = v$7086;
var t$14613;
if ((tuscheme$0tuscheme$1.kindof$2329(v$7087,v$3422)) == null) {t$14613 = v$7087;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,("used type constructor `" + (tuscheme$0tuscheme$1.typeString$2200(v$7087))) + "' as a type"];
};
t$14615 = [t$14614,t$14613];
t$14616 = [t$14615,v$7073];
t$14612 = t$14616;
var t$14617 = t$14612;
var t$14618 = v$7077;
var v$7073 = t$14617;
var v$7074 = t$14618;
continue lab$foldl;
};
};
};
var foldl$7072 = fix$14611.$foldl;
newGamma$3281 = (foldl$7072(v$3423,v$3299));
var bodytype$3291 = fix$14179.$typeof(v$3300,v$3422,newGamma$3281);
return [2,[basis$0List$1.map$697((function(env$14619){return function(v$3295){return v$3295[1];
};
})([]),v$3299),bodytype$3291]];
 break; }case 3: {var v$3277 = v$3225[1];
var v$3278 = v$3277[0];
var v$3279 = v$3277[1];
return tuscheme$0tuscheme$1.instantiate$2851(fix$14610.$ty(v$3278),v$3279,v$3422);
 break; }default: {var v$3418 = v$3225[1];
var v$3419 = v$3418[0];
var v$3420 = v$3418[1];
var Delta$$3411;
var fix$14635 = {};
fix$14635.$foldl = function(v$7099,v$7100){lab$foldl: while (true) {if (v$7100 == null) {return v$7099;
} else {var v$7101 = v$7100;
var v$7102 = v$7101[0];
var v$7103 = v$7101[1];
var t$14636 = [["" + v$7102,null],v$7099];
var t$14637 = v$7103;
var v$7099 = t$14636;
var v$7100 = t$14637;
continue lab$foldl;
};
};
};
var foldl$7098 = fix$14635.$foldl;
Delta$$3411 = (foldl$7098(v$3422,v$3419));
return [3,[v$3419,fix$14179.$typeof(v$3420,Delta$$3411,v$3423)]];
} };
};
};
var ty$3222 = fix$14610.$ty;
return ty$3222(v$3421);
};
tuscheme$0tuscheme$1.typeof$3161 = fix$14179.$typeof;
var fix$14180 = {};
fix$14180.$elabdef = function(v$3485,v$3486,v$3487){lab$elabdef: while (true) {switch (v$3485[0]) { case 1: {var v$3467 = v$3485[1];
var v$3468 = v$3467[0];
var v$3469 = v$3467[1];
var tau$3466 = tuscheme$0tuscheme$1.typeof$3161(v$3469,v$3486,v$3487);
return [[[v$3468,tau$3466],v$3487],tuscheme$0tuscheme$1.typeString$2200(tau$3466)];
 break; }case 2: {var v$3464 = v$3485[1];
var t$14185 = [1,["it",v$3464]];
var t$14186 = v$3486;
var t$14187 = v$3487;
var v$3485 = t$14185;
var v$3486 = t$14186;
var v$3487 = t$14187;
continue lab$elabdef;
 break; }case 3: {var v$3457 = v$3485[1];
var v$3458 = v$3457[0];
var v$3459 = v$3457[1];
var v$3460 = v$3457[2];
var v$3461 = v$3460[0];
var funty$3450 = [2,[basis$0List$1.map$697((function(env$14181){return function(v$3454){return v$3454[1];
};
})([]),v$3461),v$3459]];
var t$14182 = [0,[v$3458,funty$3450,[7,v$3460]]];
var t$14183 = v$3486;
var t$14184 = v$3487;
var v$3485 = t$14182;
var v$3486 = t$14183;
var v$3487 = t$14184;
continue lab$elabdef;
 break; }default: {var v$3481 = v$3485[1];
var v$3482 = v$3481[0];
var v$3483 = v$3481[1];
var v$3484 = v$3481[2];
var tau$3470;
if ((tuscheme$0tuscheme$1.kindof$2329(v$3483,v$3486)) == null) {tau$3470 = v$3483;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,("used type constructor `" + (tuscheme$0tuscheme$1.typeString$2200(v$3483))) + "' as a type"];
};
var Gamma$$3471 = [[v$3482,tau$3470],v$3487];
var tau$$3472 = tuscheme$0tuscheme$1.typeof$3161(v$3484,v$3486,Gamma$$3471);
if ((tuscheme$0tuscheme$1.eqType$2889(tau$3470,tau$$3472))?false:true) {throw [tuscheme$0tuscheme$1.en$TypeError$87,(((("identifier " + v$3482) + " is declared to have type ") + (tuscheme$0tuscheme$1.typeString$2200(tau$3470))) + " but has actual type ") + (tuscheme$0tuscheme$1.typeString$2200(tau$$3472))];
} else {if (tuscheme$0tuscheme$1.appearsUnprotectedIn$3014(v$3482,v$3484)) {throw [tuscheme$0tuscheme$1.en$TypeError$87,("identifier " + v$3482) + " is evaluated in right-hand side of val-rec"];
} else {return [Gamma$$3471,tuscheme$0tuscheme$1.typeString$2200(tau$3470)];
};
};
} };
};
};
tuscheme$0tuscheme$1.elabdef$3424 = fix$14180.$elabdef;
tuscheme$0tuscheme$1.pretokenString$3492 = function(v$3495){switch (v$3495[0]) { case 1: {return "'";
 break; }case 3: {var v$3514 = v$3495[1];
return tuscheme$0tuscheme$1.intString$351(v$3514);
 break; }case 0: {return v$3495[1]?"#t":"#f";
 break; }default: {return v$3495[1];
} };
};
tuscheme$0tuscheme$1.tokenString$3516 = function(v$7122){switch (v$7122[0]) { case 2: {switch (v$7122[1]) { case 1: {return "(";
 break; }case 0: {return "[";
 break; }default: {return "{";
} };
 break; }case 0: {switch (v$7122[1]) { case 1: {return ")";
 break; }case 0: {return "]";
 break; }default: {return "}";
} };
 break; }default: {var v$7126 = v$7122[1];
switch (v$7126[0]) { case 1: {return "'";
 break; }case 3: {var v$11985 = v$7126[1];
return tuscheme$0tuscheme$1.intString$351(v$11985);
 break; }case 0: {return v$7126[1]?"#t":"#f";
 break; }default: {return v$7126[1];
} };
} };
};
tuscheme$0tuscheme$1.schemeToken$3546;
var v$9945;
var t$14195 = tuscheme$0tuscheme$1.bracketLexer$1563;
var t$14188;
var v$9946;
var v$9948;
var v$9950;
var v$9952 = [1];
v$9950 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7169){return [0,[[0,function(v$12016){return v$9952;
}],xs$7169]];
},function(xs$12017){var v$12018;
var v$12019 = tuscheme$0tuscheme$1.streamGet$703(xs$12017);
switch (v$12019[0]) { case 1: {v$12018 = [1];
 break; }default: {var v$12020 = v$12019[1];
v$12018 = [0,[[0,v$12020[0]],v$12020[1]]];
} };
switch (v$12018[0]) { case 0: {var v$12021 = v$12018[1];
var v$12022 = v$12021[0];
switch (v$12022[0]) { case 0: {var v$12023 = v$12022[1];
return (39 == v$12023)?v$12018:[1];
 break; }default: {return v$12018;
} };
 break; }default: {return v$12018;
} };
}));
var v$9951;
var v$9959;
var v$9961 = tuscheme$0tuscheme$1.intChars$1508(function(c$12025){if ((c$12025 == 32)?true:((9 <= c$12025)?(c$12025 <= 13):false)) {return true;
} else {var fix$14189 = {};
fix$14189.$loop = function(j$12027){lab$loop: while (true) {if (j$12027 >= 7) {return false;
} else {if (("()[]{};".charCodeAt(j$12027)) == c$12025) {return true;
} else {var t$14190 = SmlPrims.chk_ovf_i32(j$12027 + 1);
var j$12027 = t$14190;
continue lab$loop;
};
};
};
};
var loop$12026 = fix$14189.$loop;
return loop$12026(0);
};
});
v$9959 = (tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7200){return [0,[[0,function(v$13738){return tuscheme$0tuscheme$1.intFromChars$1513(v$13738);
}],xs$7200]];
},v$9961));
v$9951 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7195){return [0,[[0,function(v$12029){return [3,v$12029];
}],xs$7195]];
},v$9959));
v$9948 = (function(xs$7159){var v$7160 = v$9950(xs$7159);
switch (v$7160[0]) { case 0: {var v$7161 = v$7160[1];
return [0,v$7161];
 break; }default: {return v$9951(xs$7159);
} };
});
var v$9949;
var v$9963;
var t$7219 = function(xs$7231){var v$7232;
var v$12043 = tuscheme$0tuscheme$1.streamGet$703(xs$7231);
switch (v$12043[0]) { case 1: {v$7232 = [1];
 break; }default: {var v$12044 = v$12043[1];
v$7232 = [0,[[0,v$12044[0]],v$12044[1]]];
} };
switch (v$7232[0]) { case 0: {var v$7233 = v$7232[1];
var v$7234 = v$7233[0];
switch (v$7234[0]) { case 0: {var v$7235 = v$7234[1];
var t$14194;
var t$14193;
if ((v$7235 == 32)?true:((9 <= v$7235)?(v$7235 <= 13):false)) {t$14193 = true;
} else {var fix$14191 = {};
fix$14191.$loop = function(j$12048){lab$loop: while (true) {if (j$12048 >= 7) {return false;
} else {if (("()[]{};".charCodeAt(j$12048)) == v$7235) {return true;
} else {var t$14192 = SmlPrims.chk_ovf_i32(j$12048 + 1);
var j$12048 = t$14192;
continue lab$loop;
};
};
};
};
var loop$12047 = fix$14191.$loop;
t$14193 = (loop$12047(0));
};
t$14194 = (t$14193?false:true);
return t$14194?v$7232:[1];
 break; }default: {return v$7232;
} };
 break; }default: {return v$7232;
} };
};
v$9963 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7227){return [0,[[0,function(x$12051){return function(y$12052){return [x$12051,y$12052];
};
}],xs$7227]];
},function(v$13739){return t$7219(v$13739);
}),tuscheme$0tuscheme$1.many$1261(function(v$13740){return t$7219(v$13740);
})));
v$9949 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7212){return [0,[[0,function(x$12055){var v$12056 = SmlPrims.implode(x$12055);
switch (v$12056) { case "#t": {return [0,true];
 break; }case "#f": {return [0,false];
 break; }default: {return [2,v$12056];
} };
}],xs$7212]];
},v$9963));
v$9946 = (function(xs$7153){var v$7154 = v$9948(xs$7153);
switch (v$7154[0]) { case 0: {var v$7155 = v$7154[1];
return [0,v$7155];
 break; }default: {return v$9949(xs$7153);
} };
});
t$14188 = (function(xs$7147){var v$7148 = v$9946(xs$7147);
switch (v$7148[0]) { case 0: {var v$7149 = v$7148[1];
return [0,v$7149];
 break; }default: {var v$12063 = tuscheme$0tuscheme$1.streamGet$703(xs$7147);
switch (v$12063[0]) { case 1: {return [1];
 break; }default: {var v$12064 = v$12063[1];
var v$12065 = v$12064[0];
switch (v$12065) { case 59: {return [1];
 break; }default: {var v$12066 = v$12064[1];
return [0,[[1,("invalid initial character in `" + (SmlPrims.implode([v$12065,tuscheme$0tuscheme$1.listOfStream$726(v$12066)]))) + "'"],[1]]];
} };
} };
} };
});
v$9945 = (t$14195(t$14188));
tuscheme$0tuscheme$1.schemeToken$3546 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7142){return [0,[[0,function(x$12069){return function(y$12070){return y$12070;
};
}],xs$7142]];
},tuscheme$0tuscheme$1.whitespace$1507),v$9945));
tuscheme$0tuscheme$1.pretoken$3548 = function(xs$7261){var v$7262 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12079){return [0,[[0,function(v$12080){return v$12080[1];
}],xs$12079]];
},function(v$13741){return tuscheme$0tuscheme$1.inline$1491(v$13741);
}))(xs$7261);
switch (v$7262[0]) { case 1: {return [1];
 break; }default: {var v$7263 = v$7262[1];
var v$7264 = v$7263[0];
switch (v$7264[0]) { case 1: {return [0,[[1,v$7264[1]],v$7263[1]]];
 break; }default: {var v$7265 = v$7264[1];
var v$7266 = v$7263[1];
var v$7267;
switch (v$7265[0]) { case 1: {var v$12082 = v$7265[1];
v$7267 = [0,v$12082];
 break; }default: {v$7267 = [1];
} };
switch (v$7267[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$7267[1]],v$7266]];
} };
} };
} };
};
tuscheme$0tuscheme$1.quote$3556 = function(xs$7277){var v$7278 = tuscheme$0tuscheme$1.pretoken$3548(xs$7277);
switch (v$7278[0]) { case 1: {return [1];
 break; }default: {var v$7279 = v$7278[1];
var v$7280 = v$7279[0];
switch (v$7280[0]) { case 1: {return [0,[[1,v$7280[1]],v$7279[1]]];
 break; }default: {var v$7281 = v$7280[1];
var v$7282 = v$7279[1];
var v$7283;
switch (v$7281[0]) { case 1: {v$7283 = [0,0];
 break; }default: {v$7283 = [1];
} };
switch (v$7283[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$7283[1]],v$7282]];
} };
} };
} };
};
tuscheme$0tuscheme$1.int$3561 = function(xs$7287){var v$7288 = tuscheme$0tuscheme$1.pretoken$3548(xs$7287);
switch (v$7288[0]) { case 1: {return [1];
 break; }default: {var v$7289 = v$7288[1];
var v$7290 = v$7289[0];
switch (v$7290[0]) { case 1: {return [0,[[1,v$7290[1]],v$7289[1]]];
 break; }default: {var v$7291 = v$7290[1];
var v$7292 = v$7289[1];
var v$7293;
switch (v$7291[0]) { case 3: {var v$12088 = v$7291[1];
v$7293 = [0,v$12088];
 break; }default: {v$7293 = [1];
} };
switch (v$7293[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$7293[1]],v$7292]];
} };
} };
} };
};
tuscheme$0tuscheme$1.booltok$3569 = function(xs$7297){var v$7298 = tuscheme$0tuscheme$1.pretoken$3548(xs$7297);
switch (v$7298[0]) { case 1: {return [1];
 break; }default: {var v$7299 = v$7298[1];
var v$7300 = v$7299[0];
switch (v$7300[0]) { case 1: {return [0,[[1,v$7300[1]],v$7299[1]]];
 break; }default: {var v$7301 = v$7300[1];
var v$7302 = v$7299[1];
var v$7303;
switch (v$7301[0]) { case 0: {var v$12092 = v$7301[1];
v$7303 = [0,v$12092];
 break; }default: {v$7303 = [1];
} };
switch (v$7303[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$7303[1]],v$7302]];
} };
} };
} };
};
tuscheme$0tuscheme$1.any_name$3585 = function(xs$12097){var v$12098 = tuscheme$0tuscheme$1.pretoken$3548(xs$12097);
switch (v$12098[0]) { case 1: {return [1];
 break; }default: {var v$12099 = v$12098[1];
var v$12100 = v$12099[0];
switch (v$12100[0]) { case 1: {return [0,[[1,v$12100[1]],v$12099[1]]];
 break; }default: {var v$12101 = v$12100[1];
var v$12102 = v$12099[1];
var v$12103;
switch (v$12101[0]) { case 2: {var v$12105 = v$12101[1];
v$12103 = [0,v$12105];
 break; }default: {v$12103 = [1];
} };
switch (v$12103[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12103[1]],v$12102]];
} };
} };
} };
};
tuscheme$0tuscheme$1.arrow$3586 = function(xs$7317){var v$7318 = tuscheme$0tuscheme$1.pretoken$3548(xs$7317);
switch (v$7318[0]) { case 1: {return [1];
 break; }default: {var v$7319 = v$7318[1];
var v$7320 = v$7319[0];
switch (v$7320[0]) { case 1: {return [0,[[1,v$7320[1]],v$7319[1]]];
 break; }default: {var v$7321 = v$7320[1];
var v$7322 = v$7319[1];
var v$7323;
switch (v$7321[0]) { case 2: {switch (v$7321[1]) { case "->": {v$7323 = [0,0];
 break; }default: {v$7323 = [1];
} };
 break; }default: {v$7323 = [1];
} };
switch (v$7323[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$7323[1]],v$7322]];
} };
} };
} };
};
tuscheme$0tuscheme$1.name$3595 = function(xs$7328){var v$7329;
var v$12119 = tuscheme$0tuscheme$1.pretoken$3548(xs$7328);
switch (v$12119[0]) { case 1: {v$7329 = [1];
 break; }default: {var v$12120 = v$12119[1];
var v$12121 = v$12120[0];
switch (v$12121[0]) { case 1: {v$7329 = [0,[[1,v$12121[1]],v$12120[1]]];
 break; }default: {var v$12122 = v$12121[1];
var v$12123 = v$12120[1];
var v$12124;
switch (v$12122[0]) { case 2: {var v$12125 = v$12122[1];
v$12124 = [0,v$12125];
 break; }default: {v$12124 = [1];
} };
switch (v$12124[0]) { case 1: {v$7329 = [1];
 break; }default: {v$7329 = [0,[[0,v$12124[1]],v$12123]];
} };
} };
} };
switch (v$7329[0]) { case 0: {var v$7330 = v$7329[1];
var v$7331 = v$7330[0];
switch (v$7331[0]) { case 0: {var v$7332 = v$7331[1];
return ((v$7332 == "->")?false:true)?v$7329:[1];
 break; }default: {return v$7329;
} };
 break; }default: {return v$7329;
} };
};
tuscheme$0tuscheme$1.tyvar$3599;
var v$9993 = tuscheme$0tuscheme$1.s$jml$1604(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7353){return [0,[[0,function(y$12138){return "'" + y$12138;
}],xs$7353]];
},function(v$13742){return tuscheme$0tuscheme$1.name$3595(v$13742);
}),"type variable (got quote mark)");
tuscheme$0tuscheme$1.tyvar$3599 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7347){return [0,[[0,function(x$12163){return function(y$12164){return y$12164;
};
}],xs$7347]];
},function(xs$12165){var v$12166 = tuscheme$0tuscheme$1.pretoken$3548(xs$12165);
switch (v$12166[0]) { case 1: {return [1];
 break; }default: {var v$12167 = v$12166[1];
var v$12168 = v$12167[0];
switch (v$12168[0]) { case 1: {return [0,[[1,v$12168[1]],v$12167[1]]];
 break; }default: {var v$12169 = v$12168[1];
var v$12170 = v$12167[1];
var v$12171;
switch (v$12169[0]) { case 1: {v$12171 = [0,0];
 break; }default: {v$12171 = [1];
} };
switch (v$12171[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12171[1]],v$12170]];
} };
} };
} };
}),v$9993));
tuscheme$0tuscheme$1.formalsOf$3600 = function(what$3603,name$3606,context$3609){var v$9998 = tuscheme$0tuscheme$1.nodups$1640("formal parameter",context$3609);
var v$9999;
var p$12172;
var v$10001 = tuscheme$0tuscheme$1.many$1261(name$3606);
p$12172 = (tuscheme$0tuscheme$1.liberalBracket$1841(what$3603,tuscheme$0tuscheme$1.s$jml$1604(v$10001,what$3603)));
v$9999 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12173){return [0,[[0,function(x$12174){return function(y$12175){return [x$12174,y$12175];
};
}],xs$12173]];
},function(xs$12176){var tx$12177 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12178){return [0,[[0,function(v$12179){return v$12179[0];
}],xs$12178]];
},function(v$13743){return tuscheme$0tuscheme$1.inline$1491(v$13743);
});
var v$12180 = tx$12177(xs$12176);
switch (v$12180[0]) { case 0: {return [0,[v$12180[1][0],xs$12176]];
 break; }default: {return [1];
} };
}),p$12172));
return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7362){return [0,[[0,v$9998],xs$7362]];
},v$9999);
};
tuscheme$0tuscheme$1.bindingsOf$3610 = function(what$3613,name$3616,exp$3619){var binding$3620;
var v$10003 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7373){return [0,[[0,function(x$12183){return function(y$12184){return [x$12183,y$12184];
};
}],xs$7373]];
},name$3616),exp$3619);
binding$3620 = (tuscheme$0tuscheme$1.liberalBracket$1841(what$3613,tuscheme$0tuscheme$1.s$jml$1604(v$10003,what$3613)));
var v$10006 = ("(... " + what$3613) + " ...) in bindings";
var v$10007 = tuscheme$0tuscheme$1.many$1261(binding$3620);
return tuscheme$0tuscheme$1.liberalBracket$1841(v$10006,tuscheme$0tuscheme$1.s$jml$1604(v$10007,v$10006));
};
tuscheme$0tuscheme$1.distinctBsIn$3621 = function(bindings$3624,context$3627){var v$10013 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12195){return [0,[[0,function(x$12196){return function(y$12197){return [x$12196,y$12197];
};
}],xs$12195]];
},function(xs$12198){var tx$12199 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12200){return [0,[[0,function(v$12201){return v$12201[0];
}],xs$12200]];
},function(v$13744){return tuscheme$0tuscheme$1.inline$1491(v$13744);
});
var v$12202 = tx$12199(xs$12198);
switch (v$12202[0]) { case 0: {return [0,[v$12202[1][0],xs$12198]];
 break; }default: {return [1];
} };
}),bindings$3624);
return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7399){return [0,[[0,function(v$12209){var v$12210 = v$12209[0];
var v$12211 = v$12209[1];
var v$12212 = (tuscheme$0tuscheme$1.nodups$1640("bound name",context$3627))([v$12210,basis$0List$1.map$697(function(v$12213){return v$12213[0];
},v$12211)]);
switch (v$12212[0]) { case 0: {return [0,v$12211];
 break; }default: {var v$12214 = v$12212[1];
return [1,v$12214];
} };
}],xs$7399]];
},v$10013);
};
tuscheme$0tuscheme$1.recordFieldsOf$3637 = function(name$3640){var v$10020 = tuscheme$0tuscheme$1.nodups$1640("record fields","record definition");
var v$10021;
var p$12215;
var v$10023 = tuscheme$0tuscheme$1.many$1261(name$3640);
p$12215 = (tuscheme$0tuscheme$1.liberalBracket$1841("(field ...)",tuscheme$0tuscheme$1.s$jml$1604(v$10023,"(field ...)")));
v$10021 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12216){return [0,[[0,function(x$12217){return function(y$12218){return [x$12217,y$12218];
};
}],xs$12216]];
},function(xs$12219){var tx$12220 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12221){return [0,[[0,function(v$12222){return v$12222[0];
}],xs$12221]];
},function(v$13745){return tuscheme$0tuscheme$1.inline$1491(v$13745);
});
var v$12223 = tx$12220(xs$12219);
switch (v$12223[0]) { case 0: {return [0,[v$12223[1][0],xs$12219]];
 break; }default: {return [1];
} };
}),p$12215));
return tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7422){return [0,[[0,v$10020],xs$7422]];
},v$10021);
};
tuscheme$0tuscheme$1.kw$3641 = function(keyword$3644,xs$7435){var v$7436;
var v$12234 = tuscheme$0tuscheme$1.pretoken$3548(xs$7435);
switch (v$12234[0]) { case 1: {v$7436 = [1];
 break; }default: {var v$12235 = v$12234[1];
var v$12236 = v$12235[0];
switch (v$12236[0]) { case 1: {v$7436 = [0,[[1,v$12236[1]],v$12235[1]]];
 break; }default: {var v$12237 = v$12236[1];
var v$12238 = v$12235[1];
var v$12239;
switch (v$12237[0]) { case 2: {var v$12240 = v$12237[1];
v$12239 = [0,v$12240];
 break; }default: {v$12239 = [1];
} };
switch (v$12239[0]) { case 1: {v$7436 = [1];
 break; }default: {v$7436 = [0,[[0,v$12239[1]],v$12238]];
} };
} };
} };
switch (v$7436[0]) { case 0: {var v$7437 = v$7436[1];
var v$7438 = v$7437[0];
switch (v$7438[0]) { case 0: {var v$7439 = v$7438[1];
return (keyword$3644 == v$7439)?v$7436:[1];
 break; }default: {return v$7436;
} };
 break; }default: {return v$7436;
} };
};
tuscheme$0tuscheme$1.usageParsers$3645 = function(ps$3648){var ts$12242 = basis$0List$1.map$697(tuscheme$0tuscheme$1.usageParser$1871(function(v$13625){return function(v$13626){return tuscheme$0tuscheme$1.kw$3641(v$13625,v$13626);
};
}),ps$3648);
var fix$14196 = {};
fix$14196.$foldr = function(v$12244){if (v$12244 == null) {return function(v$12245){return [1];
};
} else {var v$12246 = v$12244;
var v$12247 = v$12246[0];
var v$12248 = v$12246[1];
var v$13408 = fix$14196.$foldr(v$12248);
return function(xs$12252){var v$12253 = v$12247(xs$12252);
switch (v$12253[0]) { case 0: {var v$12254 = v$12253[1];
return [0,v$12254];
 break; }default: {return v$13408(xs$12252);
} };
};
};
};
var foldr$12243 = fix$14196.$foldr;
return foldr$12243(ts$12242);
};
tuscheme$0tuscheme$1.notDot$3649 = function(v$13586,v$3668){switch (v$3668) { case ".": {return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$13586[0],v$13586[1]))(["this interpreter cannot handle . in quoted S-expressions",null])];
 break; }default: {return [0,v$3668];
} };
};
var fix$14197 = {};
fix$14197.$sexp = function(tokens$3653){lab$sexp: while (true) {var v$10026;
var v$10028;
var v$10030;
var v$10032;
var v$10034;
var v$10037;
var v$10039 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14207){return function(xs$12256){return [0,[[0,(function(env$14208){return function(x$12257){return (function(env$14210){return function(y$12258){var v$14209 = env$14210[0];
return [v$14209,y$12258];
};
})([x$12257]);
};
})([])],xs$12256]];
};
})([]),(function(env$14202){return function(xs$12259){var v$14200 = env$14202[0];
var v$14201 = env$14202[1];
var tx$12260 = v$14201((function(env$14205){return function(xs$12261){return [0,[[0,(function(env$14206){return function(v$12262){return v$12262[0];
};
})([])],xs$12261]];
};
})([]),(function(env$14204){return function(v$13746){var v$14203 = env$14204[0];
return v$14203(v$13746);
};
})([v$14200]));
var v$12263 = tx$12260(xs$12259);
switch (v$12263[0]) { case 0: {return [0,[v$12263[1][0],xs$12259]];
 break; }default: {return [1];
} };
};
})([tuscheme$0tuscheme$1.inline$1491,tuscheme$0tuscheme$1.s$jtl$1007])),(function(env$14199){return function(xs$13470){var v$14198 = env$14199[0];
var v$13471 = v$14198(xs$13470);
switch (v$13471[0]) { case 1: {return [1];
 break; }default: {var v$13472 = v$13471[1];
var v$13473 = v$13472[0];
switch (v$13473[0]) { case 1: {return [0,[[1,v$13473[1]],v$13472[1]]];
 break; }default: {var v$13474 = v$13473[1];
var v$13475 = v$13472[1];
var v$13476;
switch (v$13474[0]) { case 2: {var v$13477 = v$13474[1];
v$13476 = [0,v$13477];
 break; }default: {v$13476 = [1];
} };
switch (v$13476[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$13476[1]],v$13475]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548]));
v$10037 = (tuscheme$0tuscheme$1.s$jtla$1279((function(env$14212){return function(xs$7485){var v$14211 = env$14212[0];
return [0,[[0,(function(env$14214){return function(v$12276){var v$14213 = env$14214[0];
var v$12277 = v$12276[1];
switch (v$12277) { case ".": {var v$12278 = v$12276[0];
return [1,(v$14213(v$12278[0],v$12278[1]))(["this interpreter cannot handle . in quoted S-expressions",null])];
 break; }default: {return [0,v$12277];
} };
};
})([v$14211])],xs$7485]];
};
})([tuscheme$0tuscheme$1.synerrormsg$1331]),v$10039));
v$10034 = (tuscheme$0tuscheme$1.s$jtl$1007((function(env$14215){return function(xs$7480){return [0,[[0,(function(env$14216){return function(v$12280){return [0,v$12280];
};
})([])],xs$7480]];
};
})([]),v$10037));
var v$10035 = tuscheme$0tuscheme$1.s$jtl$1007((function(env$14219){return function(xs$7495){return [0,[[0,(function(env$14220){return function(v$12299){return [3,v$12299];
};
})([])],xs$7495]];
};
})([]),(function(env$14218){return function(xs$12300){var v$14217 = env$14218[0];
var v$12301 = v$14217(xs$12300);
switch (v$12301[0]) { case 1: {return [1];
 break; }default: {var v$12302 = v$12301[1];
var v$12303 = v$12302[0];
switch (v$12303[0]) { case 1: {return [0,[[1,v$12303[1]],v$12302[1]]];
 break; }default: {var v$12304 = v$12303[1];
var v$12305 = v$12302[1];
var v$12306;
switch (v$12304[0]) { case 3: {var v$12307 = v$12304[1];
v$12306 = [0,v$12307];
 break; }default: {v$12306 = [1];
} };
switch (v$12306[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12306[1]],v$12305]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548]));
v$10032 = ((function(env$14223){return function(xs$7473){var v$14221 = env$14223[0];
var v$14222 = env$14223[1];
var v$7474 = v$14222(xs$7473);
switch (v$7474[0]) { case 0: {var v$7475 = v$7474[1];
return [0,v$7475];
 break; }default: {return v$14221(xs$7473);
} };
};
})([v$10035,v$10034]));
var v$10033 = tuscheme$0tuscheme$1.s$jtl$1007((function(env$14226){return function(xs$7500){return [0,[[0,(function(env$14227){return function(b$12326){return [6,b$12326];
};
})([])],xs$7500]];
};
})([]),(function(env$14225){return function(xs$12327){var v$14224 = env$14225[0];
var v$12328 = v$14224(xs$12327);
switch (v$12328[0]) { case 1: {return [1];
 break; }default: {var v$12329 = v$12328[1];
var v$12330 = v$12329[0];
switch (v$12330[0]) { case 1: {return [0,[[1,v$12330[1]],v$12329[1]]];
 break; }default: {var v$12331 = v$12330[1];
var v$12332 = v$12329[1];
var v$12333;
switch (v$12331[0]) { case 0: {var v$12334 = v$12331[1];
v$12333 = [0,v$12334];
 break; }default: {v$12333 = [1];
} };
switch (v$12333[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12333[1]],v$12332]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548]));
v$10030 = ((function(env$14230){return function(xs$7467){var v$14228 = env$14230[0];
var v$14229 = env$14230[1];
var v$7468 = v$14229(xs$7467);
switch (v$7468[0]) { case 0: {var v$7469 = v$7468[1];
return [0,v$7469];
 break; }default: {return v$14228(xs$7467);
} };
};
})([v$10033,v$10032]));
var v$10031 = tuscheme$0tuscheme$1.s$jal$1611((function(env$14232){return function(tokens$12335){var v$14231 = env$14232[0];
var v$12336 = v$14231(tokens$12335);
switch (v$12336[0]) { case 0: {var v$12337 = v$12336[1];
var v$12338 = v$12337[0];
switch (v$12338[0]) { case 0: {var v$12339 = v$12338[1];
var t$14234;
var t$14233;
switch (v$12339[1]) { case 2: {t$14233 = false;
 break; }default: {t$14233 = true;
} };
t$14234 = (t$14233?false:true);
return t$14234?v$12336:[1];
 break; }default: {return v$12336;
} };
 break; }default: {return v$12336;
} };
};
})([tuscheme$0tuscheme$1.left$1682]),"curly brackets may not be used in S-expressions");
v$10028 = ((function(env$14237){return function(xs$7461){var v$14235 = env$14237[0];
var v$14236 = env$14237[1];
var v$7462 = v$14236(xs$7461);
switch (v$7462[0]) { case 0: {var v$7463 = v$7462[1];
return [0,v$7463];
 break; }default: {return v$14235(xs$7461);
} };
};
})([v$10031,v$10030]));
var v$10029;
var v$10045;
var v$10047 = tuscheme$0tuscheme$1.many$1261((function(env$14239){return function(v$13747){var v$14238 = env$14239[0];
return v$14238(v$13747);
};
})([fix$14197.$sexp]));
v$10045 = (tuscheme$0tuscheme$1.liberalBracket$1841("list of S-expressions",tuscheme$0tuscheme$1.s$jml$1604(v$10047,"list of S-expressions")));
v$10029 = (tuscheme$0tuscheme$1.s$jtl$1007((function(env$14241){return function(xs$7506){var v$14240 = env$14241[0];
return [0,[[0,(function(env$14243){return function(v$13748){var v$14242 = env$14243[0];
return v$14242(v$13748);
};
})([v$14240])],xs$7506]];
};
})([tuscheme$0tuscheme$1.embedList$2642]),v$10045));
v$10026 = ((function(env$14246){return function(xs$7455){var v$14244 = env$14246[0];
var v$14245 = env$14246[1];
var v$7456 = v$14245(xs$7455);
switch (v$7456[0]) { case 0: {var v$7457 = v$7456[1];
return [0,v$7457];
 break; }default: {return v$14244(xs$7455);
} };
};
})([v$10029,v$10028]));
var v$10027;
var v$10049 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14251){return function(xs$7525){return [0,[[0,(function(env$14252){return function(x$12371){return (function(env$14253){return function(y$12372){return y$12372;
};
})([]);
};
})([])],xs$7525]];
};
})([]),(function(env$14250){return function(xs$12373){var v$14249 = env$14250[0];
var v$12374 = v$14249(xs$12373);
switch (v$12374[0]) { case 1: {return [1];
 break; }default: {var v$12375 = v$12374[1];
var v$12376 = v$12375[0];
switch (v$12376[0]) { case 1: {return [0,[[1,v$12376[1]],v$12375[1]]];
 break; }default: {var v$12377 = v$12376[1];
var v$12378 = v$12375[1];
var v$12379;
switch (v$12377[0]) { case 1: {v$12379 = [0,0];
 break; }default: {v$12379 = [1];
} };
switch (v$12379[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12379[1]],v$12378]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548])),(function(env$14248){return function(v$13749){var v$14247 = env$14248[0];
return v$14247(v$13749);
};
})([fix$14197.$sexp]));
v$10027 = (tuscheme$0tuscheme$1.s$jtl$1007((function(env$14255){return function(xs$7514){var v$14254 = env$14255[0];
return [0,[[0,(function(env$14257){return function(v$12381){var v$14256 = env$14257[0];
return v$14256([[0,"quote"],[v$12381,null]]);
};
})([v$14254])],xs$7514]];
};
})([tuscheme$0tuscheme$1.embedList$2642]),v$10049));
var v$7450 = v$10026(tokens$3653);
switch (v$7450[0]) { case 0: {var v$7451 = v$7450[1];
return [0,v$7451];
 break; }default: {return v$10027(tokens$3653);
} };
};
};
tuscheme$0tuscheme$1.sexp$3650 = fix$14197.$sexp;
tuscheme$0tuscheme$1.atomicSchemeExpOf$3670 = function(name$3673){var v$10054;
var v$10056 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7543){return [0,[[0,function(v$12383){return [1,v$12383];
}],xs$7543]];
},name$3673);
var v$10057;
var v$10061 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7553){return [0,[[0,function(v$12402){return [3,v$12402];
}],xs$7553]];
},function(xs$12403){var v$12404 = tuscheme$0tuscheme$1.pretoken$3548(xs$12403);
switch (v$12404[0]) { case 1: {return [1];
 break; }default: {var v$12405 = v$12404[1];
var v$12406 = v$12405[0];
switch (v$12406[0]) { case 1: {return [0,[[1,v$12406[1]],v$12405[1]]];
 break; }default: {var v$12407 = v$12406[1];
var v$12408 = v$12405[1];
var v$12409;
switch (v$12407[0]) { case 3: {var v$12410 = v$12407[1];
v$12409 = [0,v$12410];
 break; }default: {v$12409 = [1];
} };
switch (v$12409[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12409[1]],v$12408]];
} };
} };
} };
});
v$10057 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7548){return [0,[[0,function(v$12412){return [5,v$12412];
}],xs$7548]];
},v$10061));
v$10054 = (function(xs$7536){var v$7537 = v$10056(xs$7536);
switch (v$7537[0]) { case 0: {var v$7538 = v$7537[1];
return [0,v$7538];
 break; }default: {return v$10057(xs$7536);
} };
});
var v$10055;
var v$10065 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7563){return [0,[[0,function(b$12431){return [6,b$12431];
}],xs$7563]];
},function(xs$12432){var v$12433 = tuscheme$0tuscheme$1.pretoken$3548(xs$12432);
switch (v$12433[0]) { case 1: {return [1];
 break; }default: {var v$12434 = v$12433[1];
var v$12435 = v$12434[0];
switch (v$12435[0]) { case 1: {return [0,[[1,v$12435[1]],v$12434[1]]];
 break; }default: {var v$12436 = v$12435[1];
var v$12437 = v$12434[1];
var v$12438;
switch (v$12436[0]) { case 0: {var v$12439 = v$12436[1];
v$12438 = [0,v$12439];
 break; }default: {v$12438 = [1];
} };
switch (v$12438[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12438[1]],v$12437]];
} };
} };
} };
});
v$10055 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7558){return [0,[[0,function(v$12441){return [5,v$12441];
}],xs$7558]];
},v$10065));
return function(xs$7530){var v$7531 = v$10054(xs$7530);
switch (v$7531[0]) { case 0: {var v$7532 = v$7531[1];
return [0,v$7532];
 break; }default: {return v$10055(xs$7530);
} };
};
};
var fix$14258 = {};
fix$14258.$fullSchemeExpOf = function(atomic$3681,keywordsOf$3684){var v$10068;
var v$10070;
var v$10072;
var v$10074;
var v$10076;
var v$10079 = keywordsOf$3684(function(tokens$7601){return (fix$14258.$fullSchemeExpOf(atomic$3681,keywordsOf$3684))(tokens$7601);
});
v$10076 = (function(xs$7598){var v$7599 = atomic$3681(xs$7598);
switch (v$7599[0]) { case 0: {var v$7600 = v$7599[1];
return [0,v$7600];
 break; }default: {return v$10079(xs$7598);
} };
});
var v$10077;
var v$10081 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7618){return [0,[[0,function(v$12450){return [5,v$12450];
}],xs$7618]];
},function(v$13750){return tuscheme$0tuscheme$1.sexp$3650(v$13750);
});
v$10077 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7612){return [0,[[0,function(x$12474){return function(y$12475){return y$12475;
};
}],xs$7612]];
},function(xs$12476){var v$12477 = tuscheme$0tuscheme$1.pretoken$3548(xs$12476);
switch (v$12477[0]) { case 1: {return [1];
 break; }default: {var v$12478 = v$12477[1];
var v$12479 = v$12478[0];
switch (v$12479[0]) { case 1: {return [0,[[1,v$12479[1]],v$12478[1]]];
 break; }default: {var v$12480 = v$12479[1];
var v$12481 = v$12478[1];
var v$12482;
switch (v$12480[0]) { case 1: {v$12482 = [0,0];
 break; }default: {v$12482 = [1];
} };
switch (v$12482[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12482[1]],v$12481]];
} };
} };
} };
}),v$10081));
v$10074 = (function(xs$7592){var v$7593 = v$10076(xs$7592);
switch (v$7593[0]) { case 0: {var v$7594 = v$7593[1];
return [0,v$7594];
 break; }default: {return v$10077(xs$7592);
} };
});
var v$10075;
var v$10087 = tuscheme$0tuscheme$1.s$jtla$1279(function(xs$12491){return [0,[[0,function(v$12492){var v$12493 = v$12492[0];
var v$12494 = v$12492[1];
var msg$12495;
var t$14606 = "quote ' followed by right bracket ";
var t$14605;
switch (v$12494) { case 1: {t$14605 = ")";
 break; }case 0: {t$14605 = "]";
 break; }default: {t$14605 = "}";
} };
msg$12495 = (t$14606 + t$14605);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$12493[0],v$12493[1]))([msg$12495,null])];
}],xs$12491]];
},function(v$13751){return tuscheme$0tuscheme$1.right$1696(v$13751);
});
v$10075 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7629){return [0,[[0,function(x$12519){return function(y$12520){return y$12520;
};
}],xs$7629]];
},function(xs$12521){var v$12522 = tuscheme$0tuscheme$1.pretoken$3548(xs$12521);
switch (v$12522[0]) { case 1: {return [1];
 break; }default: {var v$12523 = v$12522[1];
var v$12524 = v$12523[0];
switch (v$12524[0]) { case 1: {return [0,[[1,v$12524[1]],v$12523[1]]];
 break; }default: {var v$12525 = v$12524[1];
var v$12526 = v$12523[1];
var v$12527;
switch (v$12525[0]) { case 1: {v$12527 = [0,0];
 break; }default: {v$12527 = [1];
} };
switch (v$12527[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12527[1]],v$12526]];
} };
} };
} };
}),v$10087));
v$10072 = (function(xs$7586){var v$7587 = v$10074(xs$7586);
switch (v$7587[0]) { case 0: {var v$7588 = v$7587[1];
return [0,v$7588];
 break; }default: {return v$10075(xs$7586);
} };
});
var v$10073 = tuscheme$0tuscheme$1.s$jal$1611(function(tokens$12528){var v$12529 = tuscheme$0tuscheme$1.left$1682(tokens$12528);
switch (v$12529[0]) { case 0: {var v$12530 = v$12529[1];
var v$12531 = v$12530[0];
switch (v$12531[0]) { case 0: {var v$12532 = v$12531[1];
var t$14608;
var t$14607;
switch (v$12532[1]) { case 2: {t$14607 = false;
 break; }default: {t$14607 = true;
} };
t$14608 = (t$14607?false:true);
return t$14608?v$12529:[1];
 break; }default: {return v$12529;
} };
 break; }default: {return v$12529;
} };
},"curly brackets are not supported");
v$10070 = (function(xs$7580){var v$7581 = v$10072(xs$7580);
switch (v$7581[0]) { case 0: {var v$7582 = v$7581[1];
return [0,v$7582];
 break; }default: {return v$10073(xs$7580);
} };
});
var v$10071 = tuscheme$0tuscheme$1.s$jal$1611(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7641){return [0,[[0,function(x$12536){return function(y$12537){return y$12537;
};
}],xs$7641]];
},function(v$13752){return tuscheme$0tuscheme$1.left$1682(v$13752);
}),function(v$13753){return tuscheme$0tuscheme$1.right$1696(v$13753);
}),"empty application");
v$10068 = (function(xs$7574){var v$7575 = v$10070(xs$7574);
switch (v$7575[0]) { case 0: {var v$7576 = v$7575[1];
return [0,v$7576];
 break; }default: {return v$10071(xs$7574);
} };
});
var v$10069;
var v$10095 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7650){return [0,[[0,function(x$12543){return function(y$12544){var v$12545 = [x$12543,y$12544];
return [10,v$12545];
};
}],xs$7650]];
},function(tokens$12546){return (fix$14258.$fullSchemeExpOf(atomic$3681,keywordsOf$3684))(tokens$12546);
}),tuscheme$0tuscheme$1.many$1261(function(tokens$7655){return (fix$14258.$fullSchemeExpOf(atomic$3681,keywordsOf$3684))(tokens$7655);
}));
v$10069 = (tuscheme$0tuscheme$1.liberalBracket$1841("function application",tuscheme$0tuscheme$1.s$jml$1604(v$10095,"function application")));
return function(xs$7568){var v$7569 = v$10068(xs$7568);
switch (v$7569[0]) { case 0: {var v$7570 = v$7569[1];
return [0,v$7570];
 break; }default: {return v$10069(xs$7568);
} };
};
};
tuscheme$0tuscheme$1.fullSchemeExpOf$3678 = fix$14258.$fullSchemeExpOf;
tuscheme$0tuscheme$1.typedFormalOf$3691 = function(name$3694,colon$3697,ty$3700){var v$10099;
var t$14260 = tuscheme$0tuscheme$1.s$jtl$1007;
var t$14259;
var v$10101 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7676){return [0,[[0,function(x$12549){return function(y$12550){return x$12549;
};
}],xs$7676]];
},name$3694),colon$3697);
t$14259 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7663){return [0,[[0,function(x$12553){return function(y$12554){return [x$12553,y$12554];
};
}],xs$7663]];
},v$10101));
v$10099 = (t$14260(t$14259,ty$3700));
return tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",tuscheme$0tuscheme$1.s$jml$1604(v$10099,"[x : ty]"));
};
tuscheme$0tuscheme$1.typedFormalsOf$3701 = function(name$3704,colon$3707,ty$3710,context$3713){var formal$3714;
var v$12558;
var t$14262 = tuscheme$0tuscheme$1.s$jtl$1007;
var t$14261;
var v$12559 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12560){return [0,[[0,function(x$12561){return function(y$12562){return x$12561;
};
}],xs$12560]];
},name$3704),colon$3707);
t$14261 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12563){return [0,[[0,function(x$12564){return function(y$12565){return [x$12564,y$12565];
};
}],xs$12563]];
},v$12559));
v$12558 = (t$14262(t$14261,ty$3710));
formal$3714 = (tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",tuscheme$0tuscheme$1.s$jml$1604(v$12558,"[x : ty]")));
var t$14264 = tuscheme$0tuscheme$1.distinctBsIn$3621;
var t$14263;
var v$10107 = tuscheme$0tuscheme$1.many$1261(formal$3714);
t$14263 = (tuscheme$0tuscheme$1.liberalBracket$1841("(... [x : ty] ...)",tuscheme$0tuscheme$1.s$jml$1604(v$10107,"(... [x : ty] ...)")));
return t$14264(t$14263,context$3713);
};
tuscheme$0tuscheme$1.distinctTyvars$3715;
var v$10108 = tuscheme$0tuscheme$1.nodups$1640("quantified type variable","forall");
var v$10109;
var p$12566 = tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.tyvar$3599);
v$10109 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12567){return [0,[[0,function(x$12568){return function(y$12569){return [x$12568,y$12569];
};
}],xs$12567]];
},function(xs$12570){var tx$12571 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12572){return [0,[[0,function(v$12573){return v$12573[0];
}],xs$12572]];
},function(v$13754){return tuscheme$0tuscheme$1.inline$1491(v$13754);
});
var v$12574 = tx$12571(xs$12570);
switch (v$12574[0]) { case 0: {return [0,[v$12574[1][0],xs$12570]];
 break; }default: {return [1];
} };
}),p$12566));
tuscheme$0tuscheme$1.distinctTyvars$3715 = (tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7685){return [0,[[0,v$10108],xs$7685]];
},v$10109));
tuscheme$0tuscheme$1.arrowsOf$3716 = function(conapp$3719,funty$3722,v$3726,v$3729){if (v$3726 == null) {if (v$3729 == null) {return [1,"empty type ()"];
} else {var v$7688 = v$3729;
if (v$7688[1] == null) {var v$7690 = v$7688[0];
if (v$7690 == null) {return [1,"no result type after function arrow"];
} else {var v$7691 = v$7690;
if (v$7691[1] == null) {var v$7692 = v$7691[0];
return [0,funty$3722([v$3726,v$7692])];
} else {return [1,"multiple result types after function arrow"];
};
};
} else {return [1,"multiple arrows in function type"];
};
};
} else {if (v$3729 == null) {var v$3765 = v$3726;
var v$3766 = v$3765[0];
var v$3767 = v$3765[1];
return [0,conapp$3719([v$3766,v$3767])];
} else {var v$7695 = v$3729;
if (v$7695[1] == null) {var v$7697 = v$7695[0];
if (v$7697 == null) {return [1,"no result type after function arrow"];
} else {var v$7698 = v$7697;
if (v$7698[1] == null) {var v$7699 = v$7698[0];
return [0,funty$3722([v$3726,v$7699])];
} else {return [1,"multiple result types after function arrow"];
};
};
} else {return [1,"multiple arrows in function type"];
};
};
};
};
tuscheme$0tuscheme$1.keyword$3768 = function(words$3771,xs$7722){var v$7723 = tuscheme$0tuscheme$1.name$3595(xs$7722);
switch (v$7723[0]) { case 0: {var v$7724 = v$7723[1];
var v$7725 = v$7724[0];
switch (v$7725[0]) { case 0: {var v$7726 = v$7725[1];
var t$14267;
var fix$14265 = {};
fix$14265.$exists = function(v$12577){lab$exists: while (true) {if (v$12577 == null) {return false;
} else {var v$12578 = v$12577;
var v$12579 = v$12578[0];
var v$12580 = v$12578[1];
if (v$7726 == v$12579) {return true;
} else {var t$14266 = v$12580;
var v$12577 = t$14266;
continue lab$exists;
};
};
};
};
var exists$12576 = fix$14265.$exists;
t$14267 = (exists$12576(words$3771));
return t$14267?v$7723:[1];
 break; }default: {return v$7723;
} };
 break; }default: {return v$7723;
} };
};
tuscheme$0tuscheme$1.expKeyword$3779;
var words$13478 = ["if",["while",["set",["begin",["lambda",["type-lambda",["let",["let*",["@",null]]]]]]]]];
tuscheme$0tuscheme$1.expKeyword$3779 = (function(xs$13479){var v$13480 = tuscheme$0tuscheme$1.name$3595(xs$13479);
switch (v$13480[0]) { case 0: {var v$13481 = v$13480[1];
var v$13482 = v$13481[0];
switch (v$13482[0]) { case 0: {var v$13483 = v$13482[1];
var t$14270;
var fix$14268 = {};
fix$14268.$exists = function(v$13485){lab$exists: while (true) {if (v$13485 == null) {return false;
} else {var v$13486 = v$13485;
var v$13487 = v$13486[0];
var v$13488 = v$13486[1];
if (v$13483 == v$13487) {return true;
} else {var t$14269 = v$13488;
var v$13485 = t$14269;
continue lab$exists;
};
};
};
};
var exists$13484 = fix$14268.$exists;
t$14270 = (exists$13484(words$13478));
return t$14270?v$13480:[1];
 break; }default: {return v$13480;
} };
 break; }default: {return v$13480;
} };
});
tuscheme$0tuscheme$1.tyKeyword$3780;
var words$13489 = ["forall",["function",["->",null]]];
tuscheme$0tuscheme$1.tyKeyword$3780 = (function(xs$13490){var v$13491 = tuscheme$0tuscheme$1.name$3595(xs$13490);
switch (v$13491[0]) { case 0: {var v$13492 = v$13491[1];
var v$13493 = v$13492[0];
switch (v$13493[0]) { case 0: {var v$13494 = v$13493[1];
var t$14273;
var fix$14271 = {};
fix$14271.$exists = function(v$13496){lab$exists: while (true) {if (v$13496 == null) {return false;
} else {var v$13497 = v$13496;
var v$13498 = v$13497[0];
var v$13499 = v$13497[1];
if (v$13494 == v$13498) {return true;
} else {var t$14272 = v$13499;
var v$13496 = t$14272;
continue lab$exists;
};
};
};
};
var exists$13495 = fix$14271.$exists;
t$14273 = (exists$13495(words$13489));
return t$14273?v$13491:[1];
 break; }default: {return v$13491;
} };
 break; }default: {return v$13491;
} };
});
tuscheme$0tuscheme$1.tlformals$3781;
var v$10116 = tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda");
var v$10117;
var p$12581 = tuscheme$0tuscheme$1.many$1261(function(v$13755){return tuscheme$0tuscheme$1.name$3595(v$13755);
});
v$10117 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12582){return [0,[[0,function(x$12583){return function(y$12584){return [x$12583,y$12584];
};
}],xs$12582]];
},function(xs$12585){var tx$12586 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12587){return [0,[[0,function(v$12588){return v$12588[0];
}],xs$12587]];
},function(v$13756){return tuscheme$0tuscheme$1.inline$1491(v$13756);
});
var v$12589 = tx$12586(xs$12585);
switch (v$12589[0]) { case 0: {return [0,[v$12589[1][0],xs$12585]];
 break; }default: {return [1];
} };
}),p$12581));
tuscheme$0tuscheme$1.tlformals$3781 = (tuscheme$0tuscheme$1.s$jtla$1279(function(xs$7742){return [0,[[0,v$10116],xs$7742]];
},v$10117));
tuscheme$0tuscheme$1.nodupsty$3782 = function(what$3785,v$3789){var v$3792 = v$3789[0];
var v$3793 = v$3789[1];
var v$10118 = (tuscheme$0tuscheme$1.nodups$1640(what$3785[0],what$3785[1]))([v$3792,basis$0List$1.map$697(function(v$7756){return v$7756[0];
},v$3793)]);
switch (v$10118[0]) { case 0: {return [0,v$3793];
 break; }default: {var v$7755 = v$10118[1];
return [1,v$7755];
} };
};
tuscheme$0tuscheme$1.letDups$3794 = function(v$3797,v$3800){switch (v$3797[0]) { case 0: {var v$3809 = v$3800[1];
return [0,v$3809];
 break; }default: {var v$12601 = v$3800[0];
var v$12602 = v$3800[1];
var v$12603 = (tuscheme$0tuscheme$1.nodups$1640("bound variable","let"))([v$12601,basis$0List$1.map$697(function(v$12604){return v$12604[0];
},v$12602)]);
switch (v$12603[0]) { case 0: {return [0,v$12602];
 break; }default: {var v$12605 = v$12603[1];
return [1,v$12605];
} };
} };
};
tuscheme$0tuscheme$1.arrows$3811 = function(v$13629){return function(v$13630){return tuscheme$0tuscheme$1.arrowsOf$3716(function(v$13673){return [4,v$13673];
},function(v$13690){return [2,v$13690];
},v$13629,v$13630);
};
};
var fix$14274 = {};
fix$14274.$ty = function(tokens$3817){lab$ty: while (true) {var v$10126;
var v$10128;
var v$10130;
var v$10132;
var v$10134;
var v$10136 = tuscheme$0tuscheme$1.s$jtl$1007((function(env$14277){return function(xs$7801){return [0,[[0,(function(env$14278){return function(v$12607){return [1,v$12607];
};
})([])],xs$7801]];
};
})([]),(function(env$14276){return function(v$13757){var v$14275 = env$14276[0];
return v$14275(v$13757);
};
})([tuscheme$0tuscheme$1.name$3595]));
var v$10137 = tuscheme$0tuscheme$1.s$jtl$1007((function(env$14279){return function(xs$7806){return [0,[[0,(function(env$14280){return function(v$12609){return [0,v$12609];
};
})([])],xs$7806]];
};
})([]),tuscheme$0tuscheme$1.tyvar$3599);
v$10134 = ((function(env$14283){return function(xs$7794){var v$14281 = env$14283[0];
var v$14282 = env$14283[1];
var v$7795 = v$14282(xs$7794);
switch (v$7795[0]) { case 0: {var v$7796 = v$7795[1];
return [0,v$7796];
 break; }default: {return v$14281(xs$7794);
} };
};
})([v$10137,v$10136]));
var v$10135;
var v$13411;
var t$14291 = tuscheme$0tuscheme$1.s$jtl$1007;
var t$14286;
var v$10143 = tuscheme$0tuscheme$1.liberalBracket$1841("('a ...)",tuscheme$0tuscheme$1.s$jml$1604(tuscheme$0tuscheme$1.distinctTyvars$3715,"('a ...)"));
t$14286 = (tuscheme$0tuscheme$1.s$jtl$1007((function(env$14287){return function(xs$7811){return [0,[[0,(function(env$14288){return function(x$12622){return (function(env$14290){return function(y$12623){var v$14289 = env$14290[0];
var v$12624 = [v$14289,y$12623];
return [3,v$12624];
};
})([x$12622]);
};
})([])],xs$7811]];
};
})([]),v$10143));
v$13411 = (t$14291(t$14286,(function(env$14285){return function(v$13758){var v$14284 = env$14285[0];
return v$14284(v$13758);
};
})([fix$14274.$ty])));
var t$14299 = tuscheme$0tuscheme$1.liberalBracket$1841;
var t$14298 = "(forall (tyvars) type)";
var t$14292;
var v$12614 = tuscheme$0tuscheme$1.s$jml$1604(v$13411,"(forall (tyvars) type)");
t$14292 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14295){return function(xs$12615){return [0,[[0,(function(env$14296){return function(x$12616){return (function(env$14297){return function(y$12617){return y$12617;
};
})([]);
};
})([])],xs$12615]];
};
})([]),(function(env$14294){return function(v$13674){var v$14293 = env$14294[0];
return v$14293("forall",v$13674);
};
})([tuscheme$0tuscheme$1.kw$3641])),v$12614));
v$10135 = (t$14299(t$14298,t$14292));
v$10132 = ((function(env$14302){return function(xs$7788){var v$14300 = env$14302[0];
var v$14301 = env$14302[1];
var v$7789 = v$14301(xs$7788);
switch (v$7789[0]) { case 0: {var v$7790 = v$7789[1];
return [0,v$7790];
 break; }default: {return v$14300(xs$7788);
} };
};
})([v$10135,v$10134]));
var v$10133;
var v$10147;
var v$10152;
var v$10155 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14310){return function(xs$12626){return [0,[[0,(function(env$14311){return function(x$12627){return (function(env$14313){return function(y$12628){var v$14312 = env$14313[0];
return [v$14312,y$12628];
};
})([x$12627]);
};
})([])],xs$12626]];
};
})([]),(function(env$14305){return function(xs$12629){var v$14303 = env$14305[0];
var v$14304 = env$14305[1];
var tx$12630 = v$14304((function(env$14308){return function(xs$12631){return [0,[[0,(function(env$14309){return function(v$12632){return v$12632[0];
};
})([])],xs$12631]];
};
})([]),(function(env$14307){return function(v$13759){var v$14306 = env$14307[0];
return v$14306(v$13759);
};
})([v$14303]));
var v$12633 = tx$12630(xs$12629);
switch (v$12633[0]) { case 0: {return [0,[v$12633[1][0],xs$12629]];
 break; }default: {return [1];
} };
};
})([tuscheme$0tuscheme$1.inline$1491,tuscheme$0tuscheme$1.s$jtl$1007])),tuscheme$0tuscheme$1.expKeyword$3779);
v$10152 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14316){return function(xs$7852){return [0,[[0,(function(env$14317){return function(x$12636){return (function(env$14318){return function(y$12637){return y$12637;
};
})([]);
};
})([])],xs$7852]];
};
})([]),(function(env$14315){return function(v$13760){var v$14314 = env$14315[0];
return v$14314(v$13760);
};
})([tuscheme$0tuscheme$1.left$1682])),v$10155));
v$10147 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14327){return function(xs$7840){return [0,[[0,(function(env$14328){return function(x$12648){return (function(env$14330){return function(y$12649){var v$14329 = env$14330[0];
return v$14329;
};
})([x$12648]);
};
})([])],xs$7840]];
};
})([]),v$10152),(function(env$14322){return function(tokens$12650){var v$14319 = env$14322[0];
var v$14320 = env$14322[1];
var v$14321 = env$14322[2];
var v$12651 = v$14321((function(env$14325){return function(xs$12652){return [0,[[0,(function(env$14326){return function(v$12653){return [2,v$12653];
};
})([])],xs$12652]];
};
})([]),(function(env$14324){return function(v$13761){var v$14323 = env$14324[0];
return v$14323(v$13761);
};
})([v$14320]));
var v$12654 = v$12651(tokens$12650);
switch (v$12654[0]) { case 0: {var v$12655 = v$12654[1];
return [0,v$12655];
 break; }default: {return v$14319(tokens$12650);
} };
};
})([tuscheme$0tuscheme$1.scanToClose$1731,tuscheme$0tuscheme$1.right$1696,tuscheme$0tuscheme$1.s$jtl$1007])));
v$10133 = (tuscheme$0tuscheme$1.s$jtla$1279((function(env$14332){return function(xs$7822){var v$14331 = env$14332[0];
return [0,[[0,(function(env$14334){return function(v$12660){var v$14333 = env$14334[0];
var v$12661 = v$12660[0];
var v$12662 = v$12660[1];
var msg$12663 = ("looking for type but found `" + v$12662) + "'";
return [1,(v$14333(v$12661[0],v$12661[1]))([msg$12663,null])];
};
})([v$14331])],xs$7822]];
};
})([tuscheme$0tuscheme$1.synerrormsg$1331]),v$10147));
v$10130 = ((function(env$14337){return function(xs$7782){var v$14335 = env$14337[0];
var v$14336 = env$14337[1];
var v$7783 = v$14336(xs$7782);
switch (v$7783[0]) { case 0: {var v$7784 = v$7783[1];
return [0,v$7784];
 break; }default: {return v$14335(xs$7782);
} };
};
})([v$10133,v$10132]));
var v$10131;
var v$10165;
var t$14360 = tuscheme$0tuscheme$1.s$jtla$1279;
var t$14350;
var v$10167 = tuscheme$0tuscheme$1.many$1261((function(env$14349){return function(v$13762){var v$14348 = env$14349[0];
return v$14348(v$13762);
};
})([fix$14274.$ty]));
t$14350 = (tuscheme$0tuscheme$1.s$jtl$1007((function(env$14352){return function(xs$7873){var v$14351 = env$14352[0];
return [0,[[0,(function(env$14354){return function(v$13691){var v$14353 = env$14354[0];
return (function(env$14357){return function(v$13692){var v$14355 = env$14357[0];
var v$14356 = env$14357[1];
return v$14356((function(env$14359){return function(v$13693){return [4,v$13693];
};
})([]),(function(env$14358){return function(v$13694){return [2,v$13694];
};
})([]),v$14355,v$13692);
};
})([v$13691,v$14353]);
};
})([v$14351])],xs$7873]];
};
})([tuscheme$0tuscheme$1.arrowsOf$3716]),v$10167));
var t$14347;
var t$14346 = tuscheme$0tuscheme$1.many$1261;
var t$14340;
var v$10169 = tuscheme$0tuscheme$1.many$1261((function(env$14339){return function(v$13763){var v$14338 = env$14339[0];
return v$14338(v$13763);
};
})([fix$14274.$ty]));
t$14340 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007((function(env$14343){return function(xs$7884){return [0,[[0,(function(env$14344){return function(x$12695){return (function(env$14345){return function(y$12696){return y$12696;
};
})([]);
};
})([])],xs$7884]];
};
})([]),(function(env$14342){return function(xs$12697){var v$14341 = env$14342[0];
var v$12698 = v$14341(xs$12697);
switch (v$12698[0]) { case 1: {return [1];
 break; }default: {var v$12699 = v$12698[1];
var v$12700 = v$12699[0];
switch (v$12700[0]) { case 1: {return [0,[[1,v$12700[1]],v$12699[1]]];
 break; }default: {var v$12701 = v$12700[1];
var v$12702 = v$12699[1];
var v$12703;
switch (v$12701[0]) { case 2: {switch (v$12701[1]) { case "->": {v$12703 = [0,0];
 break; }default: {v$12703 = [1];
} };
 break; }default: {v$12703 = [1];
} };
switch (v$12703[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12703[1]],v$12702]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548])),v$10169));
t$14347 = (t$14346(t$14340));
v$10165 = (t$14360(t$14350,t$14347));
v$10131 = (tuscheme$0tuscheme$1.liberalBracket$1841("type application or function type",tuscheme$0tuscheme$1.s$jml$1604(v$10165,"type application or function type")));
v$10128 = ((function(env$14363){return function(xs$7776){var v$14361 = env$14363[0];
var v$14362 = env$14363[1];
var v$7777 = v$14362(xs$7776);
switch (v$7777[0]) { case 0: {var v$7778 = v$7777[1];
return [0,v$7778];
 break; }default: {return v$14361(xs$7776);
} };
};
})([v$10131,v$10130]));
var v$10129 = tuscheme$0tuscheme$1.s$jal$1611((function(env$14365){return function(xs$12704){var v$14364 = env$14365[0];
var v$12705 = v$14364(xs$12704);
switch (v$12705[0]) { case 1: {return [1];
 break; }default: {var v$12706 = v$12705[1];
var v$12707 = v$12706[0];
switch (v$12707[0]) { case 1: {return [0,[[1,v$12707[1]],v$12706[1]]];
 break; }default: {var v$12708 = v$12707[1];
var v$12709 = v$12706[1];
var v$12710;
switch (v$12708[0]) { case 3: {var v$12712 = v$12708[1];
v$12710 = [0,v$12712];
 break; }default: {v$12710 = [1];
} };
switch (v$12710[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12710[1]],v$12709]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548]),"expected type; found integer");
v$10126 = ((function(env$14368){return function(xs$7770){var v$14366 = env$14368[0];
var v$14367 = env$14368[1];
var v$7771 = v$14367(xs$7770);
switch (v$7771[0]) { case 0: {var v$7772 = v$7771[1];
return [0,v$7772];
 break; }default: {return v$14366(xs$7770);
} };
};
})([v$10129,v$10128]));
var v$10127 = tuscheme$0tuscheme$1.s$jal$1611((function(env$14370){return function(xs$12713){var v$14369 = env$14370[0];
var v$12714 = v$14369(xs$12713);
switch (v$12714[0]) { case 1: {return [1];
 break; }default: {var v$12715 = v$12714[1];
var v$12716 = v$12715[0];
switch (v$12716[0]) { case 1: {return [0,[[1,v$12716[1]],v$12715[1]]];
 break; }default: {var v$12717 = v$12716[1];
var v$12718 = v$12715[1];
var v$12719;
switch (v$12717[0]) { case 0: {var v$12721 = v$12717[1];
v$12719 = [0,v$12721];
 break; }default: {v$12719 = [1];
} };
switch (v$12719[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12719[1]],v$12718]];
} };
} };
} };
};
})([tuscheme$0tuscheme$1.pretoken$3548]),"expected type; found Boolean literal");
var v$7765 = v$10126(tokens$3817);
switch (v$7765[0]) { case 0: {var v$7766 = v$7765[1];
return [0,v$7766];
 break; }default: {return v$10127(tokens$3817);
} };
};
};
tuscheme$0tuscheme$1.ty$3814 = fix$14274.$ty;
tuscheme$0tuscheme$1.flipPair$3828 = function(tau$3831,x$3834){return [x$3834,tau$3831];
};
tuscheme$0tuscheme$1.formal$3835;
var v$10173;
var t$14372 = tuscheme$0tuscheme$1.s$jtl$1007;
var t$14371;
var v$10175 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7906){return [0,[[0,function(x$12724){return function(y$12725){return x$12724;
};
}],xs$7906]];
},function(v$13764){return tuscheme$0tuscheme$1.name$3595(v$13764);
}),function(v$13675){return tuscheme$0tuscheme$1.kw$3641(":",v$13675);
});
t$14371 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$7893){return [0,[[0,function(x$12728){return function(y$12729){return [x$12728,y$12729];
};
}],xs$7893]];
},v$10175));
v$10173 = (t$14372(t$14371,function(v$13765){return tuscheme$0tuscheme$1.ty$3814(v$13765);
}));
tuscheme$0tuscheme$1.formal$3835 = (tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",tuscheme$0tuscheme$1.s$jml$1604(v$10173,"[x : ty]")));
tuscheme$0tuscheme$1.lformals$3836;
var v$10181 = tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.formal$3835);
tuscheme$0tuscheme$1.lformals$3836 = (tuscheme$0tuscheme$1.liberalBracket$1841("([x : ty] ...)",tuscheme$0tuscheme$1.s$jml$1604(v$10181,"([x : ty] ...)")));
tuscheme$0tuscheme$1.tformals$3837;
var v$10183 = tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.tyvar$3599);
tuscheme$0tuscheme$1.tformals$3837 = (tuscheme$0tuscheme$1.liberalBracket$1841("('a ...)",tuscheme$0tuscheme$1.s$jml$1604(v$10183,"('a ...)")));
tuscheme$0tuscheme$1.lambda$3838 = function(v$13587,v$13588){return function(exp$3844){var v$10184;
var v$12734 = (tuscheme$0tuscheme$1.nodups$1640("formal parameter","lambda"))([v$13587,basis$0List$1.map$697(function(v$12735){return v$12735[0];
},v$13588)]);
switch (v$12734[0]) { case 0: {v$10184 = [0,v$13588];
 break; }default: {var v$12736 = v$12734[1];
v$10184 = [1,v$12736];
} };
switch (v$10184[0]) { case 0: {var v$7924 = v$10184[1];
var v$12746 = [7,[v$7924,exp$3844]];
return [0,v$12746];
 break; }default: {var v$7926 = v$10184[1];
return [1,v$7926];
} };
};
};
tuscheme$0tuscheme$1.tylambda$3848 = function(a$s$3851,exp$3854){var v$10190 = (tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda"))(a$s$3851);
switch (v$10190[0]) { case 0: {var v$7937 = v$10190[1];
var v$12756 = [2,[v$7937,exp$3854]];
return [0,v$12756];
 break; }default: {var v$7939 = v$10190[1];
return [1,v$7939];
} };
};
tuscheme$0tuscheme$1.cb$3858 = function(key$3861,usage$3864,parser$3867){var t$14375 = tuscheme$0tuscheme$1.liberalBracket$1841;
var t$14374 = usage$3864;
var t$14373;
var v$12761 = tuscheme$0tuscheme$1.s$jml$1604(parser$3867,usage$3864);
t$14373 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12762){return [0,[[0,function(x$12763){return function(y$12764){return y$12764;
};
}],xs$12762]];
},function(xs$13505){var v$13506 = tuscheme$0tuscheme$1.name$3595(xs$13505);
switch (v$13506[0]) { case 0: {var v$13507 = v$13506[1];
var v$13508 = v$13507[0];
switch (v$13508[0]) { case 0: {var v$13509 = v$13508[1];
return (key$3861 == v$13509)?v$13506:[1];
 break; }default: {return v$13506;
} };
 break; }default: {return v$13506;
} };
}),v$12761));
return t$14375(t$14374,t$14373);
};
tuscheme$0tuscheme$1.badTyKeyword$3868 = function(v$3911,v$3912){var msg$7958 = ("looking for expression but found `" + v$3912) + "'";
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$3911[0],v$3911[1]))([msg$7958,null])];
};
tuscheme$0tuscheme$1.letrec$3870 = function(v$3901,v$3903){return [1,"letrec is not included in Typed uScheme"];
};
tuscheme$0tuscheme$1.letx$3871 = function(kind$3890,bs$3893,exp$3896){var v$10202;
switch (kind$3890[0]) { case 0: {var v$7979 = bs$3893[1];
v$10202 = [0,v$7979];
 break; }default: {var v$12768 = bs$3893[0];
var v$12769 = bs$3893[1];
var v$12770 = (tuscheme$0tuscheme$1.nodups$1640("bound variable","let"))([v$12768,basis$0List$1.map$697(function(v$12771){return v$12771[0];
},v$12769)]);
switch (v$12770[0]) { case 0: {v$10202 = [0,v$12769];
 break; }default: {var v$12772 = v$12770[1];
v$10202 = [1,v$12772];
} };
} };
switch (v$10202[0]) { case 0: {var v$7972 = v$10202[1];
var v$12782 = [6,[kind$3890,v$7972,exp$3896]];
return [0,v$12782];
 break; }default: {var v$7974 = v$10202[1];
return [1,v$7974];
} };
};
var fix$14376 = {};
fix$14376.$exp = function(tokens$3875){var v$10210;
var v$10212;
var v$10214;
var v$10216;
var v$10218;
var v$10220;
var v$10222;
var v$10224;
var v$10226;
var v$10228;
var v$10230;
var v$10232;
var v$10234;
var v$10236;
var v$10238;
var v$10240;
var v$10242;
var v$10244 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8093){return [0,[[0,function(v$12784){return [1,v$12784];
}],xs$8093]];
},function(v$13768){return tuscheme$0tuscheme$1.name$3595(v$13768);
});
var v$10245;
var v$10249 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8103){return [0,[[0,function(v$12803){return [3,v$12803];
}],xs$8103]];
},function(xs$12804){var v$12805 = tuscheme$0tuscheme$1.pretoken$3548(xs$12804);
switch (v$12805[0]) { case 1: {return [1];
 break; }default: {var v$12806 = v$12805[1];
var v$12807 = v$12806[0];
switch (v$12807[0]) { case 1: {return [0,[[1,v$12807[1]],v$12806[1]]];
 break; }default: {var v$12808 = v$12807[1];
var v$12809 = v$12806[1];
var v$12810;
switch (v$12808[0]) { case 3: {var v$12811 = v$12808[1];
v$12810 = [0,v$12811];
 break; }default: {v$12810 = [1];
} };
switch (v$12810[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12810[1]],v$12809]];
} };
} };
} };
});
v$10245 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8098){return [0,[[0,function(v$12813){return [5,v$12813];
}],xs$8098]];
},v$10249));
v$10242 = (function(xs$8086){var v$8087 = v$10244(xs$8086);
switch (v$8087[0]) { case 0: {var v$8088 = v$8087[1];
return [0,v$8088];
 break; }default: {return v$10245(xs$8086);
} };
});
var v$10243;
var v$10253 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8113){return [0,[[0,function(v$12832){return [6,v$12832];
}],xs$8113]];
},function(xs$12833){var v$12834 = tuscheme$0tuscheme$1.pretoken$3548(xs$12833);
switch (v$12834[0]) { case 1: {return [1];
 break; }default: {var v$12835 = v$12834[1];
var v$12836 = v$12835[0];
switch (v$12836[0]) { case 1: {return [0,[[1,v$12836[1]],v$12835[1]]];
 break; }default: {var v$12837 = v$12836[1];
var v$12838 = v$12835[1];
var v$12839;
switch (v$12837[0]) { case 0: {var v$12840 = v$12837[1];
v$12839 = [0,v$12840];
 break; }default: {v$12839 = [1];
} };
switch (v$12839[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12839[1]],v$12838]];
} };
} };
} };
});
v$10243 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8108){return [0,[[0,function(v$12842){return [5,v$12842];
}],xs$8108]];
},v$10253));
v$10240 = (function(xs$8080){var v$8081 = v$10242(xs$8080);
switch (v$8081[0]) { case 0: {var v$8082 = v$8081[1];
return [0,v$8082];
 break; }default: {return v$10243(xs$8080);
} };
});
var v$10241;
var v$10257 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8130){return [0,[[0,function(v$12851){return [5,v$12851];
}],xs$8130]];
},function(v$13769){return tuscheme$0tuscheme$1.sexp$3650(v$13769);
});
v$10241 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8124){return [0,[[0,function(x$12875){return function(y$12876){return y$12876;
};
}],xs$8124]];
},function(xs$12877){var v$12878 = tuscheme$0tuscheme$1.pretoken$3548(xs$12877);
switch (v$12878[0]) { case 1: {return [1];
 break; }default: {var v$12879 = v$12878[1];
var v$12880 = v$12879[0];
switch (v$12880[0]) { case 1: {return [0,[[1,v$12880[1]],v$12879[1]]];
 break; }default: {var v$12881 = v$12880[1];
var v$12882 = v$12879[1];
var v$12883;
switch (v$12881[0]) { case 1: {v$12883 = [0,0];
 break; }default: {v$12883 = [1];
} };
switch (v$12883[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12883[1]],v$12882]];
} };
} };
} };
}),v$10257));
v$10238 = (function(xs$8074){var v$8075 = v$10240(xs$8074);
switch (v$8075[0]) { case 0: {var v$8076 = v$8075[1];
return [0,v$8076];
 break; }default: {return v$10241(xs$8074);
} };
});
var v$10239;
var v$10263 = tuscheme$0tuscheme$1.s$jtla$1279(function(xs$12892){return [0,[[0,function(v$12893){var v$12894 = v$12893[0];
var v$12895 = v$12893[1];
var msg$12896;
var t$14574 = "quote mark ' followed by right bracket ";
var t$14573;
switch (v$12895) { case 1: {t$14573 = ")";
 break; }case 0: {t$14573 = "]";
 break; }default: {t$14573 = "}";
} };
msg$12896 = (t$14574 + t$14573);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$12894[0],v$12894[1]))([msg$12896,null])];
}],xs$12892]];
},function(v$13770){return tuscheme$0tuscheme$1.right$1696(v$13770);
});
v$10239 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8141){return [0,[[0,function(x$12920){return function(y$12921){return y$12921;
};
}],xs$8141]];
},function(xs$12922){var v$12923 = tuscheme$0tuscheme$1.pretoken$3548(xs$12922);
switch (v$12923[0]) { case 1: {return [1];
 break; }default: {var v$12924 = v$12923[1];
var v$12925 = v$12924[0];
switch (v$12925[0]) { case 1: {return [0,[[1,v$12925[1]],v$12924[1]]];
 break; }default: {var v$12926 = v$12925[1];
var v$12927 = v$12924[1];
var v$12928;
switch (v$12926[0]) { case 1: {v$12928 = [0,0];
 break; }default: {v$12928 = [1];
} };
switch (v$12928[0]) { case 1: {return [1];
 break; }default: {return [0,[[0,v$12928[1]],v$12927]];
} };
} };
} };
}),v$10263));
v$10236 = (function(xs$8068){var v$8069 = v$10238(xs$8068);
switch (v$8069[0]) { case 0: {var v$8070 = v$8069[1];
return [0,v$8070];
 break; }default: {return v$10239(xs$8068);
} };
});
var v$10237 = tuscheme$0tuscheme$1.cb$3858("if","(if e1 e2 e3)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8147){return [0,[[0,function(x$12934){return function(y$12935){return function(z$12936){var v$12937 = [x$12934,y$12935,z$12936];
return [8,v$12937];
};
};
}],xs$8147]];
},function(v$13771){return fix$14376.$exp(v$13771);
}),function(v$13772){return fix$14376.$exp(v$13772);
}),function(v$13773){return fix$14376.$exp(v$13773);
}));
v$10234 = (function(xs$8062){var v$8063 = v$10236(xs$8062);
switch (v$8063[0]) { case 0: {var v$8064 = v$8063[1];
return [0,v$8064];
 break; }default: {return v$10237(xs$8062);
} };
});
var v$10235 = tuscheme$0tuscheme$1.cb$3858("while","(while e1 e2)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8156){return [0,[[0,function(x$12942){return function(y$12943){var v$12944 = [x$12942,y$12943];
return [0,v$12944];
};
}],xs$8156]];
},function(v$13774){return fix$14376.$exp(v$13774);
}),function(v$13775){return fix$14376.$exp(v$13775);
}));
v$10232 = (function(xs$8056){var v$8057 = v$10234(xs$8056);
switch (v$8057[0]) { case 0: {var v$8058 = v$8057[1];
return [0,v$8058];
 break; }default: {return v$10235(xs$8056);
} };
});
var v$10233 = tuscheme$0tuscheme$1.cb$3858("set","(set x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8164){return [0,[[0,function(x$12949){return function(y$12950){var v$12951 = [x$12949,y$12950];
return [4,v$12951];
};
}],xs$8164]];
},function(v$13776){return tuscheme$0tuscheme$1.name$3595(v$13776);
}),function(v$13777){return fix$14376.$exp(v$13777);
}));
v$10230 = (function(xs$8050){var v$8051 = v$10232(xs$8050);
switch (v$8051[0]) { case 0: {var v$8052 = v$8051[1];
return [0,v$8052];
 break; }default: {return v$10233(xs$8050);
} };
});
var v$10231;
var t$14578 = tuscheme$0tuscheme$1.cb$3858;
var t$14577 = "begin";
var t$14576 = "";
var t$14575;
var v$10273 = tuscheme$0tuscheme$1.many$1261(function(v$13778){return fix$14376.$exp(v$13778);
});
t$14575 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8172){return [0,[[0,function(v$12953){return [9,v$12953];
}],xs$8172]];
},v$10273));
v$10231 = (t$14578(t$14577,t$14576,t$14575));
v$10228 = (function(xs$8044){var v$8045 = v$10230(xs$8044);
switch (v$8045[0]) { case 0: {var v$8046 = v$8045[1];
return [0,v$8046];
 break; }default: {return v$10231(xs$8044);
} };
});
var v$10229;
var t$14584 = tuscheme$0tuscheme$1.cb$3858;
var t$14583 = "lambda";
var t$14582 = "(lambda (formals) body)";
var t$14581;
var t$14580 = tuscheme$0tuscheme$1.s$jtla$1279;
var t$14579;
var v$10275 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12955){return [0,[[0,function(x$12956){return function(y$12957){return [x$12956,y$12957];
};
}],xs$12955]];
},function(xs$12958){var tx$12959 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12960){return [0,[[0,function(v$12961){return v$12961[0];
}],xs$12960]];
},function(v$13779){return tuscheme$0tuscheme$1.inline$1491(v$13779);
});
var v$12962 = tx$12959(xs$12958);
switch (v$12962[0]) { case 0: {return [0,[v$12962[1][0],xs$12958]];
 break; }default: {return [1];
} };
}),tuscheme$0tuscheme$1.lformals$3836);
t$14579 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8177){return [0,[[0,function(v$13589){return tuscheme$0tuscheme$1.lambda$3838(v$13589[0],v$13589[1]);
}],xs$8177]];
},v$10275));
t$14581 = (t$14580(t$14579,function(v$13780){return fix$14376.$exp(v$13780);
}));
v$10229 = (t$14584(t$14583,t$14582,t$14581));
v$10226 = (function(xs$8038){var v$8039 = v$10228(xs$8038);
switch (v$8039[0]) { case 0: {var v$8040 = v$8039[1];
return [0,v$8040];
 break; }default: {return v$10229(xs$8038);
} };
});
var v$10227;
var t$14590 = tuscheme$0tuscheme$1.cb$3858;
var t$14589 = "type-lambda";
var t$14588 = "(type-lambda (tyvars) body)";
var t$14587;
var t$14586 = tuscheme$0tuscheme$1.s$jtla$1279;
var t$14585;
var v$10277 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12971){return [0,[[0,function(x$12972){return function(y$12973){return [x$12972,y$12973];
};
}],xs$12971]];
},function(xs$12974){var tx$12975 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12976){return [0,[[0,function(v$12977){return v$12977[0];
}],xs$12976]];
},function(v$13781){return tuscheme$0tuscheme$1.inline$1491(v$13781);
});
var v$12978 = tx$12975(xs$12974);
switch (v$12978[0]) { case 0: {return [0,[v$12978[1][0],xs$12974]];
 break; }default: {return [1];
} };
}),tuscheme$0tuscheme$1.tformals$3837);
t$14585 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8182){return [0,[[0,function(a$s$12985){return function(exp$12986){var v$12987 = (tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda"))(a$s$12985);
switch (v$12987[0]) { case 0: {var v$12988 = v$12987[1];
var v$12989 = [2,[v$12988,exp$12986]];
return [0,v$12989];
 break; }default: {var v$12990 = v$12987[1];
return [1,v$12990];
} };
};
}],xs$8182]];
},v$10277));
t$14587 = (t$14586(t$14585,function(v$13782){return fix$14376.$exp(v$13782);
}));
v$10227 = (t$14590(t$14589,t$14588,t$14587));
v$10224 = (function(xs$8032){var v$8033 = v$10226(xs$8032);
switch (v$8033[0]) { case 0: {var v$8034 = v$8033[1];
return [0,v$8034];
 break; }default: {return v$10227(xs$8032);
} };
});
var v$10225;
var t$14596 = tuscheme$0tuscheme$1.cb$3858;
var t$14595 = "let";
var t$14594 = "(let (bindings) body)";
var t$14593;
var t$14592 = tuscheme$0tuscheme$1.s$jtla$1279;
var t$14591;
var v$10278;
var v$13635 = [1];
v$10278 = (function(v$13636){return function(v$13637){return tuscheme$0tuscheme$1.letx$3871(v$13635,v$13636,v$13637);
};
});
var v$10279 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12992){return [0,[[0,function(x$12993){return function(y$12994){return [x$12993,y$12994];
};
}],xs$12992]];
},function(xs$12995){var tx$12996 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$12997){return [0,[[0,function(v$12998){return v$12998[0];
}],xs$12997]];
},function(v$13783){return tuscheme$0tuscheme$1.inline$1491(v$13783);
});
var v$12999 = tx$12996(xs$12995);
switch (v$12999[0]) { case 0: {return [0,[v$12999[1][0],xs$12995]];
 break; }default: {return [1];
} };
}),function(v$13784){return fix$14376.$bindings(v$13784);
});
t$14591 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8187){return [0,[[0,v$10278],xs$8187]];
},v$10279));
t$14593 = (t$14592(t$14591,function(v$13785){return fix$14376.$exp(v$13785);
}));
v$10225 = (t$14596(t$14595,t$14594,t$14593));
v$10222 = (function(xs$8026){var v$8027 = v$10224(xs$8026);
switch (v$8027[0]) { case 0: {var v$8028 = v$8027[1];
return [0,v$8028];
 break; }default: {return v$10225(xs$8026);
} };
});
var v$10223 = tuscheme$0tuscheme$1.cb$3858("letrec","(letrec (bindings) body)",tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8192){return [0,[[0,function(v$13002){return function(v$13003){return [1,"letrec is not included in Typed uScheme"];
};
}],xs$8192]];
},function(v$13786){return fix$14376.$bindings(v$13786);
}),function(v$13787){return fix$14376.$exp(v$13787);
}));
v$10220 = (function(xs$8020){var v$8021 = v$10222(xs$8020);
switch (v$8021[0]) { case 0: {var v$8022 = v$8021[1];
return [0,v$8022];
 break; }default: {return v$10223(xs$8020);
} };
});
var v$10221;
var t$14602 = tuscheme$0tuscheme$1.cb$3858;
var t$14601 = "let*";
var t$14600 = "(let* (bindings) body)";
var t$14599;
var t$14598 = tuscheme$0tuscheme$1.s$jtla$1279;
var t$14597;
var v$10282;
var v$13638 = [0];
v$10282 = (function(v$13639){return function(v$13640){return tuscheme$0tuscheme$1.letx$3871(v$13638,v$13639,v$13640);
};
});
var v$10283 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13005){return [0,[[0,function(x$13006){return function(y$13007){return [x$13006,y$13007];
};
}],xs$13005]];
},function(xs$13008){var tx$13009 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13010){return [0,[[0,function(v$13011){return v$13011[0];
}],xs$13010]];
},function(v$13788){return tuscheme$0tuscheme$1.inline$1491(v$13788);
});
var v$13012 = tx$13009(xs$13008);
switch (v$13012[0]) { case 0: {return [0,[v$13012[1][0],xs$13008]];
 break; }default: {return [1];
} };
}),function(v$13789){return fix$14376.$bindings(v$13789);
});
t$14597 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8199){return [0,[[0,v$10282],xs$8199]];
},v$10283));
t$14599 = (t$14598(t$14597,function(v$13790){return fix$14376.$exp(v$13790);
}));
v$10221 = (t$14602(t$14601,t$14600,t$14599));
v$10218 = (function(xs$8014){var v$8015 = v$10220(xs$8014);
switch (v$8015[0]) { case 0: {var v$8016 = v$8015[1];
return [0,v$8016];
 break; }default: {return v$10221(xs$8014);
} };
});
var v$10219 = tuscheme$0tuscheme$1.cb$3858("@","(@ exp types)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8204){return [0,[[0,function(x$13017){return function(y$13018){var v$13019 = [x$13017,y$13018];
return [3,v$13019];
};
}],xs$8204]];
},function(v$13791){return fix$14376.$exp(v$13791);
}),tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8216){return [0,[[0,function(x$13022){return function(y$13023){return [x$13022,y$13023];
};
}],xs$8216]];
},function(v$13792){return tuscheme$0tuscheme$1.ty$3814(v$13792);
}),tuscheme$0tuscheme$1.many$1261(function(v$13793){return tuscheme$0tuscheme$1.ty$3814(v$13793);
}))));
v$10216 = (function(xs$8008){var v$8009 = v$10218(xs$8008);
switch (v$8009[0]) { case 0: {var v$8010 = v$8009[1];
return [0,v$8010];
 break; }default: {return v$10219(xs$8008);
} };
});
var v$10217;
var v$10289;
var v$10294;
var v$10297 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13025){return [0,[[0,function(x$13026){return function(y$13027){return [x$13026,y$13027];
};
}],xs$13025]];
},function(xs$13028){var tx$13029 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13030){return [0,[[0,function(v$13031){return v$13031[0];
}],xs$13030]];
},function(v$13794){return tuscheme$0tuscheme$1.inline$1491(v$13794);
});
var v$13032 = tx$13029(xs$13028);
switch (v$13032[0]) { case 0: {return [0,[v$13032[1][0],xs$13028]];
 break; }default: {return [1];
} };
}),tuscheme$0tuscheme$1.tyKeyword$3780);
v$10294 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8252){return [0,[[0,function(x$13035){return function(y$13036){return y$13036;
};
}],xs$8252]];
},function(v$13795){return tuscheme$0tuscheme$1.left$1682(v$13795);
}),v$10297));
v$10289 = (tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8240){return [0,[[0,function(x$13047){return function(y$13048){return x$13047;
};
}],xs$8240]];
},v$10294),function(tokens$13049){var v$13050 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13051){return [0,[[0,function(v$13052){return [2,v$13052];
}],xs$13051]];
},function(v$13796){return tuscheme$0tuscheme$1.right$1696(v$13796);
});
var v$13053 = v$13050(tokens$13049);
switch (v$13053[0]) { case 0: {var v$13054 = v$13053[1];
return [0,v$13054];
 break; }default: {return tuscheme$0tuscheme$1.scanToClose$1731(tokens$13049);
} };
}));
v$10217 = (tuscheme$0tuscheme$1.s$jtla$1279(function(xs$8222){return [0,[[0,function(v$13059){var v$13060 = v$13059[0];
var v$13061 = v$13059[1];
var msg$13062 = ("looking for expression but found `" + v$13061) + "'";
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$13060[0],v$13060[1]))([msg$13062,null])];
}],xs$8222]];
},v$10289));
v$10214 = (function(xs$8002){var v$8003 = v$10216(xs$8002);
switch (v$8003[0]) { case 0: {var v$8004 = v$8003[1];
return [0,v$8004];
 break; }default: {return v$10217(xs$8002);
} };
});
var v$10215 = tuscheme$0tuscheme$1.s$jal$1611(function(tokens$13063){var v$13064 = tuscheme$0tuscheme$1.left$1682(tokens$13063);
switch (v$13064[0]) { case 0: {var v$13065 = v$13064[1];
var v$13066 = v$13065[0];
switch (v$13066[0]) { case 0: {var v$13067 = v$13066[1];
var t$14604;
var t$14603;
switch (v$13067[1]) { case 2: {t$14603 = false;
 break; }default: {t$14603 = true;
} };
t$14604 = (t$14603?false:true);
return t$14604?v$13064:[1];
 break; }default: {return v$13064;
} };
 break; }default: {return v$13064;
} };
},"curly brackets are not supported");
v$10212 = (function(xs$7996){var v$7997 = v$10214(xs$7996);
switch (v$7997[0]) { case 0: {var v$7998 = v$7997[1];
return [0,v$7998];
 break; }default: {return v$10215(xs$7996);
} };
});
var v$10213 = tuscheme$0tuscheme$1.s$jal$1611(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8276){return [0,[[0,function(x$13071){return function(y$13072){return y$13072;
};
}],xs$8276]];
},function(v$13797){return tuscheme$0tuscheme$1.left$1682(v$13797);
}),function(v$13798){return tuscheme$0tuscheme$1.right$1696(v$13798);
}),"empty application");
v$10210 = (function(xs$7990){var v$7991 = v$10212(xs$7990);
switch (v$7991[0]) { case 0: {var v$7992 = v$7991[1];
return [0,v$7992];
 break; }default: {return v$10213(xs$7990);
} };
});
var v$10211;
var v$10311 = tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8285){return [0,[[0,function(x$13077){return function(y$13078){var v$13079 = [x$13077,y$13078];
return [10,v$13079];
};
}],xs$8285]];
},function(v$13799){return fix$14376.$exp(v$13799);
}),tuscheme$0tuscheme$1.many$1261(function(v$13800){return fix$14376.$exp(v$13800);
}));
v$10211 = (tuscheme$0tuscheme$1.liberalBracket$1841("function application",tuscheme$0tuscheme$1.s$jml$1604(v$10311,"function application")));
var v$7985 = v$10210(tokens$3875);
switch (v$7985[0]) { case 0: {var v$7986 = v$7985[1];
return [0,v$7986];
 break; }default: {return v$10211(tokens$3875);
} };
};
fix$14376.$bindings = function(ts$3906){return (tuscheme$0tuscheme$1.bindingsOf$3610("(x e)",function(v$13766){return tuscheme$0tuscheme$1.name$3595(v$13766);
},function(v$13767){return fix$14376.$exp(v$13767);
}))(ts$3906);
};
tuscheme$0tuscheme$1.exp$3872 = fix$14376.$exp;
tuscheme$0tuscheme$1.bindings$3869 = fix$14376.$bindings;
tuscheme$0tuscheme$1.unit_test$3913;
var v$10314;
var v$10316;
var v$10318 = tuscheme$0tuscheme$1.cb$3858("check-expect","(check-expect e1 e2)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8311){return [0,[[0,function(x$13084){return function(y$13085){var v$13086 = [x$13084,y$13085];
return [2,v$13086];
};
}],xs$8311]];
},function(v$13801){return tuscheme$0tuscheme$1.exp$3872(v$13801);
}),function(v$13802){return tuscheme$0tuscheme$1.exp$3872(v$13802);
}));
var v$10319 = tuscheme$0tuscheme$1.cb$3858("check-error","(check-error e)",tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8319){return [0,[[0,function(v$13088){return [3,v$13088];
}],xs$8319]];
},function(v$13803){return tuscheme$0tuscheme$1.exp$3872(v$13803);
}));
v$10316 = (function(xs$8304){var v$8305 = v$10318(xs$8304);
switch (v$8305[0]) { case 0: {var v$8306 = v$8305[1];
return [0,v$8306];
 break; }default: {return v$10319(xs$8304);
} };
});
var v$10317 = tuscheme$0tuscheme$1.cb$3858("check-type","(check-type e tau)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8324){return [0,[[0,function(x$13093){return function(y$13094){var v$13095 = [x$13093,y$13094];
return [1,v$13095];
};
}],xs$8324]];
},function(v$13804){return tuscheme$0tuscheme$1.exp$3872(v$13804);
}),function(v$13805){return tuscheme$0tuscheme$1.ty$3814(v$13805);
}));
v$10314 = (function(xs$8298){var v$8299 = v$10316(xs$8298);
switch (v$8299[0]) { case 0: {var v$8300 = v$8299[1];
return [0,v$8300];
 break; }default: {return v$10317(xs$8298);
} };
});
var v$10315 = tuscheme$0tuscheme$1.cb$3858("check-type-error","(check-type-error e)",tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8332){return [0,[[0,function(v$13097){return [0,v$13097];
}],xs$8332]];
},function(v$13806){return tuscheme$0tuscheme$1.exp$3872(v$13806);
}));
tuscheme$0tuscheme$1.unit_test$3913 = (function(xs$8292){var v$8293 = v$10314(xs$8292);
switch (v$8293[0]) { case 0: {var v$8294 = v$8293[1];
return [0,v$8294];
 break; }default: {return v$10315(xs$8292);
} };
});
tuscheme$0tuscheme$1.define$3918 = function(tau$3921,f$3924,formals$3927,body$3930){var v$10328;
var v$13689 = "definition of function " + f$3924;
var v$13100 = formals$3927[0];
var v$13101 = formals$3927[1];
var v$13102 = (tuscheme$0tuscheme$1.nodups$1640("formal parameter",v$13689))([v$13100,basis$0List$1.map$697(function(v$13103){return v$13103[0];
},v$13101)]);
switch (v$13102[0]) { case 0: {v$10328 = [0,v$13101];
 break; }default: {var v$13104 = v$13102[1];
v$10328 = [1,v$13104];
} };
switch (v$10328[0]) { case 0: {var v$8343 = v$10328[1];
var v$13114 = [3,[f$3924,tau$3921,[v$8343,body$3930]]];
return [0,v$13114];
 break; }default: {var v$8345 = v$10328[1];
return [1,v$8345];
} };
};
tuscheme$0tuscheme$1.valrec$3934 = function(tau$3937,x$3940,e$3943){return [0,[x$3940,tau$3937,e$3943]];
};
tuscheme$0tuscheme$1.xdef$3944;
var t$14380 = tuscheme$0tuscheme$1.s$jml$1604;
var t$14377;
var v$10336;
var v$10338;
var v$10340;
var v$10342;
var v$10345;
var v$10346;
var v$10348 = tuscheme$0tuscheme$1.cb$3858("define","(define type f (args) body)",tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8392){return [0,[[0,function(v$13641){return function(v$13642){return function(v$13643){return function(v$13644){return tuscheme$0tuscheme$1.define$3918(v$13641,v$13642,v$13643,v$13644);
};
};
};
}],xs$8392]];
},function(v$13807){return tuscheme$0tuscheme$1.ty$3814(v$13807);
}),function(v$13808){return tuscheme$0tuscheme$1.name$3595(v$13808);
}),tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13116){return [0,[[0,function(x$13117){return function(y$13118){return [x$13117,y$13118];
};
}],xs$13116]];
},function(xs$13119){var tx$13120 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$13121){return [0,[[0,function(v$13122){return v$13122[0];
}],xs$13121]];
},function(v$13809){return tuscheme$0tuscheme$1.inline$1491(v$13809);
});
var v$13123 = tx$13120(xs$13119);
switch (v$13123[0]) { case 0: {return [0,[v$13123[1][0],xs$13119]];
 break; }default: {return [1];
} };
}),tuscheme$0tuscheme$1.lformals$3836)),function(v$13810){return tuscheme$0tuscheme$1.exp$3872(v$13810);
}));
var v$10349 = tuscheme$0tuscheme$1.cb$3858("val","(val x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8397){return [0,[[0,function(x$13128){return function(y$13129){var v$13130 = [x$13128,y$13129];
return [1,v$13130];
};
}],xs$8397]];
},function(v$13811){return tuscheme$0tuscheme$1.name$3595(v$13811);
}),function(v$13812){return tuscheme$0tuscheme$1.exp$3872(v$13812);
}));
v$10346 = (function(xs$8385){var v$8386 = v$10348(xs$8385);
switch (v$8386[0]) { case 0: {var v$8387 = v$8386[1];
return [0,v$8387];
 break; }default: {return v$10349(xs$8385);
} };
});
var v$10347 = tuscheme$0tuscheme$1.cb$3858("val-rec","(val-rec type x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8405){return [0,[[0,function(tau$13134){return function(x$13135){return function(e$13136){return [0,[x$13135,tau$13134,e$13136]];
};
};
}],xs$8405]];
},function(v$13813){return tuscheme$0tuscheme$1.ty$3814(v$13813);
}),function(v$13814){return tuscheme$0tuscheme$1.name$3595(v$13814);
}),function(v$13815){return tuscheme$0tuscheme$1.exp$3872(v$13815);
}));
v$10345 = (function(xs$8379){var v$8380 = v$10346(xs$8379);
switch (v$8380[0]) { case 0: {var v$8381 = v$8380[1];
return [0,v$8381];
 break; }default: {return v$10347(xs$8379);
} };
});
v$10342 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8375){return [0,[[0,function(v$13138){return [3,v$13138];
}],xs$8375]];
},v$10345));
var v$10343 = tuscheme$0tuscheme$1.cb$3858("use","(use filename)",tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8413){return [0,[[0,function(v$13140){return [0,v$13140];
}],xs$8413]];
},function(v$13816){return tuscheme$0tuscheme$1.name$3595(v$13816);
}));
v$10340 = (function(xs$8368){var v$8369 = v$10342(xs$8368);
switch (v$8369[0]) { case 0: {var v$8370 = v$8369[1];
return [0,v$8370];
 break; }default: {return v$10343(xs$8368);
} };
});
var v$10341 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8418){return [0,[[0,function(v$13142){return [1,v$13142];
}],xs$8418]];
},tuscheme$0tuscheme$1.unit_test$3913);
v$10338 = (function(xs$8362){var v$8363 = v$10340(xs$8362);
switch (v$8363[0]) { case 0: {var v$8364 = v$8363[1];
return [0,v$8364];
 break; }default: {return v$10341(xs$8362);
} };
});
var v$10339 = tuscheme$0tuscheme$1.s$jtla$1279(function(xs$13144){return [0,[[0,function(v$13145){var v$13146 = v$13145[0];
var v$13147 = v$13145[1];
var msg$13148;
var t$14379 = "unexpected right bracket ";
var t$14378;
switch (v$13147) { case 1: {t$14378 = ")";
 break; }case 0: {t$14378 = "]";
 break; }default: {t$14378 = "}";
} };
msg$13148 = (t$14379 + t$14378);
return [1,(tuscheme$0tuscheme$1.synerrormsg$1331(v$13146[0],v$13146[1]))([msg$13148,null])];
}],xs$13144]];
},function(v$13817){return tuscheme$0tuscheme$1.right$1696(v$13817);
});
v$10336 = (function(xs$8356){var v$8357 = v$10338(xs$8356);
switch (v$8357[0]) { case 0: {var v$8358 = v$8357[1];
return [0,v$8358];
 break; }default: {return v$10339(xs$8356);
} };
});
var v$10337;
var v$10361 = tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8428){return [0,[[0,function(v$13150){return [2,v$13150];
}],xs$8428]];
},function(v$13818){return tuscheme$0tuscheme$1.exp$3872(v$13818);
});
v$10337 = (tuscheme$0tuscheme$1.s$jtl$1007(function(xs$8423){return [0,[[0,function(v$13152){return [3,v$13152];
}],xs$8423]];
},v$10361));
t$14377 = (function(xs$8350){var v$8351 = v$10336(xs$8350);
switch (v$8351[0]) { case 0: {var v$8352 = v$8351[1];
return [0,v$8352];
 break; }default: {return v$10337(xs$8350);
} };
});
tuscheme$0tuscheme$1.xdef$3944 = (t$14380(t$14377,"definition"));
tuscheme$0tuscheme$1.xdefstream$3951 = tuscheme$0tuscheme$1.interactiveParsedStream$2083(tuscheme$0tuscheme$1.schemeToken$3546,tuscheme$0tuscheme$1.xdef$3944);
tuscheme$0tuscheme$1.filexdefs$3952 = function(v$3958,v$3959,v$3960){return tuscheme$0tuscheme$1.xdefstream$3951([v$3958,tuscheme$0tuscheme$1.streamOfEffects$743(function(v$8430){return tuscheme$0stubs$1.inputLine$85(v$3959[0],v$3959[1]);
}),v$3960]);
};
tuscheme$0tuscheme$1.stringsxdefs$3961 = function(v$3966,v$3967){var t$14385 = tuscheme$0tuscheme$1.xdefstream$3951;
var t$14384;
var t$14383 = v$3966;
var t$14381;
var b$8434 = [1];
var fix$14382 = {};
fix$14382.$foldr = function(v$8437){if (v$8437 == null) {return b$8434;
} else {var v$8438 = v$8437;
var v$8439 = v$8438[0];
var v$8440 = v$8438[1];
var v$8441 = [v$8439,fix$14382.$foldr(v$8440)];
return [2,v$8441];
};
};
var foldr$8436 = fix$14382.$foldr;
t$14381 = (foldr$8436(v$3967));
t$14384 = [t$14383,t$14381,tuscheme$0tuscheme$1.noPrompts$2082];
return t$14385(t$14384);
};
tuscheme$0tuscheme$1.namedValueString$3968 = function(x$3971,v$3974){switch (v$3974[0]) { case 5: {return x$3971;
 break; }case 1: {return x$3971;
 break; }default: {return tuscheme$0tuscheme$1.valueString$2459(v$3974);
} };
};
var fix$14386 = {};
fix$14386.$eval = function(v$4157,v$4158){var fix$14542 = {};
fix$14542.$ev = function(v$3991){lab$ev: while (true) {switch (v$3991[0]) { case 5: {return v$3991[1];
 break; }case 3: {var v$4130 = v$3991[1];
var v$4131 = v$4130[0];
var t$14563 = v$4131;
var v$3991 = t$14563;
continue lab$ev;
 break; }case 2: {var v$4127 = v$3991[1];
var v$4128 = v$4127[1];
var t$14562 = v$4128;
var v$3991 = t$14562;
continue lab$ev;
 break; }case 1: {var v$4125 = v$3991[1];
return (tuscheme$0tuscheme$1.find$139(v$4125,v$4158))[0];
 break; }case 4: {var v$4121 = v$3991[1];
var v$4122 = v$4121[0];
var v$4123 = v$4121[1];
var v$4118 = fix$14542.$ev(v$4123);
((tuscheme$0tuscheme$1.find$139(v$4122,v$4158))[0] = v$4118,0);
return v$4118;
 break; }case 8: {var v$4113 = v$3991[1];
var v$4114 = v$4113[0];
var v$4115 = v$4113[1];
var v$4116 = v$4113[2];
var t$14560;
var t$14559;
var v$8444 = fix$14542.$ev(v$4114);
switch (v$8444[0]) { case 6: {t$14559 = v$8444[1];
 break; }default: {t$14559 = true;
} };
t$14560 = (t$14559?v$4115:v$4116);
var t$14561 = t$14560;
var v$3991 = t$14561;
continue lab$ev;
 break; }case 0: {var v$4105 = v$3991[1];
var v$4106 = v$4105[0];
var v$4107 = v$4105[1];
var t$14557;
var v$8445 = fix$14542.$ev(v$4106);
switch (v$8445[0]) { case 6: {t$14557 = v$8445[1];
 break; }default: {t$14557 = true;
} };
if (t$14557) {fix$14542.$ev(v$4107);
var t$14558 = [0,[v$4106,v$4107]];
var v$3991 = t$14558;
continue lab$ev;
} else {return tuscheme$0tuscheme$1.unitVal$2641;
};
 break; }case 9: {var v$4097 = v$3991[1];
var fix$14554 = {};
fix$14554.$b = function(v$4090,v$13590){lab$b: while (true) {if (v$4090 == null) {return v$13590;
} else {var v$4092 = v$4090;
var v$4093 = v$4092[0];
var v$4094 = v$4092[1];
var t$14555 = v$4094;
var t$14556 = fix$14542.$ev(v$4093);
var v$4090 = t$14555;
var v$13590 = t$14556;
continue lab$b;
};
};
};
var b$4078 = fix$14554.$b;
return b$4078(v$4097,tuscheme$0tuscheme$1.unitVal$2641);
 break; }case 7: {var v$4074 = v$3991[1];
var v$4075 = v$4074[0];
var v$4076 = v$4074[1];
return [5,[[basis$0List$1.map$697((function(env$14553){return function(v$4071){return v$4071[0];
};
})([]),v$4075),v$4076],v$4158]];
 break; }case 10: {var v$4064 = v$3991[1];
var v$4065 = v$4064[0];
var v$4066 = v$4064[1];
var v$4045 = fix$14542.$ev(v$4065);
switch (v$4045[0]) { case 1: {var v$4063 = v$4045[1];
return v$4063(basis$0List$1.map$697((function(env$14552){return function(v$13819){var v$14551 = env$14552[0];
return v$14551(v$13819);
};
})([fix$14542.$ev]),v$4066));
 break; }case 5: {var v$4061 = v$4045[1];
var v$4057 = v$4061[0];
var v$4058 = v$4057[0];
var v$4059 = v$4057[1];
var v$4060 = v$4061[1];
var actuals$4051 = basis$0List$1.map$697((function(env$14544){return function(v$13820){var v$14543 = env$14544[0];
return v$14543(v$13820);
};
})([fix$14542.$ev]),v$4066);
try {return fix$14386.$eval(v$4059,tuscheme$0tuscheme$1.bindList$174(v$4058,basis$0List$1.map$697((function(env$14546){return function(v$4052){return [v$4052];
};
})([]),actuals$4051),v$4060));
} catch(v$14545) {return ((function(env$14549){return function(BindListLength$4055){var v$14547 = env$14549[0];
var v$14548 = env$14549[1];
var t$14550 = BindListLength$4055;
if (t$14550[0] == tuscheme$0tuscheme$1.en$BindListLength$164) {throw [tuscheme$0tuscheme$1.en$RuntimeError$225,("Wrong number of arguments to closure; expected (" + (v$14548(v$14547))) + ")"];
} else {throw BindListLength$4055;
};
};
})([v$4058,tuscheme$0tuscheme$1.spaceSep$414]))(v$14545);
};
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"applied non-function"];
} };
 break; }default: {var v$4134 = v$3991[1];
switch (v$4134[0][0]) { case 1: {var v$4143 = v$4134[1];
var v$4144 = v$4134[2];
var v$4140 = basis$0ListPair$1.unzip$140(v$4143);
var v$4141 = v$4140[0];
var v$4142 = v$4140[1];
return fix$14386.$eval(v$4144,tuscheme$0tuscheme$1.bindList$174(v$4141,basis$0List$1.map$697((function(env$14565){return function(x$8452){var v$14564 = env$14565[0];
return [v$14564(x$8452)];
};
})([fix$14542.$ev]),v$4142),v$4158));
 break; }default: {var v$4155 = v$4134[1];
var v$4156 = v$4134[2];
var t$14572 = fix$14386.$eval;
var t$14571 = v$4156;
var t$14570;
var fix$14566 = {};
fix$14566.$foldl = function(v$8458,v$8459){lab$foldl: while (true) {if (v$8459 == null) {return v$8458;
} else {var v$8460 = v$8459;
var v$8461 = v$8460[0];
var v$8462 = v$8460[1];
var t$14567;
var v$13157 = v$8461[0];
var v$13158 = v$8461[1];
t$14567 = [[v$13157,[fix$14386.$eval(v$13158,v$8458)]],v$8458];
var t$14568 = t$14567;
var t$14569 = v$8462;
var v$8458 = t$14568;
var v$8459 = t$14569;
continue lab$foldl;
};
};
};
var foldl$8457 = fix$14566.$foldl;
t$14570 = (foldl$8457(v$4158,v$4155));
return t$14572(t$14571,t$14570);
} };
} };
};
};
var ev$3988 = fix$14542.$ev;
return ev$3988(v$4157);
};
tuscheme$0tuscheme$1.eval$3983 = fix$14386.$eval;
var fix$14387 = {};
fix$14387.$evaldef = function(v$4184,v$13591){lab$evaldef: while (true) {switch (v$4184[0]) { case 1: {var v$4202 = v$4184[1];
var v$4203 = v$4202[0];
var v$4204 = v$4202[1];
var v$4200 = tuscheme$0tuscheme$1.eval$3983(v$4204,v$13591);
var t$14391 = [[v$4203,[v$4200]],v$13591];
var t$14390;
switch (v$4200[0]) { case 5: {t$14390 = v$4203;
 break; }case 1: {t$14390 = v$4203;
 break; }default: {t$14390 = (tuscheme$0tuscheme$1.valueString$2459(v$4200));
} };
return [t$14391,t$14390];
 break; }case 0: {var v$4194 = v$4184[1];
var v$4195 = v$4194[0];
var v$4197 = v$4194[2];
var this$4191 = [[4]];
var rho$$4192 = [[v$4195,this$4191],v$13591];
var v$4193 = tuscheme$0tuscheme$1.eval$3983(v$4197,rho$$4192);
(this$4191[0] = v$4193,0);
var t$14389 = rho$$4192;
var t$14388;
switch (v$4193[0]) { case 5: {t$14388 = v$4195;
 break; }case 1: {t$14388 = v$4195;
 break; }default: {t$14388 = (tuscheme$0tuscheme$1.valueString$2459(v$4193));
} };
return [t$14389,t$14388];
 break; }case 2: {var v$4188 = v$4184[1];
var v$4186 = tuscheme$0tuscheme$1.eval$3983(v$4188,v$13591);
return [[["it",[v$4186]],v$13591],tuscheme$0tuscheme$1.valueString$2459(v$4186)];
 break; }default: {var v$4206 = v$4184[1];
var v$4207 = v$4206[0];
var v$4208 = v$4206[1];
var v$4209 = v$4206[2];
var t$14392 = [0,[v$4207,v$4208,[7,v$4209]]];
var t$14393 = v$13591;
var v$4184 = t$14392;
var v$13591 = t$14393;
continue lab$evaldef;
} };
};
};
tuscheme$0tuscheme$1.evaldef$4159 = fix$14387.$evaldef;
tuscheme$0tuscheme$1.processDef$4211 = function(v$4235,v$4236,v$13592){var v$4237 = v$4236[0];
var v$4238 = v$4236[1];
var v$4239 = v$4236[2];
var v$4232 = tuscheme$0tuscheme$1.elabdef$3424(v$4235,v$4237,v$4238);
var v$4233 = v$4232[0];
var v$4234 = v$4232[1];
var v$4229 = tuscheme$0tuscheme$1.evaldef$4159(v$4235,v$4239);
var v$4230 = v$4229[0];
var v$4231 = v$4229[1];
var t$14394;
switch (v$13592[1]) { case 0: {t$14394 = true;
 break; }default: {t$14394 = false;
} };
if (t$14394) {var s$8478 = (v$4231 + " : ") + v$4234;
tuscheme$0stubs$1.print$119(s$8478);
tuscheme$0stubs$1.print$119("\n");
} else {0;
};
return [v$4237,v$4233,v$4230];
};
tuscheme$0tuscheme$1.failtest$4241 = function(strings$4244){var fix$14395 = {};
fix$14395.$app = function(v$8484){lab$app: while (true) {if (v$8484 == null) {return 0;
} else {var v$8485 = v$8484;
var v$8486 = v$8485[0];
var v$8487 = v$8485[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8486);
var t$14396 = v$8487;
var v$8484 = t$14396;
continue lab$app;
};
};
};
var app$8483 = fix$14395.$app;
app$8483(strings$4244);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
};
tuscheme$0tuscheme$1.reportTestResultsOf$4249 = function(what$4252,v$4256){var v$4285 = v$4256[0];
var v$4286 = v$4256[1];
var rhs6$4263 = function(obj$4284){if (v$4285 == v$4286) {var l$8491 = ["All ",[tuscheme$0tuscheme$1.intString$351(v$4286),[(" " + what$4252) + "s passed.\n",null]]];
var fix$14397 = {};
fix$14397.$app = function(v$8493){lab$app: while (true) {if (v$8493 == null) {return 0;
} else {var v$8494 = v$8493;
var v$8495 = v$8494[0];
var v$8496 = v$8494[1];
tuscheme$0stubs$1.print$119(v$8495);
var t$14398 = v$8496;
var v$8493 = t$14398;
continue lab$app;
};
};
};
var app$8492 = fix$14397.$app;
return app$8492(l$8491);
} else {if (v$4285 == 0) {var l$8500 = ["All ",[tuscheme$0tuscheme$1.intString$351(v$4286),[(" " + what$4252) + "s failed.\n",null]]];
var fix$14399 = {};
fix$14399.$app = function(v$8502){lab$app: while (true) {if (v$8502 == null) {return 0;
} else {var v$8503 = v$8502;
var v$8504 = v$8503[0];
var v$8505 = v$8503[1];
tuscheme$0stubs$1.print$119(v$8504);
var t$14400 = v$8505;
var v$8502 = t$14400;
continue lab$app;
};
};
};
var app$8501 = fix$14399.$app;
return app$8501(l$8500);
} else {var l$8509 = [tuscheme$0tuscheme$1.intString$351(v$4285),[" of ",[tuscheme$0tuscheme$1.intString$351(v$4286),[(" " + what$4252) + "s passed.\n",null]]]];
var fix$14401 = {};
fix$14401.$app = function(v$8511){lab$app: while (true) {if (v$8511 == null) {return 0;
} else {var v$8512 = v$8511;
var v$8513 = v$8512[0];
var v$8514 = v$8512[1];
tuscheme$0stubs$1.print$119(v$8513);
var t$14402 = v$8514;
var v$8511 = t$14402;
continue lab$app;
};
};
};
var app$8510 = fix$14401.$app;
return app$8510(l$8509);
};
};
};
switch (v$4286) { case 0: {return 0;
 break; }default: {switch (v$4285) { case 0: {switch (v$4286) { case 1: {var s$8517 = ("The only " + what$4252) + " failed.";
tuscheme$0stubs$1.print$119(s$8517);
return tuscheme$0stubs$1.print$119("\n");
 break; }case 2: {var s$8520 = ("Both " + what$4252) + "s failed.";
tuscheme$0stubs$1.print$119(s$8520);
return tuscheme$0stubs$1.print$119("\n");
 break; }default: {return rhs6$4263(0);
} };
 break; }case 1: {switch (v$4286) { case 1: {var s$8523 = ("The only " + what$4252) + " passed.";
tuscheme$0stubs$1.print$119(s$8523);
return tuscheme$0stubs$1.print$119("\n");
 break; }case 2: {var s$8526 = ("One of two " + what$4252) + "s passed.";
tuscheme$0stubs$1.print$119(s$8526);
return tuscheme$0stubs$1.print$119("\n");
 break; }default: {return rhs6$4263(0);
} };
 break; }case 2: {switch (v$4286) { case 2: {var s$8529 = ("Both " + what$4252) + "s passed.";
tuscheme$0stubs$1.print$119(s$8529);
return tuscheme$0stubs$1.print$119("\n");
 break; }default: {return rhs6$4263(0);
} };
 break; }default: {return rhs6$4263(0);
} };
} };
};
tuscheme$0tuscheme$1.reportTestResults$4287 = function(v$13648){return tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",v$13648);
};
tuscheme$0tuscheme$1.testIsGood$4288 = function(v$4522,v$4523){var v$4524 = v$4523[0];
var v$4525 = v$4523[1];
var v$4526 = v$4523[2];
var t$14403;
switch (v$4522[0]) { case 2: {var v$8875 = v$4522[1];
var v$8876 = v$8875[0];
var v$8877 = v$8875[1];
try {var tau1$8881;
try {tau1$8881 = (tuscheme$0tuscheme$1.typeof$3161(v$8876,v$4524,v$4525));
} catch(v$14417) {tau1$8881 = ((function(v$8882){var t$14418 = v$8882;
if (t$14418[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$8883 = v$8882[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$8883) + " is not defined"];
} else {throw v$8882;
};
})(v$14417));
};
var tau2$8886;
try {tau2$8886 = (tuscheme$0tuscheme$1.typeof$3161(v$8877,v$4524,v$4525));
} catch(v$14419) {tau2$8886 = ((function(v$8887){var t$14420 = v$8887;
if (t$14420[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$8888 = v$8887[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$8888) + " is not defined"];
} else {throw v$8887;
};
})(v$14419));
};
if (tuscheme$0tuscheme$1.eqType$2889(tau1$8881,tau2$8886)) {t$14403 = true;
} else {throw [tuscheme$0tuscheme$1.en$TypeError$87,(("Expressions have types " + (tuscheme$0tuscheme$1.typeString$2200(tau1$8881))) + " and ") + (tuscheme$0tuscheme$1.typeString$2200(tau2$8886))];
};
} catch(v$14416) {t$14403 = ((function(v$8894){var t$14421 = v$8894;
if (t$14421[0] == tuscheme$0tuscheme$1.en$TypeError$87) {var msg$8895 = v$8894[1];
var strings$8896 = ["In (check-expect ",[tuscheme$0tuscheme$1.expString$2514(v$8876),[" ",[tuscheme$0tuscheme$1.expString$2514(v$8877),["), ",[msg$8895,null]]]]]];
var fix$14422 = {};
fix$14422.$app = function(v$8898){lab$app: while (true) {if (v$8898 == null) {return 0;
} else {var v$8899 = v$8898;
var v$8900 = v$8899[0];
var v$8901 = v$8899[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8900);
var t$14423 = v$8901;
var v$8898 = t$14423;
continue lab$app;
};
};
};
var app$8897 = fix$14422.$app;
app$8897(strings$8896);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} else {throw v$8894;
};
})(v$14416));
};
 break; }case 3: {var v$8902 = v$4522[1];
try {try {tuscheme$0tuscheme$1.typeof$3161(v$8902,v$4524,v$4525);
} catch(v$14411) {(function(v$8904){var t$14412 = v$8904;
if (t$14412[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$8905 = v$8904[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$8905) + " is not defined"];
} else {throw v$8904;
};
})(v$14411);
};
t$14403 = true;
} catch(v$14410) {t$14403 = ((function(v$8908){var t$14413 = v$8908;
if (t$14413[0] == tuscheme$0tuscheme$1.en$TypeError$87) {var msg$8909 = v$8908[1];
var strings$8910 = ["In (check-error ",[tuscheme$0tuscheme$1.expString$2514(v$8902),["), ",[msg$8909,null]]]];
var fix$14414 = {};
fix$14414.$app = function(v$8912){lab$app: while (true) {if (v$8912 == null) {return 0;
} else {var v$8913 = v$8912;
var v$8914 = v$8913[0];
var v$8915 = v$8913[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8914);
var t$14415 = v$8915;
var v$8912 = t$14415;
continue lab$app;
};
};
};
var app$8911 = fix$14414.$app;
app$8911(strings$8910);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} else {throw v$8908;
};
})(v$14410));
};
 break; }case 1: {var v$8916 = v$4522[1];
var v$8917 = v$8916[0];
var v$8918 = v$8916[1];
try {try {tuscheme$0tuscheme$1.typeof$3161(v$8917,v$4524,v$4525);
} catch(v$14405) {(function(v$8922){var t$14406 = v$8922;
if (t$14406[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$8923 = v$8922[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$8923) + " is not defined"];
} else {throw v$8922;
};
})(v$14405);
};
t$14403 = true;
} catch(v$14404) {t$14403 = ((function(v$8926){var t$14407 = v$8926;
if (t$14407[0] == tuscheme$0tuscheme$1.en$TypeError$87) {var msg$8927 = v$8926[1];
var strings$8928 = ["In (check-type ",[tuscheme$0tuscheme$1.expString$2514(v$8917),[" " + (tuscheme$0tuscheme$1.typeString$2200(v$8918)),["), ",[msg$8927,null]]]]];
var fix$14408 = {};
fix$14408.$app = function(v$8931){lab$app: while (true) {if (v$8931 == null) {return 0;
} else {var v$8932 = v$8931;
var v$8933 = v$8932[0];
var v$8934 = v$8932[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8933);
var t$14409 = v$8934;
var v$8931 = t$14409;
continue lab$app;
};
};
};
var app$8930 = fix$14408.$app;
app$8930(strings$8928);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} else {throw v$8926;
};
})(v$14404));
};
 break; }default: {t$14403 = true;
} };
if (t$14403) {switch (v$4522[0]) { case 2: {var v$8936 = v$4522[1];
var v$8937 = v$8936[0];
var v$8938 = v$8936[1];
var v$10466;
try {v$10466 = [0,tuscheme$0tuscheme$1.eval$3983(v$8937,v$4526)];
} catch(v$14435) {v$10466 = ((function(v$8946){return [1,"evaluation failed"];
})(v$14435));
};
var v$10467;
try {v$10467 = [0,tuscheme$0tuscheme$1.eval$3983(v$8938,v$4526)];
} catch(v$14436) {v$10467 = ((function(v$8947){return [1,"evaluation failed"];
})(v$14436));
};
switch (v$10466[0]) { case 0: {switch (v$10467[0]) { case 0: {var v$8950 = v$10466[1];
var v$8951 = v$10467[1];
if (tuscheme$0tuscheme$1.equalpairs$2712(v$8950,v$8951)) {return true;
} else {var strings$8952;
var t$14450;
var t$14449 = "check-expect failed: ";
var t$14448;
var t$14447;
var t$14446 = " expected ";
var t$14445;
var t$14444;
var t$14443 = tuscheme$0tuscheme$1.expString$2514(v$8937);
var t$14442;
var t$14441;
var t$14440 = " to evaluate to ";
var t$14439;
var t$14438;
var t$14437;
var v$13420 = [0,v$8951];
var v$13164;
switch (v$8938[0]) { case 5: {var v$13165 = v$8938[1];
v$13164 = [0,v$13165];
 break; }default: {v$13164 = [1];
} };
switch (v$13164[0]) { case 0: {var v$13166 = v$13164[1];
t$14437 = (tuscheme$0tuscheme$1.valueString$2459(v$13166));
 break; }default: {switch (v$13420[0]) { case 0: {var v$13167 = v$13420[1];
t$14437 = ((((tuscheme$0tuscheme$1.valueString$2459(v$13167)) + " (from evaluating ") + (tuscheme$0tuscheme$1.expString$2514(v$8938))) + ")");
 break; }default: {t$14437 = ("the result of evaluating " + (tuscheme$0tuscheme$1.expString$2514(v$8938)));
} };
} };
t$14438 = [t$14437,[", but it's ",[tuscheme$0tuscheme$1.valueString$2459(v$8950),[".",null]]]];
t$14439 = t$14438;
t$14441 = [t$14440,t$14439];
t$14442 = t$14441;
t$14444 = [t$14443,t$14442];
t$14445 = t$14444;
t$14447 = [t$14446,t$14445];
t$14448 = t$14447;
t$14450 = [t$14449,t$14448];
strings$8952 = t$14450;
var fix$14451 = {};
fix$14451.$app = function(v$8954){lab$app: while (true) {if (v$8954 == null) {return 0;
} else {var v$8955 = v$8954;
var v$8956 = v$8955[0];
var v$8957 = v$8955[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8956);
var t$14452 = v$8957;
var v$8954 = t$14452;
continue lab$app;
};
};
};
var app$8953 = fix$14451.$app;
app$8953(strings$8952);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
};
 break; }default: {var v$8958 = v$10467[1];
var strings$8959;
var t$14466;
var t$14465 = "check-expect failed: ";
var t$14464;
var t$14463;
var t$14462 = " expected ";
var t$14461;
var t$14460;
var t$14459 = tuscheme$0tuscheme$1.expString$2514(v$8937);
var t$14458;
var t$14457;
var t$14456 = " to evaluate to ";
var t$14455;
var t$14454;
var t$14453;
var v$13422 = [1,v$8958];
var v$13171;
switch (v$8938[0]) { case 5: {var v$13172 = v$8938[1];
v$13171 = [0,v$13172];
 break; }default: {v$13171 = [1];
} };
switch (v$13171[0]) { case 0: {var v$13173 = v$13171[1];
t$14453 = (tuscheme$0tuscheme$1.valueString$2459(v$13173));
 break; }default: {switch (v$13422[0]) { case 0: {var v$13174 = v$13422[1];
t$14453 = ((((tuscheme$0tuscheme$1.valueString$2459(v$13174)) + " (from evaluating ") + (tuscheme$0tuscheme$1.expString$2514(v$8938))) + ")");
 break; }default: {t$14453 = ("the result of evaluating " + (tuscheme$0tuscheme$1.expString$2514(v$8938)));
} };
} };
t$14454 = [t$14453,[", but evaluating ",[tuscheme$0tuscheme$1.expString$2514(v$8938),[" caused an error.",null]]]];
t$14455 = t$14454;
t$14457 = [t$14456,t$14455];
t$14458 = t$14457;
t$14460 = [t$14459,t$14458];
t$14461 = t$14460;
t$14463 = [t$14462,t$14461];
t$14464 = t$14463;
t$14466 = [t$14465,t$14464];
strings$8959 = t$14466;
var fix$14467 = {};
fix$14467.$app = function(v$8961){lab$app: while (true) {if (v$8961 == null) {return 0;
} else {var v$8962 = v$8961;
var v$8963 = v$8962[0];
var v$8964 = v$8962[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8963);
var t$14468 = v$8964;
var v$8961 = t$14468;
continue lab$app;
};
};
};
var app$8960 = fix$14467.$app;
app$8960(strings$8959);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} };
 break; }default: {var strings$8966;
var t$14482;
var t$14481 = "check-expect failed: ";
var t$14480;
var t$14479;
var t$14478 = " expected ";
var t$14477;
var t$14476;
var t$14475 = tuscheme$0tuscheme$1.expString$2514(v$8937);
var t$14474;
var t$14473;
var t$14472 = " to evaluate to ";
var t$14471;
var t$14470;
var t$14469;
var v$13178;
switch (v$8938[0]) { case 5: {var v$13179 = v$8938[1];
v$13178 = [0,v$13179];
 break; }default: {v$13178 = [1];
} };
switch (v$13178[0]) { case 0: {var v$13180 = v$13178[1];
t$14469 = (tuscheme$0tuscheme$1.valueString$2459(v$13180));
 break; }default: {switch (v$10467[0]) { case 0: {var v$13181 = v$10467[1];
t$14469 = ((((tuscheme$0tuscheme$1.valueString$2459(v$13181)) + " (from evaluating ") + (tuscheme$0tuscheme$1.expString$2514(v$8938))) + ")");
 break; }default: {t$14469 = ("the result of evaluating " + (tuscheme$0tuscheme$1.expString$2514(v$8938)));
} };
} };
t$14470 = [t$14469,[", but evaluating ",[tuscheme$0tuscheme$1.expString$2514(v$8937),[" caused an error.",null]]]];
t$14471 = t$14470;
t$14473 = [t$14472,t$14471];
t$14474 = t$14473;
t$14476 = [t$14475,t$14474];
t$14477 = t$14476;
t$14479 = [t$14478,t$14477];
t$14480 = t$14479;
t$14482 = [t$14481,t$14480];
strings$8966 = t$14482;
var fix$14483 = {};
fix$14483.$app = function(v$8968){lab$app: while (true) {if (v$8968 == null) {return 0;
} else {var v$8969 = v$8968;
var v$8970 = v$8969[0];
var v$8971 = v$8969[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8970);
var t$14484 = v$8971;
var v$8968 = t$14484;
continue lab$app;
};
};
};
var app$8967 = fix$14483.$app;
app$8967(strings$8966);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} };
 break; }case 3: {var v$8972 = v$4522[1];
var v$8974;
try {v$8974 = [0,tuscheme$0tuscheme$1.eval$3983(v$8972,v$4526)];
} catch(v$14432) {v$8974 = ((function(v$8975){return [1,"evaluation failed"];
})(v$14432));
};
switch (v$8974[0]) { case 1: {return true;
 break; }default: {var v$8976 = v$8974[1];
var strings$8977 = ["check-error failed: ",[" expected evaluating ",[tuscheme$0tuscheme$1.expString$2514(v$8972),[" to cause an error, but evaluation produced ",[tuscheme$0tuscheme$1.valueString$2459(v$8976),null]]]]];
var fix$14433 = {};
fix$14433.$app = function(v$8979){lab$app: while (true) {if (v$8979 == null) {return 0;
} else {var v$8980 = v$8979;
var v$8981 = v$8980[0];
var v$8982 = v$8980[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8981);
var t$14434 = v$8982;
var v$8979 = t$14434;
continue lab$app;
};
};
};
var app$8978 = fix$14433.$app;
app$8978(strings$8977);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} };
 break; }case 1: {var v$8983 = v$4522[1];
var v$8984 = v$8983[0];
var v$8985 = v$8983[1];
try {var tau$$8989;
try {tau$$8989 = (tuscheme$0tuscheme$1.typeof$3161(v$8984,v$4524,v$4525));
} catch(v$14425) {tau$$8989 = ((function(v$8990){var t$14426 = v$8990;
if (t$14426[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$8991 = v$8990[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$8991) + " is not defined"];
} else {throw v$8990;
};
})(v$14425));
};
if (tuscheme$0tuscheme$1.eqType$2889(v$8985,tau$$8989)) {return true;
} else {var strings$8994 = ["check-type failed: expected ",[tuscheme$0tuscheme$1.expString$2514(v$8984),[" to have type ",[tuscheme$0tuscheme$1.typeString$2200(v$8985),[", but it has type ",[tuscheme$0tuscheme$1.typeString$2200(tau$$8989),null]]]]]];
var fix$14427 = {};
fix$14427.$app = function(v$8996){lab$app: while (true) {if (v$8996 == null) {return 0;
} else {var v$8997 = v$8996;
var v$8998 = v$8997[0];
var v$8999 = v$8997[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$8998);
var t$14428 = v$8999;
var v$8996 = t$14428;
continue lab$app;
};
};
};
var app$8995 = fix$14427.$app;
app$8995(strings$8994);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
};
} catch(v$14424) {return (function(v$9000){var t$14429 = v$9000;
if (t$14429[0] == tuscheme$0tuscheme$1.en$TypeError$87) {var msg$9001 = v$9000[1];
var strings$9002 = ["In (check-type ",[tuscheme$0tuscheme$1.expString$2514(v$8984),[" " + (tuscheme$0tuscheme$1.typeString$2200(v$8985)),["), ",[msg$9001,null]]]]];
var fix$14430 = {};
fix$14430.$app = function(v$9005){lab$app: while (true) {if (v$9005 == null) {return 0;
} else {var v$9006 = v$9005;
var v$9007 = v$9006[0];
var v$9008 = v$9006[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$9007);
var t$14431 = v$9008;
var v$9005 = t$14431;
continue lab$app;
};
};
};
var app$9004 = fix$14430.$app;
app$9004(strings$9002);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} else {throw v$9000;
};
})(v$14424);
};
 break; }default: {var v$9009 = v$4522[1];
try {var tau$9011;
try {tau$9011 = (tuscheme$0tuscheme$1.typeof$3161(v$9009,v$4524,v$4525));
} catch(v$14486) {tau$9011 = ((function(v$9012){var t$14487 = v$9012;
if (t$14487[0] == tuscheme$0tuscheme$1.en$NotFound$138) {var x$9013 = v$9012[1];
throw [tuscheme$0tuscheme$1.en$TypeError$87,("name " + x$9013) + " is not defined"];
} else {throw v$9012;
};
})(v$14486));
};
var strings$9016 = ["check-type-error failed: expected ",[tuscheme$0tuscheme$1.expString$2514(v$9009),[" not to have a type, but it has type ",[tuscheme$0tuscheme$1.typeString$2200(tau$9011),null]]]];
var fix$14488 = {};
fix$14488.$app = function(v$9018){lab$app: while (true) {if (v$9018 == null) {return 0;
} else {var v$9019 = v$9018;
var v$9020 = v$9019[0];
var v$9021 = v$9019[1];
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,v$9020);
var t$14489 = v$9021;
var v$9018 = t$14489;
continue lab$app;
};
};
};
var app$9017 = fix$14488.$app;
app$9017(strings$9016);
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
return false;
} catch(v$14485) {return (function(v$9022){var t$14490 = v$9022;
if (t$14490[0] == tuscheme$0tuscheme$1.en$TypeError$87) {return true;
} else {if (t$14490[0] == tuscheme$0tuscheme$1.en$Located$1349) {var t$14491 = v$9022[1][1];
if (t$14491[0] == tuscheme$0tuscheme$1.en$TypeError$87) {return true;
} else {throw v$9022;
};
} else {throw v$9022;
};
};
})(v$14485);
};
} };
} else {return false;
};
};
tuscheme$0tuscheme$1.numberOfGoodTests$4527 = function(v$4542,v$4543){var fix$14492 = {};
fix$14492.$foldr = function(v$9027){if (v$9027 == null) {return 0;
} else {var v$9028 = v$9027;
var v$9029 = v$9028[0];
var v$9030 = v$9028[1];
var v$13426 = fix$14492.$foldr(v$9030);
return (tuscheme$0tuscheme$1.testIsGood$4288(v$9029,v$4543))?(SmlPrims.chk_ovf_i32(v$13426 + 1)):v$13426;
};
};
var foldr$9026 = fix$14492.$foldr;
return foldr$9026(v$4542);
};
tuscheme$0tuscheme$1.processTests$4544 = function(v$4549,v$4550){var v$13676;
var t$14498;
var fix$14497 = {};
fix$14497.$foldr = function(v$13189){if (v$13189 == null) {return 0;
} else {var v$13190 = v$13189;
var v$13191 = v$13190[0];
var v$13192 = v$13190[1];
var v$13430 = fix$14497.$foldr(v$13192);
return (tuscheme$0tuscheme$1.testIsGood$4288(v$13191,v$4550))?(SmlPrims.chk_ovf_i32(v$13430 + 1)):v$13430;
};
};
var foldr$13188 = fix$14497.$foldr;
t$14498 = (foldr$13188(v$4549));
var t$14496;
var fix$14493 = {};
fix$14493.$acc = function(v$9033,v$9034){lab$acc: while (true) {if (v$9033 == null) {return v$9034;
} else {var v$9035 = v$9033;
var v$9036 = v$9035[1];
var t$14494 = v$9036;
var t$14495 = SmlPrims.chk_ovf_i32(v$9034 + 1);
var v$9033 = t$14494;
var v$9034 = t$14495;
continue lab$acc;
};
};
};
var acc$9032 = fix$14493.$acc;
t$14496 = (acc$9032(v$4549,0));
v$13676 = [t$14498,t$14496];
return tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",v$13676);
};
tuscheme$0tuscheme$1.processPredefined$4551 = function(v$4556,v$4557){return tuscheme$0tuscheme$1.processDef$4211(v$4556,v$4557,tuscheme$0tuscheme$1.noninteractive$547);
};
var fix$14499 = {};
fix$14499.$readEvalPrintWith = function(errmsg$4561,v$4566){var v$4689 = v$4566[0];
var v$4690 = v$4566[1];
var v$4691 = v$4566[2];
var unitTests$4567 = [null];
var fix$14518 = {};
fix$14518.$processXDef = function(v$4686,v$4687){var caught$4627 = function(e$4630){var t$14536 = errmsg$4561;
var t$14529;
var t$14528 = e$4630;
if (t$14528[0] == tuscheme$0tuscheme$1.en$Located$1349) {var v$9065 = e$4630[1][0];
var v$9066 = e$4630[1][1];
var t$14535 = tuscheme$0tuscheme$1.fillComplaintTemplate$1388;
var t$14534;
var t$14533 = v$9066;
if (t$14533[0] == tuscheme$0stubs$1.en$IO_Io$64) {t$14534 = ("I/O error <at loc>: " + v$9066[1][0]);
} else {if (t$14533[0] == CompilerInitial.en$Div$47) {t$14534 = "Division by zero <at loc>";
} else {if (t$14533[0] == CompilerInitial.en$Overflow$50) {t$14534 = "Arithmetic overflow <at loc>";
} else {if (t$14533[0] == CompilerInitial.en$Subscript$52) {t$14534 = "Array index out of bounds <at loc>";
} else {if (t$14533[0] == CompilerInitial.en$Size$53) {t$14534 = "Array length too large (or negative) <at loc>";
} else {if (t$14533[0] == tuscheme$0tuscheme$1.en$RuntimeError$225) {t$14534 = ("Run-time error <at loc>: " + v$9066[1]);
} else {if (t$14533[0] == tuscheme$0tuscheme$1.en$NotFound$138) {t$14534 = (("Variable " + v$9066[1]) + " not found <at loc>");
} else {if (t$14533[0] == tuscheme$0tuscheme$1.en$TypeError$87) {t$14534 = ("type error <at loc>: " + v$9066[1]);
} else {if (t$14533[0] == tuscheme$0tuscheme$1.en$BugInTypeChecking$88) {t$14534 = ("bug in type checking: " + v$9066[1]);
} else {if (t$14533[0] == tuscheme$0tuscheme$1.en$Located$1349) {t$14534 = "internal error --- template mustn't be used";
} else {throw [tuscheme$0tuscheme$1.en$InternalError$241,"exception has handler but no template"];
};
};
};
};
};
};
};
};
};
};
t$14529 = (t$14535(t$14534,[0,v$9065]));
} else {var t$14532 = tuscheme$0tuscheme$1.fillComplaintTemplate$1388;
var t$14531;
var t$14530 = e$4630;
if (t$14530[0] == tuscheme$0stubs$1.en$IO_Io$64) {t$14531 = ("I/O error <at loc>: " + e$4630[1][0]);
} else {if (t$14530[0] == CompilerInitial.en$Div$47) {t$14531 = "Division by zero <at loc>";
} else {if (t$14530[0] == CompilerInitial.en$Overflow$50) {t$14531 = "Arithmetic overflow <at loc>";
} else {if (t$14530[0] == CompilerInitial.en$Subscript$52) {t$14531 = "Array index out of bounds <at loc>";
} else {if (t$14530[0] == CompilerInitial.en$Size$53) {t$14531 = "Array length too large (or negative) <at loc>";
} else {if (t$14530[0] == tuscheme$0tuscheme$1.en$RuntimeError$225) {t$14531 = ("Run-time error <at loc>: " + e$4630[1]);
} else {if (t$14530[0] == tuscheme$0tuscheme$1.en$NotFound$138) {t$14531 = (("Variable " + e$4630[1]) + " not found <at loc>");
} else {if (t$14530[0] == tuscheme$0tuscheme$1.en$TypeError$87) {t$14531 = ("type error <at loc>: " + e$4630[1]);
} else {if (t$14530[0] == tuscheme$0tuscheme$1.en$BugInTypeChecking$88) {t$14531 = ("bug in type checking: " + e$4630[1]);
} else {if (t$14530[0] == tuscheme$0tuscheme$1.en$Located$1349) {t$14531 = "internal error --- template mustn't be used";
} else {throw [tuscheme$0tuscheme$1.en$InternalError$241,"exception has handler but no template"];
};
};
};
};
};
};
};
};
};
};
t$14529 = (t$14532(t$14531,[1]));
};
t$14536(t$14529);
return v$4687;
};
try {switch (v$4686[0]) { case 0: {var v$4652 = v$4686[1];
var fd$9068 = tuscheme$0stubs$1.openIn$106(v$4652);
var v$9069 = v$4691[1];
var inter$$9070 = [1,v$9069];
return fix$14499.$readEvalPrintWith(errmsg$4561,[tuscheme$0tuscheme$1.xdefstream$3951([v$4652,tuscheme$0tuscheme$1.streamOfEffects$743(function(v$9075){return tuscheme$0stubs$1.inputLine$85(fd$9068[0],fd$9068[1]);
}),tuscheme$0tuscheme$1.noPrompts$2082]),v$4687,inter$$9070]);
 break; }case 1: {var v$4650 = v$4686[1];
(unitTests$4567[0] = [v$4650,unitTests$4567[0]],0);
return v$4687;
 break; }case 3: {var v$4646 = v$4686[1];
return tuscheme$0tuscheme$1.processDef$4211(v$4646,v$4687,v$4691);
 break; }default: {var v$4654 = v$4686[1];
var c$9080 = basis$0List$1.map$697(function(v$4653){return [3,v$4653];
},v$4654);
var fix$14538 = {};
fix$14538.$foldl = function(v$9082,v$9083){lab$foldl: while (true) {if (v$9083 == null) {return v$9082;
} else {var v$9084 = v$9083;
var v$9085 = v$9084[0];
var v$9086 = v$9084[1];
var t$14539 = fix$14518.$processXDef(v$9085,v$9082);
var t$14540 = v$9086;
var v$9082 = t$14539;
var v$9083 = t$14540;
continue lab$foldl;
};
};
};
var foldl$9081 = fix$14538.$foldl;
return foldl$9081(v$4687,c$9080);
} };
} catch(v$14537) {return (function(v$4685){var t$14541 = v$4685;
if (t$14541[0] == tuscheme$0stubs$1.en$IO_Io$64) {return caught$4627(v$4685);
} else {if (t$14541[0] == CompilerInitial.en$Div$47) {return caught$4627(v$4685);
} else {if (t$14541[0] == CompilerInitial.en$Overflow$50) {return caught$4627(v$4685);
} else {if (t$14541[0] == CompilerInitial.en$Subscript$52) {return caught$4627(v$4685);
} else {if (t$14541[0] == CompilerInitial.en$Size$53) {return caught$4627(v$4685);
} else {if (t$14541[0] == tuscheme$0tuscheme$1.en$RuntimeError$225) {return caught$4627(v$4685);
} else {if (t$14541[0] == tuscheme$0tuscheme$1.en$NotFound$138) {return caught$4627(v$4685);
} else {if (t$14541[0] == tuscheme$0tuscheme$1.en$Located$1349) {return caught$4627(v$4685);
} else {if (t$14541[0] == tuscheme$0tuscheme$1.en$TypeError$87) {return caught$4627(v$4685);
} else {if (t$14541[0] == tuscheme$0tuscheme$1.en$BugInTypeChecking$88) {return caught$4627(v$4685);
} else {throw v$4685;
};
};
};
};
};
};
};
};
};
};
})(v$14537);
};
};
var processXDef$4568 = fix$14518.$processXDef;
var basis$4688;
var fix$14519 = {};
fix$14519.$streamFold = function(z$13200,xs$13201){lab$streamFold: while (true) {var v$13202 = tuscheme$0tuscheme$1.streamGet$703(xs$13201);
switch (v$13202[0]) { case 1: {return z$13200;
 break; }default: {var v$13203 = v$13202[1];
var v$13204 = v$13203[0];
var v$13205 = v$13203[1];
var t$14520 = processXDef$4568(v$13204,z$13200);
var t$14521 = v$13205;
var z$13200 = t$14520;
var xs$13201 = t$14521;
continue lab$streamFold;
} };
};
};
var streamFold$13199 = fix$14519.$streamFold;
basis$4688 = (streamFold$13199(v$4690,v$4689));
var v$10497 = unitTests$4567[0];
var v$13677;
var t$14527;
var fix$14526 = {};
fix$14526.$foldr = function(v$13210){if (v$13210 == null) {return 0;
} else {var v$13211 = v$13210;
var v$13212 = v$13211[0];
var v$13213 = v$13211[1];
var v$13434 = fix$14526.$foldr(v$13213);
return (tuscheme$0tuscheme$1.testIsGood$4288(v$13212,basis$4688))?(SmlPrims.chk_ovf_i32(v$13434 + 1)):v$13434;
};
};
var foldr$13209 = fix$14526.$foldr;
t$14527 = (foldr$13209(v$10497));
var t$14525;
var fix$14522 = {};
fix$14522.$acc = function(v$9092,v$9093){lab$acc: while (true) {if (v$9092 == null) {return v$9093;
} else {var v$9094 = v$9092;
var v$9095 = v$9094[1];
var t$14523 = v$9095;
var t$14524 = SmlPrims.chk_ovf_i32(v$9093 + 1);
var v$9092 = t$14523;
var v$9093 = t$14524;
continue lab$acc;
};
};
};
var acc$9091 = fix$14522.$acc;
t$14525 = (acc$9091(v$10497,0));
v$13677 = [t$14527,t$14525];
tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",v$13677);
return basis$4688;
};
tuscheme$0tuscheme$1.readEvalPrintWith$4558 = fix$14499.$readEvalPrintWith;
tuscheme$0tuscheme$1.binaryOp$4692 = function(f$4695,v$4703){if (v$4703 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$4705 = v$4703;
var v$4706 = v$4705[1];
if (v$4706 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$4708 = v$4706;
if (v$4708[1] == null) {var v$4710 = v$4705[0];
var v$4711 = v$4708[0];
return f$4695([v$4710,v$4711]);
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
};
tuscheme$0tuscheme$1.unaryOp$4713 = function(f$4716,v$4722){if (v$4722 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$4724 = v$4722;
if (v$4724[1] == null) {var v$4726 = v$4724[0];
return f$4716(v$4726);
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
};
tuscheme$0tuscheme$1.arithOp$4728 = function(f$4731,v$9103){if (v$9103 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9104 = v$9103;
var v$9105 = v$9104[1];
if (v$9105 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9106 = v$9105;
if (v$9106[1] == null) {var v$9107 = v$9104[0];
var v$9108 = v$9106[0];
switch (v$9107[0]) { case 3: {switch (v$9108[0]) { case 3: {var v$13220 = v$9107[1];
var v$13221 = v$9108[1];
return [3,f$4731([v$13220,v$13221])];
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arithmetic on non-numbers"];
} };
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arithmetic on non-numbers"];
} };
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
};
tuscheme$0tuscheme$1.arithtype$4746 = [2,[[tuscheme$0tuscheme$1.inttype$2191,[tuscheme$0tuscheme$1.inttype$2191,null]],tuscheme$0tuscheme$1.inttype$2191]];
tuscheme$0tuscheme$1.comparison$4747 = function(f$4750,v$9112){if (v$9112 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9113 = v$9112;
var v$9114 = v$9113[1];
if (v$9114 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9115 = v$9114;
if (v$9115[1] == null) {var v$9116 = v$9113[0];
var v$9117 = v$9115[0];
var x$13224 = [v$9116,v$9117];
var v$13225 = f$4750(x$13224);
return [6,v$13225];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
};
tuscheme$0tuscheme$1.intcompare$4752 = function(f$4755,v$13227){if (v$13227 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13228 = v$13227;
var v$13229 = v$13228[1];
if (v$13229 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13230 = v$13229;
if (v$13230[1] == null) {var v$13231 = v$13228[0];
var v$13232 = v$13230[0];
var v$13234;
switch (v$13231[0]) { case 3: {switch (v$13232[0]) { case 3: {var v$13513 = v$13231[1];
var v$13514 = v$13232[1];
v$13234 = (f$4755([v$13513,v$13514]));
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
return [6,v$13234];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
};
tuscheme$0tuscheme$1.comptype$4770 = [2,[[tuscheme$0tuscheme$1.inttype$2191,[tuscheme$0tuscheme$1.inttype$2191,null]],tuscheme$0tuscheme$1.booltype$2192]];
tuscheme$0tuscheme$1.initialBasis$4771;
var kinds$4782;
var c$9127 = [["int",null],[["bool",null],[["sym",null],[["unit",null],[["list",[[null,null],null]],null]]]]];
var fix$14500 = {};
fix$14500.$foldl = function(v$9129,v$9130){lab$foldl: while (true) {if (v$9130 == null) {return v$9129;
} else {var v$9131 = v$9130;
var v$9132 = v$9131[0];
var v$9133 = v$9131[1];
var t$14501 = [[v$9132[0],v$9132[1]],v$9129];
var t$14502 = v$9133;
var v$9129 = t$14501;
var v$9130 = t$14502;
continue lab$foldl;
};
};
};
var foldl$9128 = fix$14500.$foldl;
kinds$4782 = (foldl$9128(tuscheme$0tuscheme$1.emptyEnv$137(0),c$9127));
var v$4825;
var b$9143 = [tuscheme$0tuscheme$1.emptyEnv$137(0),tuscheme$0tuscheme$1.emptyEnv$137(0)];
var c$9144 = [["+",function(v$13656){return tuscheme$0tuscheme$1.arithOp$4728(function(v$13678){return SmlPrims.chk_ovf_i32(v$13678[0] + v$13678[1]);
},v$13656);
},tuscheme$0tuscheme$1.arithtype$4746],[["-",function(v$13658){return tuscheme$0tuscheme$1.arithOp$4728(function(v$13679){return SmlPrims.chk_ovf_i32(v$13679[0] - v$13679[1]);
},v$13658);
},tuscheme$0tuscheme$1.arithtype$4746],[["*",function(v$13660){return tuscheme$0tuscheme$1.arithOp$4728(function(v$13680){return SmlPrims.chk_ovf_i32(v$13680[0] * v$13680[1]);
},v$13660);
},tuscheme$0tuscheme$1.arithtype$4746],[["/",function(v$13662){return tuscheme$0tuscheme$1.arithOp$4728(function(v$13681){return SmlPrims.div_i32(v$13681[0],v$13681[1],CompilerInitial.exn$Div$47);
},v$13662);
},tuscheme$0tuscheme$1.arithtype$4746],[["<",function(v$13238){if (v$13238 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13239 = v$13238;
var v$13240 = v$13239[1];
if (v$13240 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13241 = v$13240;
if (v$13241[1] == null) {var v$13242 = v$13239[0];
var v$13243 = v$13241[0];
var v$13245;
switch (v$13242[0]) { case 3: {switch (v$13243[0]) { case 3: {v$13245 = (v$13242[1] < v$13243[1]);
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
return [6,v$13245];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
},tuscheme$0tuscheme$1.comptype$4770],[[">",function(v$13248){if (v$13248 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13249 = v$13248;
var v$13250 = v$13249[1];
if (v$13250 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13251 = v$13250;
if (v$13251[1] == null) {var v$13252 = v$13249[0];
var v$13253 = v$13251[0];
var v$13255;
switch (v$13252[0]) { case 3: {switch (v$13253[0]) { case 3: {v$13255 = (v$13252[1] > v$13253[1]);
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];
} };
return [6,v$13255];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
},tuscheme$0tuscheme$1.comptype$4770],[["=",function(v$13258){if (v$13258 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13259 = v$13258;
var v$13260 = v$13259[1];
if (v$13260 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$13261 = v$13260;
if (v$13261[1] == null) {var v$13262 = v$13259[0];
var v$13263 = v$13261[0];
var v$13265;
switch (v$13262[0]) { case 4: {switch (v$13263[0]) { case 4: {v$13265 = true;
 break; }default: {v$13265 = false;
} };
 break; }case 3: {switch (v$13263[0]) { case 3: {v$13265 = (v$13262[1] == v$13263[1]);
 break; }default: {v$13265 = false;
} };
 break; }case 0: {switch (v$13263[0]) { case 0: {v$13265 = (v$13262[1] == v$13263[1]);
 break; }default: {v$13265 = false;
} };
 break; }case 6: {switch (v$13263[0]) { case 6: {v$13265 = (v$13262[1] == v$13263[1]);
 break; }default: {v$13265 = false;
} };
 break; }default: {v$13265 = false;
} };
return [6,v$13265];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,[tuscheme$0tuscheme$1.tyvarA$2195,null]],tuscheme$0tuscheme$1.booltype$2192]]]]],[["null?",function(v$9174){if (v$9174 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9175 = v$9174;
if (v$9175[1] == null) {var v$9176 = v$9175[0];
var v$13271;
switch (v$9176[0]) { case 4: {v$13271 = true;
 break; }default: {v$13271 = false;
} };
return [6,v$13271];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[3,[["'a",null],[2,[[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],tuscheme$0tuscheme$1.booltype$2192]]]]],[["cons",function(v$9183){if (v$9183 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9184 = v$9183;
var v$9185 = v$9184[1];
if (v$9185 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
} else {var v$9186 = v$9185;
if (v$9186[1] == null) {return [2,[v$9184[0],v$9186[0]]];
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];
};
};
};
},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null]],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]]]]]]],[["car",function(v$9192){if (v$9192 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9193 = v$9192;
if (v$9193[1] == null) {var v$9194 = v$9193[0];
switch (v$9194[0]) { case 2: {return v$9194[1][0];
 break; }default: {throw [tuscheme$0tuscheme$1.en$RuntimeError$225,"car applied to non-list " + (tuscheme$0tuscheme$1.valueString$2459(v$9194))];
} };
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[3,[["'a",null],[2,[[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],tuscheme$0tuscheme$1.tyvarA$2195]]]]],[["cdr",function(v$9198){if (v$9198 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9199 = v$9198;
if (v$9199[1] == null) {var v$9200 = v$9199[0];
switch (v$9200[0]) { case 2: {return v$9200[1][1];
 break; }default: {throw [tuscheme$0tuscheme$1.en$RuntimeError$225,"cdr applied to non-list " + (tuscheme$0tuscheme$1.valueString$2459(v$9200))];
} };
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[3,[["'a",null],[2,[[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]]]]]]],[["println",function(v$9205){if (v$9205 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9206 = v$9205;
if (v$9206[1] == null) {var v$9207 = v$9206[0];
tuscheme$0stubs$1.print$119((tuscheme$0tuscheme$1.valueString$2459(v$9207)) + "\n");
return tuscheme$0tuscheme$1.unitVal$2641;
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,null],tuscheme$0tuscheme$1.unittype$2194]]]]],[["print",function(v$9210){if (v$9210 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9211 = v$9210;
if (v$9211[1] == null) {var v$9212 = v$9211[0];
tuscheme$0stubs$1.print$119(tuscheme$0tuscheme$1.valueString$2459(v$9212));
return tuscheme$0tuscheme$1.unitVal$2641;
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,null],tuscheme$0tuscheme$1.unittype$2194]]]]],[["printu",function(v$9214){if (v$9214 == null) {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
} else {var v$9215 = v$9214;
if (v$9215[1] == null) {var v$9216 = v$9215[0];
switch (v$9216[0]) { case 3: {var v$13278 = v$9216[1];
tuscheme$0tuscheme$1.printUTF8$416(v$13278);
return tuscheme$0tuscheme$1.unitVal$2641;
 break; }default: {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"printu of non-number"];
} };
} else {throw [tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];
};
};
},[2,[[tuscheme$0tuscheme$1.inttype$2191,null],tuscheme$0tuscheme$1.unittype$2194]]],null]]]]]]]]]]]]]];
var fix$14503 = {};
fix$14503.$foldl = function(v$9146,v$9147){lab$foldl: while (true) {if (v$9147 == null) {return v$9146;
} else {var v$9148 = v$9147;
var v$9149 = v$9148[0];
var v$9150 = v$9148[1];
var t$14504;
var v$13281 = v$9149[0];
var v$13282 = v$9149[1];
var v$13283 = v$9149[2];
var v$13285 = v$9146[0];
var v$13286 = v$9146[1];
t$14504 = [[[v$13281,v$13283],v$13285],[[v$13281,[[1,v$13282]]],v$13286]];
var t$14505 = t$14504;
var t$14506 = v$9150;
var v$9146 = t$14505;
var v$9147 = t$14506;
continue lab$foldl;
};
};
};
var foldl$9145 = fix$14503.$foldl;
v$4825 = (foldl$9145(b$9143,c$9144));
var v$4826 = v$4825[0];
var v$4827 = v$4825[1];
var v$4822;
var b$9220 = [v$4826,v$4827];
var c$9221 = null;
var fix$14507 = {};
fix$14507.$foldl = function(v$9223,v$9224){lab$foldl: while (true) {if (v$9224 == null) {return v$9223;
} else {var v$9225 = v$9224;
var v$9226 = v$9225[0];
var v$9227 = v$9225[1];
var t$14508;
var v$13289 = v$9226[0];
var v$13290 = v$9226[1];
var v$13291 = v$9226[2];
var v$13293 = v$9223[0];
var v$13294 = v$9223[1];
t$14508 = [[[v$13289,v$13291],v$13293],[[v$13289,[v$13290]],v$13294]];
var t$14509 = t$14508;
var t$14510 = v$9227;
var v$9223 = t$14509;
var v$9224 = t$14510;
continue lab$foldl;
};
};
};
var foldl$9222 = fix$14507.$foldl;
v$4822 = (foldl$9222(b$9220,c$9221));
var v$4823 = v$4822[0];
var v$4824 = v$4822[1];
var primBasis$4819 = [kinds$4782,v$4823,v$4824];
var fundefs$4820 = ["(val list1 (type-lambda ['a] (lambda ([x : 'a]) ((@ cons 'a) x (@ '() 'a)))))",["(val list2 (type-lambda ['a] (lambda ([x : 'a] [y : 'a])",["                               ((@ cons 'a) x ((@ list1 'a) y)))))",["(val list3 (type-lambda ['a] (lambda ([x : 'a] [y : 'a] [z : 'a])",["                               ((@ cons 'a) x ((@ list2 'a) y z)))))",["(val o (type-lambda ['a 'b 'c]",["  (lambda ([f : ('b -> 'c)]",["           [g : ('a -> 'b)])",["     (lambda ([x : 'a]) (f (g x))))))",["",["(val curry (type-lambda ['a 'b 'c]",["   (lambda ([f : ('a 'b -> 'c)])",["      (lambda ([x : 'a]) (lambda ([y : 'b]) (f x y))))))",["",["(val uncurry (type-lambda ['a 'b 'c]",["   (lambda ([f : ('a -> ('b -> 'c))])",["      (lambda ([x : 'a] [y : 'b]) ((f x) y)))))",["(val-rec",["  (forall ('a) ((list 'a) -> int))  ; type of thing being defined",["  length                            ; name of thing being defined",["  (type-lambda ['a]                 ; value of thing: a polymorphic function",["     (lambda ([xs : (list 'a)])",["       (if ((@ null? 'a) xs) 0",["          (+ 1 ((@ length 'a) ((@ cdr 'a) xs)))))))",["(val-rec ",["  (forall ('a) ((list 'a) (list 'a) -> (list 'a)))",["  revapp",["  (type-lambda ['a]",["     (lambda ([xs : (list 'a)] [ys : (list 'a)])",["        (if ((@ null? 'a) xs)",["        ys",["        ((@ revapp 'a) ((@ cdr 'a) xs) ((@ cons 'a) ((@ car 'a) xs) ys))))))",["(val caar",["   (type-lambda ('a)",["      (lambda ([xs : (list (list 'a))])",["          ((@ car 'a) ((@ car (list 'a)) xs)))))",["(val cadr",["   (type-lambda ('a)",["      (lambda ([xs : (list (list 'a))])",["          ((@ car (list 'a)) ((@ cdr (list 'a)) xs)))))",["(define bool and ([b : bool] [c : bool]) (if b  c  b))",["(define bool or  ([b : bool] [c : bool]) (if b  b  c))",["(define bool not ([b : bool])            (if b #f #t))",["(val-rec (forall ('a) ((list 'a) (list 'a) -> (list 'a))) append",["  (type-lambda ('a)",["     (lambda ([xs : (list 'a)] [ys : (list 'a)])",["       (if ((@ null? 'a) xs)",["         ys",["         ((@ cons 'a) ((@ car 'a) xs) ((@ append 'a) ((@ cdr 'a) xs) ys))))))",["(val-rec (forall ('a) (('a -> bool) (list 'a) -> (list 'a))) filter",["   (type-lambda ('a)",["      (lambda ([p? : ('a -> bool)] [xs : (list 'a)])",["         (if ((@ null? 'a) xs)",["             (@ '() 'a)",["             (if (p? ((@ car 'a) xs))",["                 ((@ cons 'a) ((@ car 'a) xs) ((@ filter 'a) p? ((@ cdr 'a) xs)))",["                 ((@ filter 'a) p? ((@ cdr 'a) xs)))))))",["(val-rec (forall ('a 'b) (('a -> 'b) (list 'a) -> (list 'b))) map",["   (type-lambda ('a 'b)",["      (lambda ([f : ('a -> 'b)] [xs : (list 'a)])",["         (if ((@ null? 'a) xs)",["             (@ '() 'b)",["             ((@ cons 'b) (f ((@ car 'a) xs)) ((@ map 'a 'b) f ((@ cdr 'a) xs)))))))",["(define bool <= ([x : int] [y : int]) (not (> x y)))",["(define bool >= ([x : int] [y : int]) (not (< x y)))",["(val != (type-lambda ('a) (lambda ([x : 'a] [y : 'a]) (not ((@ = 'a) x y)))))",["(define int max ([m : int] [n : int]) (if (> m n) m n))",["(define int min ([m : int] [n : int]) (if (< m n) m n))",["(define int mod ([m : int] [n : int]) (- m (* n (/ m n))))",["(define int gcd ([m : int] [n : int]) (if ((@ = int) n 0) m (gcd n (mod m n))))",["(define int lcm ([m : int] [n : int]) (* m (/ n (gcd m n))))",null]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]];
var xdefs$4821;
var t$14515 = tuscheme$0tuscheme$1.xdefstream$3951;
var t$14514;
var t$14513 = "predefined functions";
var t$14511;
var b$9242 = [1];
var fix$14512 = {};
fix$14512.$foldr = function(v$9244){if (v$9244 == null) {return b$9242;
} else {var v$9245 = v$9244;
var v$9246 = v$9245[0];
var v$9247 = v$9245[1];
var v$9248 = [v$9246,fix$14512.$foldr(v$9247)];
return [2,v$9248];
};
};
var foldr$9243 = fix$14512.$foldr;
t$14511 = (foldr$9243(fundefs$4820));
t$14514 = [t$14513,t$14511,tuscheme$0tuscheme$1.noPrompts$2082];
xdefs$4821 = (t$14515(t$14514));
tuscheme$0tuscheme$1.initialBasis$4771 = (tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(s$9249){var s$9250 = "while reading predefined functions, " + s$9249;
tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$9250);
return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
},[xdefs$4821,primBasis$4819,tuscheme$0tuscheme$1.noninteractive$547]));
tuscheme$0tuscheme$1.runAs$4883 = function(interactivity$4886){var t$14516;
switch (interactivity$4886[0]) { case 0: {t$14516 = true;
 break; }default: {t$14516 = false;
} };
t$14516?[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0),(basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC")))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0):0][0]:[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 0,0),(basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC")))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0] = 1,0):0][0];
var prompts$4887;
var t$14517;
switch (interactivity$4886[0]) { case 0: {t$14517 = true;
 break; }default: {t$14517 = false;
} };
prompts$4887 = (t$14517?tuscheme$0tuscheme$1.stdPrompts$2081:tuscheme$0tuscheme$1.noPrompts$2082);
var xdefs$4892 = tuscheme$0tuscheme$1.xdefstream$3951(["standard input",tuscheme$0tuscheme$1.streamOfEffects$743(function(v$9258){return tuscheme$0stubs$1.inputLine$85(tuscheme$0stubs$1.stdIn$118[0],tuscheme$0stubs$1.stdIn$118[1]);
}),prompts$4887]);
tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(s$9260){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,s$9260);
return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");
},[xdefs$4892,tuscheme$0tuscheme$1.initialBasis$4771,interactivity$4886]);
return 0;
};
return 0;
})();
