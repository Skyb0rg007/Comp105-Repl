/* eslint-disable */
// Exported functions/values
let tuscheme_filemap = new Map(),
    tuscheme_eval = null,
    tuscheme_reset = null;

// These are global variables referenced by the compiled code.
// Maybe these can be determined programatically.
let CompilerInitial,
    Con,
    SMLtoJs,
    SmlPrims,
    basis$0Array$1$3,
    basis$0Initial$1,
    basis$0General$1,
    basis$0List$1,
    basis$0ListPair$1,
    basis$0StringCvt$1,
    basis$0StrBase$1,
    basis$0Char$1,
    basis$0String$1,
    basis$0IntInfRep$1,
    // basis$0IO$1,
    basis$0Substring$1,
    basis$0Int32$1,
    js$0JsCore$1,
    js$0Js$1,
    tuscheme$0JsMap$1,
    tuscheme$0stubs$1,
    tuscheme$0tuscheme$1,
    tuscheme$0run$1
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var a=0;a<b.length;++a){var c=b[a];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},a=Object.create(new $jscomp.global.Proxy(b,{get:function(c,d,f){return c==b&&"q"==d&&f==a}}));return!0===a.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(b,a){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(c){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+a++,c)}var a=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in c||(c[f]={});c=c[f]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("WeakMap",function(b){function a(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),d=new b([[a,2],[c,3]]);if(2!=d.get(a)||3!=d.get(c))return!1;d.delete(a);d.set(c,4);return!d.has(a)&&4==d.get(c)}catch(D){return!1}}function c(){}function d(a){var c=typeof a;return"object"===c&&null!==a||"function"===c}function f(a){if(!$jscomp.owns(a,k)){var b=new c;$jscomp.defineProperty(a,k,{value:b})}}function g(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
c)return a;f(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(a())return b;var k="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var q=0,l=function(a){this.id_=(q+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};l.prototype.set=function(a,c){if(!d(a))throw Error("Invalid WeakMap key");f(a);if(!$jscomp.owns(a,k))throw Error("WeakMap key fail: "+
a);a[k][this.id_]=c;return this};l.prototype.get=function(a){return d(a)&&$jscomp.owns(a,k)?a[k][this.id_]:void 0};l.prototype.has=function(a){return d(a)&&$jscomp.owns(a,k)&&$jscomp.owns(a[k],this.id_)};l.prototype.delete=function(a){return d(a)&&$jscomp.owns(a,k)&&$jscomp.owns(a[k],this.id_)?delete a[k][this.id_]:!1};return l},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function a(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),f=d.next();if(f.done||f.value[0]!=a||"s"!=f.value[1])return!1;f=d.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!d.next().done?!1:!0}catch(D){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(a())return b;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=k();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};d.prototype.set=function(a,c){a=0===a?0:a;var b=f(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=c:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};d.prototype.delete=function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=k();this.size=0};d.prototype.has=function(a){return!!f(this,a).entry};
d.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};d.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return g(this,function(a){return a.key})};d.prototype.values=function(){return g(this,function(a){return a.value})};d.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(c,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var f=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++q,c.set(b,d)):d="p_"+b;var f=a.data_[d];if(f&&$jscomp.owns(a.data_,d))for(a=0;a<f.length;a++){var g=f[a];if(b!==b&&g.key!==g.key||b===g.key)return{id:d,list:f,index:a,entry:g}}return{id:d,list:f,index:-1,entry:void 0}},g=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},k=function(){var a={};return a.previous=
a.next=a.head=a},q=0;return d},"es6","es3");CompilerInitial={};CompilerInitial.en$Bind$49=new String("Bind");CompilerInitial.exn$Bind$49=Array(CompilerInitial.en$Bind$49);CompilerInitial.en$Match$48=new String("Match");CompilerInitial.exn$Match$48=Array(CompilerInitial.en$Match$48);CompilerInitial.en$Div$47=new String("Div");CompilerInitial.exn$Div$47=Array(CompilerInitial.en$Div$47);CompilerInitial.en$Interrupt=new String("Interrupt");CompilerInitial.exn$Interrupt=Array(CompilerInitial.en$Interrupt);
CompilerInitial.en$Overflow$50=new String("Overflow");CompilerInitial.exn$Overflow$50=Array(CompilerInitial.en$Overflow$50);CompilerInitial.en$Subscript$52=new String("Subscript");CompilerInitial.exn$Subscript$52=Array(CompilerInitial.en$Subscript$52);CompilerInitial.en$Size$53=new String("Size");CompilerInitial.exn$Size$53=Array(CompilerInitial.en$Size$53);Con={some:0,none:1,intinf:0};SMLtoJs={};
SmlPrims={option:function(b){return b?[Con.some,b]:[Con.none]},explode:function(b){var a,c=null;for(a=b.length;0<a;a--)c=[b.charCodeAt(a-1),c];return c},implode:function(b){var a,c=[];for(a=0;null!=b;b=b[1],a++)c[a]=String.fromCharCode(b[0]);return c.join("")},charsToCharArray:function(b){var a,c=[];for(a=0;null!=b;b=b[1],a++)c[a]=b[0];return c},listToArray:function(b){var a,c=[];for(a=0;null!=b;b=b[1],a++)c[a]=b[0];return c},charArraysConcat:function(b){var a,c=[];for(a=0;null!=b;b=b[1],a++)c=Array.concat(c,
b[0]);return c},concat:function(b){var a,c=[];for(a=0;null!=b;b=b[1],a++)c[a]=b[0];return c.join("")},length:function len(b){return null==b?0:1+len(b[1])},arrayMap:function(b){return function(a){var c,d=Array(a.length);for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}},charArrayToString:function(b){return SmlPrims.arrayMap(String.fromCharCode)(b).join("")},real_to_bytes:function(b){var a=new ArrayBuffer(8);(new Float64Array(a,0,1))[0]=b;b=new Uint8Array(a,0,8);return SmlPrims.arrayMap(String.fromCharCode)(b).join("")},
bytes_to_real:function(b){var a=new ArrayBuffer(8),c=new Uint8Array(a,0,8),d;for(d=0;8>d&&d<b.length;d++)c[d]=b.charCodeAt(d);return(new Float64Array(a,0,1))[0]},wordTableInit:function(b,a){var c,d=Array(b);for(c=0;c<b;c++)d[c]=a;return d},chk_ovf_i32:function(b){if(-2147483648>b||2147483647<b)throw CompilerInitial.exn$Overflow$50;return b},chk_ovf_i31:function(b){if(-1073741824>b||1073741823<b)throw CompilerInitial.exn$Overflow$50;return b},cut_w32:function(b){return b&4294967295},cut_w31:function(b){return b&
2147483647},mod_i32:function(b,a,c){if(0==a)throw c;return 0<b&&0<a||0>b&&0>a||0==b%a?b%a:b%a+a},div_i32:function(b,a,c){if(0==a)throw c;if(-1==a&&-2147483648==b)throw CompilerInitial.exn$Overflow$50;return Math.floor(b/a)},mod_i31:function(b,a,c){if(0==a)throw c;return 0<b&&0<a||0>b&&0>a||0==b%a?b%a:b%a+a},div_i31:function(b,a,c){if(0==a)throw c;if(-1==a&&-1073741824==b)throw CompilerInitial.exn$Overflow$50;return Math.floor(b/a)},div_w31:function(b,a,c){if(0==a)throw c;return Math.floor(b/a)},div_w32:function(b,
a,c){if(0==a)throw c;return Math.floor(b/a)},mod_w31:function(b,a,c){if(0==a)throw c;return b%a},mod_w32:function(b,a,c){if(0==a)throw c;return b%a},quot:function(b,a){return 0>b&&0<=a||0<=b&&0>a?Math.ceil(b/a):Math.floor(b/a)},w32_to_i32_X:function(b){return 2147483647<b?-(4294967295-b)-1:b},w31_to_i32_X:function(b){return 1073741823<b?-(2147483647-b)-1:b},w31_to_w32_X:function(b){return 1073741823<b?b&1073741823|-2147483648:b},i32_to_w32:function(b){return 0>b?4294967295- -b+1:b},i32_to_w31:function(b){return 0>
b?SmlPrims.cut_w31(4294967295- -b+1):SmlPrims.cut_w31(b)},sinh:function(b){b=Math.exp(b);return(b-1/b)/2},cosh:function(b){b=Math.exp(b);return(b+1/b)/2},tanh:function(b){b=Math.exp(b);return(b-1/b)/(b+1/b)},trunc:function(b){return 0<=b?Math.floor(b):Math.ceil(b)},getrealtime:function(){var b=(new Date).getTime(),a=b%1E3*1E3;return[SmlPrims.chk_ovf_i32(Math.floor(b/1E3)+-2147483648),SmlPrims.chk_ovf_i32(a)]},monthDays:function(b,a){switch(a){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;
case 1:return 0!=b%4||0==b%100&&0!=b%400?28:29;default:return 30}},yearDays:function(b,a,c){--c;var d;for(d=0;d<a;d++)c+=SmlPrims.monthDays(b,d);return c},localtime:function(b){var a=new Date(1E3*b);b=a.getHours();var c=a.getMinutes(),d=a.getFullYear(),f=a.getDate(),g=a.getDay(),k=a.getMonth(),q=SmlPrims.yearDays(d,k,f);a=a.getSeconds();return[b,-1,f,c,k,a,g,q,d]},gmtime:function(b){var a=new Date(1E3*b);b=a.getUTCHours();var c=a.getUTCMinutes(),d=a.getUTCFullYear(),f=a.getUTCDate(),g=a.getUTCDay(),
k=a.getUTCMonth(),q=SmlPrims.yearDays(d,k,f);a=a.getUTCSeconds();return[b,-1,f,c,k,a,g,q,d]},mktime:function(b){b=(new Date(b[8],b[4],b[2],b[0],b[3],b[5],0)).getTime();return Math.floor(b/1E3)},localoffset:function(){return 60*(new Date).getTimezoneOffset()},_factories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],_factory:null,newRequest:function(){if(null!=SmlPrims._factory)return SmlPrims._factory();
for(var b=0;b<SmlPrims._factories.length;b++)try{var a=SmlPrims._factories[b],c=a();if(null!=c)return SmlPrims._factory=a,c}catch(d){}SmlPrims._factory=function(){throw Error("SmlPrims.newRequest not supported by browser");};SmlPrims._factory()},arraybufferToString:function(b){if(null==b)return null;b=new Uint8Array(b);for(var a=[],c=0;65535*c<b.length;c++)a.push(String.fromCharCode.apply(null,b.subarray(65535*c,65535*(c+1))));return a.join("")},stringToArrayBuffer:function(b){for(var a=new ArrayBuffer(b.length),
c=new Uint8Array(a),d=0;d<c.length;d++)c[d]=b.charCodeAt(d);return a}};"undefined"==typeof basis$0Initial$1&&(basis$0Initial$1={});
(function(){basis$0Initial$1.en$Fail$54=new String("Fail");basis$0Initial$1.posInf$61=Infinity;basis$0Initial$1.negInf$62=-Infinity;basis$0Initial$1.ln10$71=Math.log(10);basis$0Initial$1.NaN$72=Math.sqrt(-1);basis$0Initial$1.localoffset$76=SmlPrims.localoffset();basis$0Initial$1.fail_strftime$77=[basis$0Initial$1.en$Fail$54,"strftime"];basis$0Initial$1.initial_realtime$81=SmlPrims.getrealtime();basis$0Initial$1.initial_rutime$82=[0,0,0,0,0,0];var b=[function(a){return document.write(a)}];basis$0Initial$1.printer_set$98=
function(a){return b[0]=a,0};basis$0Initial$1.printer_get$102=function(a){return b[0]};return 0})();"undefined"==typeof basis$0General$1&&(basis$0General$1={});
(function(){basis$0General$1.eq_order$254=function(b,a){switch(b){case 0:switch(a){case 0:return!0;default:return!1}case 1:switch(a){case 1:return!0;default:return!1}case 2:switch(a){case 2:return!0;default:return!1}}};basis$0General$1.eq_option$258=function(b,a){var c=a[0];a=a[1];switch(c[0]){case 0:switch(a[0]){case 0:return b([c[1],a[1]]);default:return!1}case 1:switch(a[0]){case 1:return!0;default:return!1}}};basis$0General$1.en$Span$60=new String("Span");basis$0General$1.exn$Span$60=[basis$0General$1.en$Span$60];
basis$0General$1.en$Domain$61=new String("Domain");basis$0General$1.exn$Domain$61=[basis$0General$1.en$Domain$61];basis$0General$1.en$Chr$62=new String("Chr");basis$0General$1.exn$Chr$62=[basis$0General$1.en$Chr$62];basis$0General$1.exnName$63=function(b){return b[0]};basis$0General$1.exnMessage$67=function(b){return b[0]};basis$0General$1.s$a$74=function(b){return b[0]};basis$0General$1.s$ik$78=function(b,a){return b[0]=a,0};basis$0General$1.o$85=function(b,a){return function(c){return b(a(c))}};
basis$0General$1.before$95=function(b,a){return b};basis$0General$1.ignore$100=function(b){return 0};basis$0General$1.en$Option$106=new String("Option");basis$0General$1.exn$Option$106=[basis$0General$1.en$Option$106];basis$0General$1.getOpt$107=function(b,a){switch(b[0]){case 1:return a;default:return b[1]}};basis$0General$1.isSome$122=function(b){switch(b[0]){case 1:return!1;default:return!0}};basis$0General$1.valOf$130=function(b){switch(b[0]){case 0:return b[1];default:throw basis$0General$1.exn$Option$106;
}};basis$0General$1.s$k$141=function(b,a){return b([a[0],a[1]])};basis$0General$1.not$148=function(b){return b?!1:!0};basis$0General$1.s$jl$156=function(b,a){return b([a[0],a[1]])?!1:!0};basis$0General$1.print$163=function(b){return basis$0Initial$1.printer_get$102(0)(b)};basis$0General$1.implode$167=function(b){return SmlPrims.implode(b)};basis$0General$1.concat$171=function(b){return SmlPrims.concat(b)};basis$0General$1.s$r$175=function(b,a){return b+a};basis$0General$1.str$182=function(b){return SmlPrims.implode([b,
null])};basis$0General$1.size$186=function(b){return b.length};basis$0General$1.ord$190=function(b){return b};basis$0General$1.chr$194=function(b){if(0<=b&&256>b)return b;throw basis$0General$1.exn$Chr$62;};basis$0General$1.explode$213=function(b){a:{var a=SmlPrims.chk_ovf_i32(b.length-1),c=null;for(;;){if(0>a)break a;var d=SmlPrims.chk_ovf_i32(a-1);c=[b.charCodeAt(a),c];a=d}}return c};return 0})();"undefined"==typeof basis$0List$1&&(basis$0List$1={});
(function(){basis$0List$1.en$Empty$55=new String("Empty");basis$0List$1.exn$Empty$55=[basis$0List$1.en$Empty$55];basis$0List$1.null$56=function(a){return null==a?!0:!1};basis$0List$1.hd$64=function(a){if(null==a)throw basis$0List$1.exn$Empty$55;return a[0]};basis$0List$1.tl$77=function(a){if(null==a)throw basis$0List$1.exn$Empty$55;return a[1]};basis$0List$1.last$90=function(a){for(;;){if(null==a)throw basis$0List$1.exn$Empty$55;var c=a[1];if(null==c)return a[0];a=c}};basis$0List$1.nth$107=function(a,
c){if(0>c)throw CompilerInitial.exn$Subscript$52;a:for(;;){if(null==a)throw CompilerInitial.exn$Subscript$52;var b=a[0];if(0==c)break a;a=a[1];c=SmlPrims.chk_ovf_i32(c-1)}return b};basis$0List$1.drop$141=function(a,c){if(0>c)throw CompilerInitial.exn$Subscript$52;a:for(;;)switch(c){case 0:break a;default:if(null==a)throw CompilerInitial.exn$Subscript$52;a=a[1];c=SmlPrims.chk_ovf_i32(c-1)}return a};basis$0List$1.take$176=function(a,c){var b={$h:function(a,c){switch(c){case 0:return null;default:if(null==
a)throw CompilerInitial.exn$Subscript$52;return[a[0],b.$h(a[1],SmlPrims.chk_ovf_i32(c-1))]}}},d=b.$h;if(0>c)throw CompilerInitial.exn$Subscript$52;return d(a,c)};basis$0List$1.length$211=function(a){a:{var c=0;for(;;){if(null==a)break a;a=a[1];c=SmlPrims.chk_ovf_i32(c+1)}}return c};var b=function(a,c){for(;;){if(null==a)return c;c=[a[0],c];a=a[1]}};basis$0List$1.rev$257=function(a){return b(a,null)};basis$0List$1.revAppend$261=function(a,c){return b(a,c)};basis$0List$1.s$n$268=function(a,c){a:for(a=
b(a,null);;){if(null==a)break a;c=[a[0],c];a=a[1]}return c};var a={$concat:function(c){if(null==c)return null;var d=c[0];c=a.$concat(c[1]);a:for(d=b(d,null);;){if(null==d)break a;c=[d[0],c];d=d[1]}return c}};basis$0List$1.concat$296=a.$concat;basis$0List$1.app$309=function(a,c){for(;;){if(null==c)return 0;var b=c[1];a(c[0]);c=b}};basis$0List$1.map$332=function(a,c){a:{var d=c;c=null;for(;;){if(null==d)break a;var f=d;d=f[1];c=[a(f[0]),c]}}return b(c,null)};basis$0List$1.mapPartial$357=function(a,
c){a:{var d=null;b:for(;;){if(null==c)break a;var f=c;c=f[1];f=a(f[0]);switch(f[0]){case 0:d=[f[1],d];continue b}}}return b(d,null)};basis$0List$1.find$392=function(a,c){for(;;){if(null==c)return[1];var b=c;c=b[0];b=b[1];if(a(c))return[0,c];c=b}};basis$0List$1.filter$417=function(a,c){a:{var d=null;for(;;){if(null==c)break a;var f=c;c=f[0];f=f[1];a(c)?(d=[c,d],c=f):c=f}}return b(d,null)};basis$0List$1.partition$449=function(a,c){a:{var d=c,f=c=null;for(;;){if(null==d){a=[b(c,null),b(f,null)];break a}var q=
d[0];d=d[1];a(q)?c=[q,c]:f=[q,f]}}return a};var c={$foldr:function(a,b,g){return null==g?b:a([g[0],c.$foldr(a,b,g[1])])}};basis$0List$1.foldr$488=c.$foldr;basis$0List$1.foldl$516=function(a,c,b){for(;;){if(null==b)return c;var d=b,f=d[1];b=a;c=a([d[0],c]);a=b;b=f}};basis$0List$1.exists$544=function(a,c){for(;;){if(null==c)return!1;var b=c[1];if(a(c[0]))return!0;c=b}};basis$0List$1.all$569=function(a,c){for(;;){if(null==c)return!0;var b=c[1];if(a(c[0]))c=b;else return!1}};basis$0List$1.tabulate$594=
function(a,c){if(0>a)throw CompilerInitial.exn$Size$53;a:{var d=0,f=null;for(;;)if(d<a){var q=SmlPrims.chk_ovf_i32(d+1);f=[c(d),f];d=q}else break a}return b(f,null)};basis$0List$1.getItem$616=function(a){return null==a?[1]:[0,[a[0],a[1]]]};basis$0List$1.collate$629=function(a,c){a:for(;;){var b=c[0];if(null==b)return null==c[1]?2:0;var d=c[1];if(null==d)return 1;c=b[1];var f=d[1];switch(a([b[0],d[0]])){case 2:c=[c,f];continue a;case 1:return 1;default:return 0}}};basis$0List$1.null$672=function(a){return null==
a?!0:!1};basis$0List$1.hd$676=function(a){if(null==a)throw basis$0List$1.exn$Empty$55;return a[0]};basis$0List$1.tl$677=function(a){if(null==a)throw basis$0List$1.exn$Empty$55;return a[1]};basis$0List$1.length$678=function(a){a:{var c=0;for(;;){if(null==a)break a;a=a[1];c=SmlPrims.chk_ovf_i32(c+1)}}return c};basis$0List$1.rev$682=function(a){return b(a,null)};basis$0List$1.s$n$686=function(a,c){a:for(a=b(a,null);;){if(null==a)break a;c=[a[0],c];a=a[1]}return c};basis$0List$1.app$690=function(a,c){a:for(;;){if(null==
c)break a;var b=c[1];a(c[0]);c=b}return 0};basis$0List$1.map$697=function(a,c){a:{var d=c;c=null;for(;;){if(null==d)break a;var f=d;d=f[1];c=[a(f[0]),c]}}return b(c,null)};basis$0List$1.foldr$704=function(a,c,b){var d={$foldr:function(b){return null==b?c:a([b[0],d.$foldr(b[1])])}},f=d.$foldr;return f(b)};basis$0List$1.foldl$714=function(a,c,b){a:for(;;){if(null==b)break a;var d=b;b=d[1];c=a([d[0],c])}return c};return 0})();"undefined"==typeof basis$0ListPair$1&&(basis$0ListPair$1={});
(function(){basis$0ListPair$1.en$UnequalLengths$54=new String("UnequalLengths");basis$0ListPair$1.exn$UnequalLengths$54=[basis$0ListPair$1.en$UnequalLengths$54];basis$0ListPair$1.zip$55=function(b,a){a:{var c=a;a=null;for(;;){if(null==b||null==c){b=basis$0List$1.rev$257(a);break a}var d=c;c=d[1];a=[[b[0],d[0]],a];b=b[1]}}return b};basis$0ListPair$1.zipEq$96=function(b,a){a:{var c=a;a=null;for(;;){if(null==b){if(null==c){b=basis$0List$1.rev$257(a);break a}throw basis$0ListPair$1.exn$UnequalLengths$54;
}if(null==c)throw basis$0ListPair$1.exn$UnequalLengths$54;var d=c;c=d[1];a=[[b[0],d[0]],a];b=b[1]}}return b};basis$0ListPair$1.unzip$140=function(b){a:{var a=b,c=b=null;for(;;){if(null==a){b=[basis$0List$1.rev$257(b),basis$0List$1.rev$257(c)];break a}var d=a[0];b=[d[0],b];c=[d[1],c];a=a[1]}}return b};basis$0ListPair$1.map$169=function(b,a){a:{var c=a[0],d=a[1];a=null;for(;;){if(null==c||null==d){b=basis$0List$1.rev$257(a);break a}var f=d,g=c[1];d=f[1];a=[b([c[0],f[0]]),a];c=g}}return b};basis$0ListPair$1.mapEq$213=
function(b,a){a:{var c=a[0],d=a[1];a=null;for(;;){if(null==c){if(null==d){b=basis$0List$1.rev$257(a);break a}throw basis$0ListPair$1.exn$UnequalLengths$54;}if(null==d)throw basis$0ListPair$1.exn$UnequalLengths$54;var f=d,g=c[1];d=f[1];a=[b([c[0],f[0]]),a];c=g}}return b};basis$0ListPair$1.app$262=function(b,a){a:{var c=a[0],d=a[1];for(;;){if(null==c||null==d)break a;a=c;c=a[1];var f=d[1];b([a[0],d[0]]);d=a=f}}return 0};basis$0ListPair$1.appEq$301=function(b,a){a:{var c=a[0],d=a[1];for(;;){if(null==
c){if(null==d)break a;throw basis$0ListPair$1.exn$UnequalLengths$54;}if(null==d)throw basis$0ListPair$1.exn$UnequalLengths$54;a=c;c=a[1];var f=d[1];b([a[0],d[0]]);d=a=f}}return 0};basis$0ListPair$1.all$343=function(b,a){a:{var c=a[0],d=a[1];for(;;){if(null==c||null==d){b=!0;break a}a=c;c=a[1];var f=d[1];if(b([a[0],d[0]]))d=a=f;else{b=!1;break a}}}return b};basis$0ListPair$1.allEq$384=function(b,a){return function(a,d){for(;;){if(null==a)return null==d?!0:!1;if(null==d)return!1;var c=a;a=c[1];var g=
d[1];if(b([c[0],d[0]]))d=c=g;else return!1}}(a[0],a[1])};basis$0ListPair$1.exists$428=function(b,a){a:{var c=a[0],d=a[1];for(;;){if(null==c||null==d){b=!1;break a}a=c;c=a[1];var f=d[1];if(b([a[0],d[0]])){b=!0;break a}d=a=f}}return b};basis$0ListPair$1.foldr$469=function(b,a,c){var d={$h:function(c,f){return null==c||null==f?a:b([c[0],f[0],d.$h(c[1],f[1])])}},f=d.$h;return f(c[0],c[1])};basis$0ListPair$1.foldrEq$509=function(b,a,c){var d={$h:function(c,f){if(null==c){if(null==f)return a;throw basis$0ListPair$1.exn$UnequalLengths$54;
}if(null==f)throw basis$0ListPair$1.exn$UnequalLengths$54;return b([c[0],f[0],d.$h(c[1],f[1])])}},f=d.$h;return f(c[0],c[1])};basis$0ListPair$1.foldl$552=function(b,a,c){a:{var d=c[0];c=c[1];for(;;){if(null==d||null==c)break a;var f=d;d=f[1];var g=c;c=g[1];a=b([f[0],g[0],a])}}return a};basis$0ListPair$1.foldlEq$599=function(b,a,c){a:{var d=c[0];c=c[1];for(;;){if(null==d){if(null==c)break a;throw basis$0ListPair$1.exn$UnequalLengths$54;}if(null==c)throw basis$0ListPair$1.exn$UnequalLengths$54;var f=
d;d=f[1];var g=c;c=g[1];a=b([f[0],g[0],a])}}return a};return 0})();"undefined"==typeof basis$0StringCvt$1&&(basis$0StringCvt$1={});
(function(){basis$0StringCvt$1.eq_radix$306=function(b,a){switch(b){case 0:switch(a){case 0:return!0;default:return!1}case 1:switch(a){case 1:return!0;default:return!1}case 2:switch(a){case 2:return!0;default:return!1}case 3:switch(a){case 3:return!0;default:return!1}}};basis$0StringCvt$1.eq_realfmt$310=function(b,a){switch(b[0]){case 0:switch(a[0]){case 0:return basis$0General$1.eq_option$258(function(a){return a[0]==a[1]},[b[1],a[1]]);default:return!1}case 1:switch(a[0]){case 1:return basis$0General$1.eq_option$258(function(a){return a[0]==
a[1]},[b[1],a[1]]);default:return!1}case 2:switch(a[0]){case 2:return basis$0General$1.eq_option$258(function(a){return a[0]==a[1]},[b[1],a[1]]);default:return!1}case 3:switch(a[0]){case 3:return!0;default:return!1}}};basis$0StringCvt$1.padLeft$115=function(b,a,c){var d=c.length,f={$f:function(a){switch(a){case 0:return null;default:return[b,f.$f(SmlPrims.chk_ovf_i32(a-1))]}}},g=f.$f;return a<=d?c:SmlPrims.concat([SmlPrims.implode(g(SmlPrims.chk_ovf_i32(a-d))),[c,null]])};basis$0StringCvt$1.padRight$139=
function(b,a,c){var d=c.length,f={$f:function(a){switch(a){case 0:return null;default:return[b,f.$f(SmlPrims.chk_ovf_i32(a-1))]}}},g=f.$f;return a<=d?c:SmlPrims.concat([c,[SmlPrims.implode(g(SmlPrims.chk_ovf_i32(a-d))),null]])};basis$0StringCvt$1.scanString$163=function(b,a){var c=a.length;b=b(function(b){if(b>=c)return[1];if(0>b||b>=a.length)throw CompilerInitial.exn$Subscript$52;return[0,[a.charCodeAt(b),SmlPrims.chk_ovf_i32(b+1)]]})(0);switch(b[0]){case 1:return[1];default:return[0,b[1][0]]}};
basis$0StringCvt$1.splitl$206=function(b,a,c){return function(c,f){for(;;){var d=a(f);switch(d[0]){case 1:return c=function(a){for(;;){var c=a[0];if(null==c)return a;a=[c[1],[c[0],a[1]]]}}([c,null])[1],[SmlPrims.implode(c),f];default:var k=d[1];d=k[0];k=k[1];if(b(d))f=k,c=[d,c];else return c=function(a){for(;;){var c=a[0];if(null==c)return a;a=[c[1],[c[0],a[1]]]}}([c,null])[1],[SmlPrims.implode(c),f]}}}(null,c)};basis$0StringCvt$1.takel$236=function(b,a,c){return basis$0StringCvt$1.splitl$206(b,a,
c)[0]};basis$0StringCvt$1.dropl$250=function(b,a,c){return basis$0StringCvt$1.splitl$206(b,a,c)[1]};basis$0StringCvt$1.skipWS$276=function(b,a){return basis$0StringCvt$1.splitl$206(function(a){return 32==a?!0:9<=a?13>=a:!1},b,a)[1]};return 0})();"undefined"==typeof basis$0StrBase$1&&(basis$0StrBase$1={});
(function(){basis$0StrBase$1.explode$97=function(a){a:{var c=SmlPrims.chk_ovf_i32(a.length-1),b=null;for(;;){if(0>c)break a;var d=SmlPrims.chk_ovf_i32(c-1);b=[a.charCodeAt(c),b];c=d}}return b};var b=function(a,c,b){var d=b[0],f=b[1];b=b[2];var g=SmlPrims.chk_ovf_i32(f-1);return a([d,f,b,SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(function(a){for(;;)if(a>g&&c(d.charCodeAt(a)))a=SmlPrims.chk_ovf_i32(a-1);else return a}(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(f+b)-1))-f)+1)])};basis$0StrBase$1.dropl$186=
function(a,c){var b=c[0],d=c[1];c=c[2];var f=SmlPrims.chk_ovf_i32(d+c);a:{var l=d,m=b;for(;;)if(l<f&&a(m.charCodeAt(l)))l=SmlPrims.chk_ovf_i32(l+1);else break a}a=SmlPrims.chk_ovf_i32(l-d);return[b,SmlPrims.chk_ovf_i32(d+a),SmlPrims.chk_ovf_i32(c-a)]};basis$0StrBase$1.dropr$203=function(a,c){return b(function(a){return[a[0],a[1],a[3]]},a,c)};basis$0StrBase$1.takel$220=function(a,c){var b=c[0],d=c[1],f=SmlPrims.chk_ovf_i32(d+c[2]);a:{c=d;var l=b;for(;;)if(c<f&&a(l.charCodeAt(c)))c=SmlPrims.chk_ovf_i32(c+
1);else break a}a=SmlPrims.chk_ovf_i32(c-d);return[b,d,a]};basis$0StrBase$1.taker$237=function(a,c){return b(function(a){var c=a[2],b=a[3];return[a[0],SmlPrims.chk_ovf_i32(a[1]+b),SmlPrims.chk_ovf_i32(c-b)]},a,c)};basis$0StrBase$1.splitl$254=function(a,c){var b=c[0],d=c[1];c=c[2];var f=SmlPrims.chk_ovf_i32(d+c);a:{var l=d,m=b;for(;;)if(l<f&&a(m.charCodeAt(l)))l=SmlPrims.chk_ovf_i32(l+1);else break a}a=SmlPrims.chk_ovf_i32(l-d);return[[b,d,a],[b,SmlPrims.chk_ovf_i32(d+a),SmlPrims.chk_ovf_i32(c-a)]]};
basis$0StrBase$1.splitr$271=function(a,c){return b(function(a){var c=a[0],b=a[1],d=a[2];a=a[3];return[[c,b,a],[c,SmlPrims.chk_ovf_i32(b+a),SmlPrims.chk_ovf_i32(d-a)]]},a,c)};basis$0StrBase$1.translate$288=function(a,c){var b=c[0],d=c[1],f=SmlPrims.chk_ovf_i32(d+c[2]);return SmlPrims.concat(basis$0List$1.rev$682(function(c,d){for(;;){if(c>=f)return d;var g=SmlPrims.chk_ovf_i32(c+1);d=[a(b.charCodeAt(c)),d];c=g}}(d,null)))};basis$0StrBase$1.tokens$312=function(a,c){var b={$h:function(c){var d=c[2];
return function(f){if(0==d)return basis$0List$1.rev$682(f);var g=basis$0StrBase$1.splitl$254(function(c){return a(c)?!1:!0},c),k=g[0];return b.$h(basis$0StrBase$1.dropl$186(a,g[1]))([k,f])}}},d=b.$h;return d(basis$0StrBase$1.dropl$186(a,c))(null)};basis$0StrBase$1.fields$345=function(a,c){return function(c,b){for(;;){var d=basis$0StrBase$1.splitl$254(function(a){return function(c){return(0,a[0])(c)?!1:!0}}([a]),c);c=d[0];d=d[1];if(0==d[2])return basis$0List$1.rev$682([c,b]);var f=d[0],g=d[1],k=d[2];
d=0==k?d:[f,SmlPrims.chk_ovf_i32(g+1),SmlPrims.chk_ovf_i32(k-1)];b=[c,b];c=d}}(c,null)};basis$0StrBase$1.foldl$388=function(a,c,b){var d=b[0],f=b[1];b=SmlPrims.chk_ovf_i32(f+b[2]);a:{var g=c;for(;;){if(f>=b)break a;c=SmlPrims.chk_ovf_i32(f+1);g=a([d.charCodeAt(f),g]);f=c}}return g};var a={$fromMLescape:function(c,b){var d=function(b){for(;;)switch(b=c(b),b[0]){case 1:return[1];default:var d=b[1];b=d[0];switch(b){case 92:switch(b=c(d[1]),b[0]){case 1:return[1];default:switch(d=b[1],d[0]){case 92:return a.$fromMLescape(c,
d[1]);default:return b}}default:if(d=d[1],32==b||9<=b&&13>=b)b=d;else return[1]}}},f=c(b);switch(f[0]){case 1:return[1];default:switch(f=f[1],f[0]){case 97:return[0,[7,f[1]]];case 98:return[0,[8,f[1]]];case 116:return[0,[9,f[1]]];case 110:return[0,[10,f[1]]];case 114:return[0,[13,f[1]]];case 118:return[0,[11,f[1]]];case 102:return[0,[12,f[1]]];case 34:return[0,[34,f[1]]];case 92:return[0,[92,f[1]]];case 32:return d(f[1]);case 10:return d(f[1]);case 9:return d(f[1]);case 94:switch(b=c(f[1]),b[0]){case 1:return[1];
default:d=b[1];b=d[0];d=d[1];if(64<=b&&95>=b){b=SmlPrims.chk_ovf_i32(b-64);if(!(0<=b&&256>b))throw basis$0General$1.exn$Chr$62;return[0,[b,d]]}return[1]}default:try{var q=c(b);switch(q[0]){case 1:throw basis$0General$1.exn$Chr$62;default:var l=q[1],m=l[0],u=l[1];if(48<=m&&57>=m){var C=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(0)+m)-48),D=c(u);switch(D[0]){case 1:throw basis$0General$1.exn$Chr$62;default:var J=D[1],n=J[0],N=J[1];if(48<=n&&57>=n){var K=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(10*
C)+n)-48),G=c(N);switch(G[0]){case 1:throw basis$0General$1.exn$Chr$62;default:var L=G[1],H=L[0],O=L[1];if(48<=H&&57>=H){var E=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(10*K)+H)-48);if(!(0<=E&&256>E))throw basis$0General$1.exn$Chr$62;var y=[E,O]}else throw basis$0General$1.exn$Chr$62;}}else throw basis$0General$1.exn$Chr$62;}}else throw basis$0General$1.exn$Chr$62;}return[0,y]}catch(I){if(I[0]==basis$0General$1.en$Chr$62)b=[1];else throw I;return b}}}}};basis$0StrBase$1.fromMLescape$467=
a.$fromMLescape;basis$0StrBase$1.toMLescape$626=function(a){switch(a){case 92:return"\\\\";case 34:return'\\"';default:if(32<=a){if(126>=a)return SmlPrims.implode([a,null]);var c=SmlPrims.div_i32(a,100,CompilerInitial.exn$Div$47);c=SmlPrims.chk_ovf_i32(48+c);if(!(0<=c&&256>c))throw basis$0General$1.exn$Chr$62;var b=SmlPrims.mod_i32(SmlPrims.div_i32(a,10,CompilerInitial.exn$Div$47),10,CompilerInitial.exn$Div$47);b=SmlPrims.chk_ovf_i32(48+b);if(!(0<=b&&256>b))throw basis$0General$1.exn$Chr$62;a=SmlPrims.mod_i32(a,
10,CompilerInitial.exn$Div$47);a=SmlPrims.chk_ovf_i32(48+a);if(!(0<=a&&256>a))throw basis$0General$1.exn$Chr$62;return SmlPrims.implode([92,[c,[b,[a,null]]]])}switch(a){case 7:return"\\a";case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 13:return"\\r";case 11:return"\\v";case 12:return"\\f";default:a;a=SmlPrims.chk_ovf_i32(a+64);if(!(0<=a&&256>a))throw basis$0General$1.exn$Chr$62;return SmlPrims.implode([92,[94,[a,null]]])}}};basis$0StrBase$1.toCescape$662=function(a){switch(a){case 92:return"\\\\";
case 63:return"\\?";case 39:return"\\'";case 34:return'\\"';default:if(32<=a&&126>=a)return SmlPrims.implode([a,null]);switch(a){case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 11:return"\\v";case 8:return"\\b";case 12:return"\\f";case 7:return"\\a";default:var c=SmlPrims.div_i32(a,64,CompilerInitial.exn$Div$47);c=SmlPrims.chk_ovf_i32(48+c);if(!(0<=c&&256>c))throw basis$0General$1.exn$Chr$62;var b=SmlPrims.mod_i32(SmlPrims.div_i32(a,8,CompilerInitial.exn$Div$47),8,CompilerInitial.exn$Div$47);
b=SmlPrims.chk_ovf_i32(48+b);if(!(0<=b&&256>b))throw basis$0General$1.exn$Chr$62;a=SmlPrims.mod_i32(a,8,CompilerInitial.exn$Div$47);a=SmlPrims.chk_ovf_i32(48+a);if(!(0<=a&&256>a))throw basis$0General$1.exn$Chr$62;return SmlPrims.implode([92,[c,[b,[a,null]]]])}}};var c=function(a,c){var b=function(c,b){for(;;){var d=a(c);switch(d[0]){case 1:if(!(0<=b&&256>b))throw basis$0General$1.exn$Chr$62;return[b,c];default:var f=d[1];d=f[0];f=f[1];if(48<=d&&57>=d||97<=d&&102>=d||65<=d&&70>=d)c=f,b=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(16*
b)+(48<=d&&57>=d?SmlPrims.chk_ovf_i32(d-48):SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(d-55),32,CompilerInitial.exn$Div$47)));else{if(!(0<=b&&256>b))throw basis$0General$1.exn$Chr$62;return[b,c]}}}},d=function(c,b,d){var f=a(b);switch(f[0]){case 1:if(!(0<=d&&256>d))throw basis$0General$1.exn$Chr$62;return[d,b];default:var g=f[1];f=g[0];g=g[1];if(48<=f&&55>=f)return c(g)(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(8*d)+f)-48));if(!(0<=d&&256>d))throw basis$0General$1.exn$Chr$62;return[d,
b]}};c=a(c);switch(c[0]){case 1:throw basis$0General$1.exn$Chr$62;default:var f=c[1];c=f[0];switch(c){case 110:return[10,f[1]];case 114:return[13,f[1]];case 116:return[9,f[1]];case 118:return[11,f[1]];case 98:return[8,f[1]];case 102:return[12,f[1]];case 97:return[7,f[1]];case 92:return[92,f[1]];case 63:return[63,f[1]];case 39:return[39,f[1]];case 34:return[34,f[1]];case 120:switch(c=a(f[1]),c[0]){case 1:throw basis$0General$1.exn$Chr$62;default:f=c[1];c=f[0];f=f[1];if(48<=c&&57>=c||97<=c&&102>=c||
65<=c&&70>=c)return b(f,48<=c&&57>=c?SmlPrims.chk_ovf_i32(c-48):SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(c-55),32,CompilerInitial.exn$Div$47));throw basis$0General$1.exn$Chr$62;}default:b=f[1];if(48<=c&&55>=c)return c=SmlPrims.chk_ovf_i32(c-48),d(function(a){return function(c){return d(function(a){return function(c){if(!(0<=c&&256>c))throw basis$0General$1.exn$Chr$62;return[c,a]}},a,c)}},b,c);throw basis$0General$1.exn$Chr$62;}}};basis$0StrBase$1.fromCescape$836=function(a,b){try{return[0,c(a,b)]}catch(g){a=
g;if(a[0]==basis$0General$1.en$Chr$62)a=[1];else if(a[0]==CompilerInitial.en$Overflow$50)a=[1];else throw g;return a}};basis$0StrBase$1.fromCString$848=function(a){var b=function(a,b){a:for(;;)switch(b=null==b?[1]:[0,[b[0],b[1]]],b[0]){case 1:return SmlPrims.implode(basis$0List$1.rev$682(a));default:var d=b[1];b=d[0];switch(b){case 92:b=d[1];b=c(function(a){return function(a){return null==a?[1]:[0,[a[0],a[1]]]}}([]),b);d=b[1];a=[b[0],a];b=d;continue a;default:d=d[1],a=[b,a],b=d}}};try{var d=function(c,
b){for(;;){if(0>c)return b;var d=SmlPrims.chk_ovf_i32(c-1);b=[a.charCodeAt(c),b];c=d}}(SmlPrims.chk_ovf_i32(a.length-1),null);return[0,b(null,d)]}catch(k){if(k[0]==basis$0General$1.en$Chr$62||k[0]==CompilerInitial.en$Overflow$50)b=[1];else throw k;return b}};return 0})();"undefined"==typeof basis$0Char$1&&(basis$0Char$1={});
(function(){basis$0Char$1.sub_unsafe$54=function(b,a){return b.charCodeAt(a)};basis$0Char$1.size$61=function(b){return b.length};basis$0Char$1.ord$65=function(b){return b};basis$0Char$1.unsafe_chr$69=function(b){return b};basis$0Char$1.chr$73=function(b){if(0<=b&&256>b)return b;throw basis$0General$1.exn$Chr$62;};basis$0Char$1.not$85=function(b){return b?!1:!0};basis$0Char$1.minChar$93=0;basis$0Char$1.maxChar$94=255;basis$0Char$1.maxOrd$95=255;basis$0Char$1.succ$96=function(b){if(255>b)return SmlPrims.chk_ovf_i32(b+
1);throw basis$0General$1.exn$Chr$62;};basis$0Char$1.pred$105=function(b){if(0<b)return SmlPrims.chk_ovf_i32(b-1);throw basis$0General$1.exn$Chr$62;};basis$0Char$1.contains$114=function(b,a){var c=b.length;a:{var d=0;for(;;){if(d>=c){b=!1;break a}if(b.charCodeAt(d)==a){b=!0;break a}d=SmlPrims.chk_ovf_i32(d+1)}}return b};basis$0Char$1.notContains$134=function(b,a){var c=b.length;a:{var d=0;for(;;){if(d>=c){b=!1;break a}if(b.charCodeAt(d)==a){b=!0;break a}d=SmlPrims.chk_ovf_i32(d+1)}}return b?!1:!0};
basis$0Char$1.isLower$141=function(b){return 97<=b?122>=b:!1};basis$0Char$1.isUpper$149=function(b){return 65<=b?90>=b:!1};basis$0Char$1.isDigit$157=function(b){return 48<=b?57>=b:!1};basis$0Char$1.isAlpha$165=function(b){return 97<=b&&122>=b?!0:65<=b?90>=b:!1};basis$0Char$1.isHexDigit$173=function(b){return 48<=b&&57>=b?!0:97<=b&&102>=b?!0:65<=b?70>=b:!1};basis$0Char$1.isAlphaNum$197=function(b){return 97<=b&&122>=b||65<=b&&90>=b?!0:48<=b?57>=b:!1};basis$0Char$1.isPrint$205=function(b){return 32<=
b?127>b:!1};basis$0Char$1.isSpace$213=function(b){return 32==b?!0:9<=b?13>=b:!1};basis$0Char$1.isGraph$225=function(b){return 32<=b&&127>b?32==b||9<=b&&13>=b?!1:!0:!1};basis$0Char$1.isPunct$233=function(b){return 32<=b&&127>b&&!(32==b||9<=b&&13>=b)?97<=b&&122>=b||65<=b&&90>=b||48<=b&&57>=b?!1:!0:!1};basis$0Char$1.isAscii$241=function(b){return 127>=b};basis$0Char$1.isCntrl$245=function(b){return 32>b?!0:127<=b};basis$0Char$1.toLower$253=function(b){return 65<=b&&90>=b?SmlPrims.chk_ovf_i32(b+32):b};
basis$0Char$1.toUpper$265=function(b){return 97<=b&&122>=b?SmlPrims.chk_ovf_i32(b-32):b};basis$0Char$1.toString$277=function(b){return basis$0StrBase$1.toMLescape$626(b)};basis$0Char$1.scan$281=function(b,a){a=b(a);switch(a[0]){case 1:return[1];default:switch(a=a[1],a[0]){case 92:switch(b=basis$0StrBase$1.fromMLescape$467(b,a[1]),b[0]){case 1:return[1];default:return[0,b[1]]}default:return[0,a]}}};basis$0Char$1.fromString$305=function(b){var a=0<b.length?[0,[b.charCodeAt(0),SmlPrims.chk_ovf_i32(1)]]:
[1];switch(a[0]){case 1:return[1];default:a=a[1];var c=a[0];switch(c){case 92:switch(a=basis$0StrBase$1.fromMLescape$467(function(a){return a<b.length?[0,[b.charCodeAt(a),SmlPrims.chk_ovf_i32(a+1)]]:[1]},a[1]),a[0]){case 1:return[1];default:return[0,a[1][0]]}default:return[0,c]}}};basis$0Char$1.fromCString$335=function(b){var a=0<b.length?[0,[b.charCodeAt(0),SmlPrims.chk_ovf_i32(1)]]:[1];switch(a[0]){case 1:return[1];default:a=a[1];var c=a[0];switch(c){case 92:switch(a=basis$0StrBase$1.fromCescape$836(function(a){return a<
b.length?[0,[b.charCodeAt(a),SmlPrims.chk_ovf_i32(a+1)]]:[1]},a[1]),a[0]){case 1:return[1];default:return[0,a[1][0]]}default:return[0,c]}}};basis$0Char$1.toCString$365=function(b){return basis$0StrBase$1.toCescape$662(b)};basis$0Char$1.compare$369=function(b,a){return b<a?0:b>a?1:2};basis$0Char$1.s$j$384=function(b,a){return b<a};basis$0Char$1.s$jk$386=function(b,a){return b<=a};basis$0Char$1.s$l$388=function(b,a){return b>a};basis$0Char$1.s$lk$390=function(b,a){return b>=a};return 0})();
"undefined"==typeof basis$0String$1&&(basis$0String$1={});
(function(){basis$0String$1.sub_unsafe$54=function(b,a){return b.charCodeAt(a)};basis$0String$1.size$61=function(b){return b.length};basis$0String$1.s$r$65=function(b,a){return b+a};basis$0String$1.sub_array_unsafe$72=function(b,a){return b[a]};basis$0String$1.update_array_unsafe$79=function(b,a,c){return b[a]=c,0};basis$0String$1.alloc_array_unsafe$88=function(b){return Array(b)};basis$0String$1.length_array$92=function(b){return b.length};basis$0String$1.array_to_string$96=function(b){return SmlPrims.charArrayToString(b)};
basis$0String$1.maxSize$100=16777211;basis$0String$1.sub$101=function(b,a){if(0>a||a>=b.length)throw CompilerInitial.exn$Subscript$52;return b.charCodeAt(a)};basis$0String$1.extract$116=function(b,a,c){switch(c[0]){case 1:c=SmlPrims.chk_ovf_i32(b.length-a);break;default:c=c[1]}if(0>a||0>c||16777211<c||a>b.length||SmlPrims.chk_ovf_i32(a+c)>b.length)throw CompilerInitial.exn$Subscript$52;var d=Array(c);a:{var f=0;for(;;){if(f>=c)break a;var g=b.charCodeAt(a);d[f]=g;0;a=SmlPrims.chk_ovf_i32(a+1);f=SmlPrims.chk_ovf_i32(f+
1)}}return SmlPrims.charArrayToString(d)};basis$0String$1.substring$169=function(b,a,c){return basis$0String$1.extract$116(b,a,[0,c])};basis$0String$1.concat$178=function(b){return SmlPrims.concat(b)};basis$0String$1.concatWith$182=function(b,a){if(null==a)return"";var c=basis$0List$1.tl$677;var d={$foldr:function(a){return null==a?null:[b,[a[0],d.$foldr(a[1])]]}},f=d.$foldr;a=f(a);c=c(a);return SmlPrims.concat(c)};basis$0String$1.implode$205=function(b){return SmlPrims.implode(b)};basis$0String$1.explode$209=
function(b){a:{var a=SmlPrims.chk_ovf_i32(b.length-1),c=null;for(;;){if(0>a)break a;var d=SmlPrims.chk_ovf_i32(a-1);c=[b.charCodeAt(a),c];a=d}}return c};basis$0String$1.str$213=function(b){return SmlPrims.implode([b,null])};basis$0String$1.translate$217=function(b,a){return basis$0StrBase$1.translate$288(b,[a,0,a.length])};basis$0String$1.tokens$224=function(b,a){return basis$0List$1.map$697(function(a){return basis$0String$1.extract$116(a[0],a[1],[0,a[2]])},basis$0StrBase$1.tokens$312(b,[a,0,a.length]))};
basis$0String$1.fields$231=function(b,a){return basis$0List$1.map$697(function(a){return basis$0String$1.extract$116(a[0],a[1],[0,a[2]])},basis$0StrBase$1.fields$345(b,[a,0,a.length]))};basis$0String$1.map$238=function(b,a){var c=a.length;if(0>c||16777211<c)throw CompilerInitial.exn$Size$53;var d=Array(c);a:{var f=0;for(;;)if(f<c)d[f]=b(a.charCodeAt(f)),0,f=SmlPrims.chk_ovf_i32(f+1);else break a}return SmlPrims.charArrayToString(d)};basis$0String$1.isSuffix$242=function(b,a){var c=b.length,d=a.length,
f=SmlPrims.chk_ovf_i32(d-c);if(c<=d)a:for(d=0;;){if(d==c){b=!0;break a}if(b.charCodeAt(d)==a.charCodeAt(SmlPrims.chk_ovf_i32(d+f)))d=SmlPrims.chk_ovf_i32(d+1);else{b=!1;break a}}else b=!1;return b};basis$0String$1.isSubstring$268=function(b,a){switch(b){case "":return!0;default:var c=b.length,d=a.length,f=SmlPrims.chk_ovf_i32(c-1);c=SmlPrims.chk_ovf_i32(d-c);a:for(d=0;;)if(d<=c){if(b.charCodeAt(f)==a.charCodeAt(SmlPrims.chk_ovf_i32(f+d)))c:{var g=0;for(;;){if(g>=f){g=!0;break c}if(b.charCodeAt(g)==
a.charCodeAt(SmlPrims.chk_ovf_i32(g+d)))g=SmlPrims.chk_ovf_i32(g+1);else{g=!1;break c}}}else g=!1;if(g){b=!0;break a}d=SmlPrims.chk_ovf_i32(d+1)}else{b=!1;break a}return b}};basis$0String$1.isPrefix$321=function(b,a){var c=b.length,d=a.length,f=c<d?c:d;if(c<=d)a:for(c=0;;){if(c==f){b=!0;break a}if(b.charCodeAt(c)==a.charCodeAt(c))c=SmlPrims.chk_ovf_i32(c+1);else{b=!1;break a}}else b=!1;return b};basis$0String$1.compare$351=function(b,a){return b<a?0:b>a?1:2};basis$0String$1.collate$366=function(b,
a){var c=a[0],d=a[1],f=c.length,g=d.length,k=f<g?f:g;return function(a){for(;;){if(a==k)return f<g?0:f>g?1:2;switch(b([c.charCodeAt(a),d.charCodeAt(a)])){case 0:return 0;case 1:return 1;default:a=SmlPrims.chk_ovf_i32(a+1)}}}(0)};basis$0String$1.fromString$405=function(b){return function(a,c){a:for(;;)switch(a=a<b.length?[0,[b.charCodeAt(a),SmlPrims.chk_ovf_i32(a+1)]]:[1],a[0]){case 1:return[0,SmlPrims.implode(basis$0List$1.rev$682(c))];default:a=a[1];var d=a[0];switch(d){case 92:switch(a=a[1],a=basis$0StrBase$1.fromMLescape$467(function(a){return function(c){var b=
a[0];return c<b.length?[0,[b.charCodeAt(c),SmlPrims.chk_ovf_i32(c+1)]]:[1]}}([b]),a),a[0]){case 1:return[1];default:a=a[1];c=[a[0],c];a=a[1];continue a}default:c=[d,c],a=a[1]}}}(0,null)};basis$0String$1.toString$446=function(b){return basis$0StrBase$1.translate$288(function(a){return basis$0StrBase$1.toMLescape$626(a)},[b,0,b.length])};basis$0String$1.fromCString$450=function(b){return basis$0StrBase$1.fromCString$848(b)};basis$0String$1.toCString$454=function(b){return basis$0StrBase$1.translate$288(function(a){return basis$0StrBase$1.toCescape$662(a)},
[b,0,b.length])};basis$0String$1.s$j$458=function(b,a){return b<a};basis$0String$1.s$jk$460=function(b,a){return b<=a};basis$0String$1.s$l$462=function(b,a){return b>a};basis$0String$1.s$lk$464=function(b,a){return b>=a};basis$0String$1.substring$466=function(b,a,c){return basis$0String$1.extract$116(b,a,[0,c])};return 0})();"undefined"==typeof basis$0Substring$1&&(basis$0Substring$1={});
(function(){var b=function(a,c,b,f,g){a:for(;;)if(0<g)b[f]=a.charCodeAt(c),0,c=SmlPrims.chk_ovf_i32(c+1),f=SmlPrims.chk_ovf_i32(f+1),g=SmlPrims.chk_ovf_i32(g-1);else break a;return 0};basis$0Substring$1.base$113=function(a){return a};basis$0Substring$1.string$117=function(a,c,d){var f=Array(d);b(a,c,f,0,d);return SmlPrims.charArrayToString(f)};basis$0Substring$1.extract$129=function(a,c,b){switch(b[0]){case 1:if(0<=c&&c<=a.length)return[a,c,SmlPrims.chk_ovf_i32(a.length-c)];throw CompilerInitial.exn$Subscript$52;
default:b=b[1];if(0<=c&&0<=b&&b<=SmlPrims.chk_ovf_i32(a.length-c))return[a,c,b];throw CompilerInitial.exn$Subscript$52;}};basis$0Substring$1.substring$168=function(a,c,b){return basis$0Substring$1.extract$129(a,c,[0,b])};basis$0Substring$1.full$177=function(a){return[a,0,a.length]};basis$0Substring$1.getc$181=function(a,c,b){switch(b){case 0:return[1];default:return[0,[a.charCodeAt(c),[a,SmlPrims.chk_ovf_i32(c+1),SmlPrims.chk_ovf_i32(b-1)]]]}};basis$0Substring$1.first$199=function(a,c,b){return 0==
b?[1]:[0,a.charCodeAt(c)]};basis$0Substring$1.isEmpty$212=function(a,c,b){return 0==b};basis$0Substring$1.triml$221=function(a){if(0>a)throw CompilerInitial.exn$Subscript$52;return function(c){var b=c[0],f=c[1];c=c[2];return a>c?[b,SmlPrims.chk_ovf_i32(f+c),0]:[b,SmlPrims.chk_ovf_i32(f+a),SmlPrims.chk_ovf_i32(c-a)]}};basis$0Substring$1.trimr$241=function(a){if(0>a)throw CompilerInitial.exn$Subscript$52;return function(c){var b=c[0],f=c[1];c=c[2];return a>c?[b,f,0]:[b,f,SmlPrims.chk_ovf_i32(c-a)]}};
basis$0Substring$1.sub$261=function(a,c){var b=a[0],f=a[1];a=a[2];if(0>c||c>=a)throw CompilerInitial.exn$Subscript$52;return b.charCodeAt(SmlPrims.chk_ovf_i32(f+c))};basis$0Substring$1.size$281=function(a,c,b){return b};basis$0Substring$1.slice$286=function(a,c,b){switch(b[0]){case 1:var d=a[0],g=a[1];a=a[2];if(0<=c&&c<=a)return[d,SmlPrims.chk_ovf_i32(g+c),SmlPrims.chk_ovf_i32(a-c)];throw CompilerInitial.exn$Subscript$52;default:d=a[0];g=a[1];a=a[2];b=b[1];if(0<=c&&0<=b&&SmlPrims.chk_ovf_i32(c+b)<=
a)return[d,SmlPrims.chk_ovf_i32(g+c),b];throw CompilerInitial.exn$Subscript$52;}};basis$0Substring$1.splitAt$335=function(a,c){var b=a[0],f=a[1];a=a[2];if(0>c||c>a)throw CompilerInitial.exn$Subscript$52;return[[b,f,c],[b,SmlPrims.chk_ovf_i32(f+c),SmlPrims.chk_ovf_i32(a-c)]]};basis$0Substring$1.concat$355=function(a){var c=function(a,c){for(;;){if(null==a)return c;var b=a;a=b[1];c=SmlPrims.chk_ovf_i32(b[0][2]+c)}}(a,0);if(16777211<c)throw CompilerInitial.exn$Size$53;var d=Array(c);(function(a,c){for(;;){if(null==
c)return 0;var f=c;c=f[0];var g=c[2];f=f[1];b(c[0],c[1],d,a,g);a=SmlPrims.chk_ovf_i32(a+g);c=f}})(0,a);return SmlPrims.charArrayToString(d)};basis$0Substring$1.concatWith$417=function(a,c){if(null==c)return"";var d=c[0],f=d[0],g=d[1];d=d[2];c=c[1];var k=a.length,q=function(a,c){for(;;){if(null==a)return c;var b=a;a=b[1];c=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(b[0][2]+k)+c)}}(c,d);if(16777211<q)throw CompilerInitial.exn$Size$53;var l=Array(q);b(f,g,l,0,d);(function(c,d){for(;;){if(null==d)return 0;
var f=d,g=f[0];d=g[0];var m=g[1];g=g[2];f=f[1];b(a,0,l,c,k);b(d,m,l,SmlPrims.chk_ovf_i32(c+k),g);c=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(c+k)+g);d=f}})(d,c);return SmlPrims.charArrayToString(l)};basis$0Substring$1.compare$505=function(a,c){var b=a[0],f=a[1],g=a[2],k=c[0],q=c[1],l=c[2],m=g<l?g:l;return function(a){for(;;){if(a==m)return g<l?0:g>l?1:2;var c=b.charCodeAt(SmlPrims.chk_ovf_i32(f+a)),d=k.charCodeAt(SmlPrims.chk_ovf_i32(q+a));if(c<d)return 0;if(c>d)return 1;a=SmlPrims.chk_ovf_i32(a+
1)}}(0)};basis$0Substring$1.isPrefix$553=function(a,c){var b=c[0],f=c[1],g=c[2],k=a.length;c=k<g?k:g;if(k<=g)a:for(g=0;;){if(g==c){a=!0;break a}if(a.charCodeAt(g)==b.charCodeAt(SmlPrims.chk_ovf_i32(f+g)))g=SmlPrims.chk_ovf_i32(g+1);else{a=!1;break a}}else a=!1;return a};basis$0Substring$1.isSuffix$587=function(a,c){var b=c[0],f=c[2],g=a.length;c=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(c[1]+f)-g);if(g<=f)a:for(f=0;;){if(f==g){a=!0;break a}if(a.charCodeAt(f)==b.charCodeAt(SmlPrims.chk_ovf_i32(f+c)))f=
SmlPrims.chk_ovf_i32(f+1);else{a=!1;break a}}else a=!1;return a};basis$0Substring$1.isSubstring$617=function(a,c){switch(a){case "":return!0;default:var b=c[0],f=c[1],g=c[2],k=a.length;c=SmlPrims.chk_ovf_i32(k-1);g=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(f+g)-k);a:for(;;)if(f<=g){if(a.charCodeAt(c)==b.charCodeAt(SmlPrims.chk_ovf_i32(c+f)))c:for(k=0;;){if(k>=c){k=!0;break c}if(a.charCodeAt(k)==b.charCodeAt(SmlPrims.chk_ovf_i32(k+f)))k=SmlPrims.chk_ovf_i32(k+1);else{k=!1;break c}}else k=!1;if(k){a=
!0;break a}f=SmlPrims.chk_ovf_i32(f+1)}else{a=!1;break a}return a}};basis$0Substring$1.collate$681=function(a,c){var b=c[0],f=b[0],g=b[1],k=b[2];c=c[1];var q=c[0],l=c[1],m=c[2],u=k<m?k:m;return function(c){for(;;){if(c==u)return k<m?0:k>m?1:2;switch(a([f.charCodeAt(SmlPrims.chk_ovf_i32(g+c)),q.charCodeAt(SmlPrims.chk_ovf_i32(l+c))])){case 0:return 0;case 1:return 1;default:c=SmlPrims.chk_ovf_i32(c+1)}}}(0)};basis$0Substring$1.foldl$728=function(a,c,b){var d=b[0],g=b[1];b=SmlPrims.chk_ovf_i32(g+b[2]);
a:{var k=c;for(;;){if(g>=b)break a;c=SmlPrims.chk_ovf_i32(g+1);k=a([d.charCodeAt(g),k]);g=c}}return k};basis$0Substring$1.foldr$738=function(a,c,b){var d=b[0],g=b[1];a:{b=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(g+b[2])-1);var k=c;for(;;){if(b<g)break a;c=SmlPrims.chk_ovf_i32(b-1);k=a([d.charCodeAt(b),k]);b=c}}return k};basis$0Substring$1.explode$764=function(a,c,b){a:{b=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(c+b)-1);var d=null;for(;;){if(b<c)break a;var g=SmlPrims.chk_ovf_i32(b-1);d=[a.charCodeAt(b),
d];b=g}}return d};basis$0Substring$1.app$784=function(a,c){var b=c[0],f=c[1];c=SmlPrims.chk_ovf_i32(f+c[2]);a:for(;;){if(f>=c)break a;a(b.charCodeAt(f));f=SmlPrims.chk_ovf_i32(f+1)}return 0};basis$0Substring$1.span$807=function(a,c){var b=c[0],f=b[0];b=b[1];var g=c[1];c=g[0];var k=g[1];g=g[2];if(b>SmlPrims.chk_ovf_i32(k+g)||!a([f,c]))throw basis$0General$1.exn$Span$60;return[f,b,SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(k+g)-b)]};basis$0Substring$1.splitl$832=function(a,c){return basis$0StrBase$1.splitl$254(a,
c)};basis$0Substring$1.splitr$833=function(a,c){return basis$0StrBase$1.splitr$271(a,c)};basis$0Substring$1.dropl$834=function(a,c){return basis$0StrBase$1.dropl$186(a,c)};basis$0Substring$1.dropr$835=function(a,c){return basis$0StrBase$1.dropr$203(a,c)};basis$0Substring$1.takel$836=function(a,c){return basis$0StrBase$1.takel$220(a,c)};basis$0Substring$1.taker$837=function(a,c){return basis$0StrBase$1.taker$237(a,c)};basis$0Substring$1.translate$838=function(a,c){return basis$0StrBase$1.translate$288(a,
c)};basis$0Substring$1.tokens$839=function(a,c){return basis$0StrBase$1.tokens$312(a,c)};basis$0Substring$1.fields$840=function(a,c){return basis$0StrBase$1.fields$345(a,c)};basis$0Substring$1.position$841=function(a,c){switch(a){case "":return[[c[0],c[1],0],c];default:var b=c[0],f=c[1],g=c[2],k=SmlPrims.chk_ovf_i32(a.length-1),q=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(f+g)-k)-1);a:{var l=f;for(;;){if(l>q){a=[c,[b,SmlPrims.chk_ovf_i32(f+g),0]];break a}var m;if(m=a.charCodeAt(k)==
b.charCodeAt(SmlPrims.chk_ovf_i32(l+k)))c:{m=0;var u=l;for(;;){if(m>=k){m=!0;break c}if(a.charCodeAt(m)==b.charCodeAt(u))m=SmlPrims.chk_ovf_i32(m+1),u=SmlPrims.chk_ovf_i32(u+1);else{m=!1;break c}}}if(m){a=[[b,f,SmlPrims.chk_ovf_i32(l-f)],[b,l,SmlPrims.chk_ovf_i32(g-SmlPrims.chk_ovf_i32(l-f))]];break a}l=SmlPrims.chk_ovf_i32(l+1)}}return a}};return 0})();"undefined"==typeof basis$0IntInfRep$1&&(basis$0IntInfRep$1={});
(function(){var b=function(a){a=SmlPrims.i32_to_w32(a)&2147483647;var c=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));c=SmlPrims.w31_to_i32_X(31<=c?1073741823>=a?0:2147483647:a&-1073741824?(a|2147483648)>>c&2147483647:a>>c);c=SmlPrims.chk_ovf_i31(c);var b=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));a=SmlPrims.w31_to_i32_X(a&(31<=b?0:1<<(b&31)&2147483647)-1&2147483647);a=SmlPrims.chk_ovf_i31(a);return[c,a]},a={$addOne:function(c){if(null==c)return[1,null];var b=
c[1];c=SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(-1073741824+c[0])+1);return 0>c?[SmlPrims.chk_ovf_i31(c- -1073741824),b]:[c,a.$addOne(b)]}},c=a.$addOne,d={$add:function(a,c){if(null==a)return c;if(null==c)return a;var b=a[1],r=c[0];c=c[1];return d.$addd(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(-1073741824+a[0])+r),b,c)},$addd:function(a,c,b){return 0>a?[SmlPrims.chk_ovf_i31(a- -1073741824),d.$add(c,b)]:[a,d.$addc(c,b)]},$addc:function(a,b){if(null==b)return c(a);if(null==a)return c(b);var r=a[1],
f=b[0];b=b[1];return d.$addd(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(-1073741824+a[0])+f)+1),r,b)}},f=d.$add,g={$subtOne:function(a){if(null==a)throw[basis$0Initial$1.en$Fail$54,""];switch(a[0]){case 0:return[1073741823,g.$subtOne(a[1])];case 1:if(null==a[1])return null;var c=a[1];return[SmlPrims.chk_ovf_i31(a[0]-1),c];default:return c=a[1],[SmlPrims.chk_ovf_i31(a[0]-1),c]}}},k=g.$subtOne,q=new String("Negative"),l=[q],m={$subt:function(a,c){if(null==c)return a;if(null==a)throw l;
var b=a[1],d=c[1];return m.$subd(SmlPrims.chk_ovf_i31(a[0]-c[0]),b,d)},$subb:function(a,c){if(null==a)throw l;if(null==c)return c=a[1],m.$subd(SmlPrims.chk_ovf_i31(a[0]-1),c,null);var b=a[1],d=c[1];return m.$subd(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(a[0]-c[0])-1),b,d)},$subd:function(a,c,b){if(0<=a)switch(c=m.$subt(c,b),a){case 0:return null==c?null:[a,c];default:return[a,c]}else switch(a=SmlPrims.chk_ovf_i31(a- -1073741824),c=m.$subb(c,b),a){case 0:return null==c?null:[a,c];default:return[a,
c]}}},u=m.$subt,C=function(a,c){switch(c){case 0:return null;case 1:return a;default:var d={$muldc:function(a,r){if(null==a)switch(r){case 0:return null;default:return[r,null]}else{var f=a[1];var g=b(a[0]);a=g[0];var p=g[1];g=b(c);var k=g[0],T=g[1];g=SmlPrims.chk_ovf_i31(a*k);k=SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(a-p)*SmlPrims.chk_ovf_i31(k-T));p=SmlPrims.chk_ovf_i31(p*T);a=b(p);T=a[0];a=a[1];p=b(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(-1073741824+
g)+p)-k)+T));k=p[1];g=SmlPrims.chk_ovf_i31(g+p[0]);p=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));p=SmlPrims.w31_to_i32_X(31<=p?0:1<<(p&31)&2147483647);p=SmlPrims.chk_ovf_i31(p);g=SmlPrims.chk_ovf_i31(g+p);k=SmlPrims.i32_to_w32(k)&2147483647;p=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));k=SmlPrims.w31_to_i32_X(31<=p?0:k<<(p&31)&2147483647);k=SmlPrims.chk_ovf_i31(k);a=SmlPrims.chk_ovf_i31(k+a);g=[g,a];a=g[0];r=SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i31(g[1]+-1073741824)+
r);return 0<=r?[r,d.$muldc(f,SmlPrims.chk_ovf_i31(a+1))]:[SmlPrims.chk_ovf_i31(r- -1073741824),d.$muldc(f,a)]}}},r=d.$muldc;return r(a,0)}},D={$mult:function(a,c){if(null==c)return null;var b=c[1];if(null==b)return C(a,c[0]);switch(c[0]){case 0:return a=D.$mult(a,b),null==a?null:[0,a];default:var d={$muln:function(a){if(null==a)return null;var b=a[1];a=C(c,a[0]);b=d.$muln(b);return f(a,null==b?null:[0,b])}};b=d.$muln;return b(a)}}},J=D.$mult,n=function(a,c){var d=a[0];a=b(a[1]);var r=a[0],f=a[1];
a=b(c);var g=a[0],p=a[1];a=function(a,b){for(;;)if(0>b)a=SmlPrims.chk_ovf_i31(a-1),b=SmlPrims.chk_ovf_i31(b+c);else return[a,b]};if(0==g)throw CompilerInitial.exn$Div$47;var k=SmlPrims.chk_ovf_i31(SmlPrims.quot(d,g));if(0==g)throw CompilerInitial.exn$Div$47;d=SmlPrims.i32_to_w32(d%g)&2147483647;var m=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));d=SmlPrims.w31_to_i32_X(31<=m?0:d<<(m&31)&2147483647);d=SmlPrims.chk_ovf_i31(d);r=SmlPrims.chk_ovf_i31(d+r);r=SmlPrims.chk_ovf_i31(r-SmlPrims.chk_ovf_i31(k*
p));k=a(k,r);r=k[0];d=k[1];if(0==g)throw CompilerInitial.exn$Div$47;k=SmlPrims.chk_ovf_i31(SmlPrims.quot(d,g));if(0==g)throw CompilerInitial.exn$Div$47;g=SmlPrims.i32_to_w32(d%g)&2147483647;d=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,2)));g=SmlPrims.w31_to_i32_X(31<=d?0:g<<(d&31)&2147483647);g=SmlPrims.chk_ovf_i31(g);f=SmlPrims.chk_ovf_i31(g+f);f=SmlPrims.chk_ovf_i31(f-SmlPrims.chk_ovf_i31(k*p));f=a(k,f);a=f[0];f=f[1];p=SmlPrims.i32_to_w32(r)&2147483647;g=SmlPrims.i32_to_w32(SmlPrims.chk_ovf_i31(SmlPrims.quot(30,
2)));p=SmlPrims.w31_to_i32_X(31<=g?0:p<<(g&31)&2147483647);p=SmlPrims.chk_ovf_i31(p);return[SmlPrims.chk_ovf_i31(p+a),f]},N=function(a,c){switch(c){case 1:return[a,0];default:var b=1073741823==c?1:SmlPrims.div_i31(-1073741824,SmlPrims.chk_ovf_i31(-SmlPrims.chk_ovf_i31(c+1)),CompilerInitial.exn$Div$47),d=SmlPrims.chk_ovf_i31(c*b);a=C(a,b);var f={$dmi:function(a){if(null==a)return[null,0];var c=a[0],b=f.$dmi(a[1]);a=b[0];c=n([b[1],c],d);b=c[0];switch(b){case 0:a=null==a?null:[b,a];break;default:a=[b,
a]}return[a,c[1]]}};c=f.$dmi;c=c(a);a=c[0];c=c[1];if(0==b)throw[basis$0Initial$1.en$Fail$54,"divmodd"];0;return[a,SmlPrims.div_i31(c,b,CompilerInitial.exn$Div$47)]}},K={$divmod:function(a,c){if(null==c)throw CompilerInitial.exn$Div$47;if(null==a)return[null,null];var b=c[0];switch(b){case 0:b=a[0];a=K.$divmod(a[1],c[1]);c=a[0];a=a[1];switch(b){case 0:a=null==a?null:[b,a];break;default:a=[b,a]}return[c,a];default:if(null==c[1])return c=N(a,b),a=c[1],[c[0],0==a?null:[a,null]];var d=function(a,c){for(;;){if(null==
a)return c;a=a[1];c=SmlPrims.chk_ovf_i32(c+1)}}(c,0);b=SmlPrims.chk_ovf_i32(d-1);if(0>b)throw CompilerInitial.exn$Subscript$52;b=function(a,c){for(;;){if(null==a)throw CompilerInitial.exn$Subscript$52;var b=a[0];if(0==c)return b;a=a[1];c=SmlPrims.chk_ovf_i32(c-1)}}(c,b);b=1073741823==b?1:SmlPrims.div_i31(-1073741824,SmlPrims.chk_ovf_i31(-SmlPrims.chk_ovf_i31(b+1)),CompilerInitial.exn$Div$47);a=C(a,b);var f=C(c,b);c=SmlPrims.chk_ovf_i32(d-1);if(0>c)throw CompilerInitial.exn$Subscript$52;var r=function(a,
c){for(;;){if(null==a)throw CompilerInitial.exn$Subscript$52;var b=a[0];if(0==c)return b;a=a[1];c=SmlPrims.chk_ovf_i32(c-1)}}(f,c);var g={$divl:function(a){if(null==a)return[null,null];var c=a[0],b=g.$divl(a[1]);a=b[0];b=b[1];switch(c){case 0:var p=null==b?null:[c,b];break;default:p=[c,b]}b=function(a,c){for(;;){if(null==a)return[0,0];var b=a,d=b[1];if(null==d)switch(c){case 1:return[0,b[0]];default:a=a[1],c=SmlPrims.chk_ovf_i32(c-1)}else if(null==d[1])switch(c){case 1:return[d[0],b[0]];default:a=
a[1],c=SmlPrims.chk_ovf_i32(c-1)}else a=a[1],c=SmlPrims.chk_ovf_i32(c-1)}}(p,d);c=b[0];b=b[1];c=c==r?1073741823:n([c,b],r)[0];var k={$try:function(a,c){try{return[a,u(p,c)]}catch(ea){var b=ea;if(b[0]==q)a=k.$try(SmlPrims.chk_ovf_i31(a-1),u(c,f));else throw b;return a}}};b=k.$try;c=b(c,C(f,c));b=c[0];switch(b){case 0:a=null==a?null:[b,a];break;default:a=[b,a]}return[a,c[1]]}};c=g.$divl;c=c(a);return[c[0],N(c[1],b)[0]]}}},G=K.$divmod,L={$cmp:function(a,c){if(null==a)return null==c?2:0;if(null==c)return 1;
var b=a[0],d=c[0];a=L.$cmp(a[1],c[1]);switch(a){case 2:return b==d?2:b<d?0:1;default:return a}}},H=L.$cmp,O={$natInfToI32:function(a){if(null==a)return 0;var c=a[1];if(null==c)return a[0];if(null==c[1])return a=a[0],SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-1073741824*c[0]))+a);a=a[0];return SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-1073741824*O.$natInfToI32(c)))+a)}},E=O.$natInfToI32,y=function(a){a=a[1];var b=a[0];if(null==b)return 0;if(a[1])try{return SmlPrims.chk_ovf_i32(-E(b))}catch(V){return function(a){a=
SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var d={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),d.$bn(c)]}}},f=d.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:f(SmlPrims.i32_to_w32(a))}a=c(a);if(function(a,c){for(;;){if(null==a)return null==c?!0:!1;if(null!=c&&a[0]==c[0])c=c[1],a=a[1];else return!1}}(b,a))return-2147483648;throw CompilerInitial.exn$Overflow$50;
}(V)}else return E(b)};basis$0IntInfRep$1.toInt31$1031=function(a){return SmlPrims.chk_ovf_i31(y(a))};basis$0IntInfRep$1.toInt32$1035=function(a){return y(a)};basis$0IntInfRep$1.toInt$1039=function(a){return y(a)};basis$0IntInfRep$1.fromInt$1043=function(a){switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&
1073741823)),b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var r={$bn:function(a){switch(a){case 0:return null;
default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),r.$bn(c)]}}};d=r.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};basis$0IntInfRep$1.fromInt32$1047=function(a){switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&
1073741823)),b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;
default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),g.$bn(c)]}}};d=g.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};basis$0IntInfRep$1.fromInt31$1051=function(a){switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&
1073741823)),b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;
default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),g.$bn(c)]}}};d=g.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};var I=function(a,c){var b=a[1],d=b[0];if(null==d)return c;var g=c[1],r=g[0];if(null==r)return a;if(b[1]){if(g[1])return a=a[1],b=a[1],[0,[f(a[0],c[1][0]),b]];if(null==d)var k=[r,!1];else if(null==r)k=[d,!0];else try{k=[u(r,d),!1]}catch(Q){k=function(a){if(a[0]==q)return[u(d,r),!0];throw a;}(Q)}return[0,
k]}if(g[1]){if(null==r)var p=[d,!1];else if(null==d)p=[r,!0];else try{p=[u(d,r),!1]}catch(Q){p=function(a){if(a[0]==q)return[u(r,d),!0];throw a;}(Q)}return[0,p]}a=a[1];b=a[1];return[0,[f(a[0],c[1][0]),b]]};basis$0IntInfRep$1.fromWord32$1156=function(a){if(2147483647>=a){var b=SmlPrims.chk_ovf_i32(a);switch(b){case 0:return[0,[null,!1]];default:if(0>b){if(-2147483648==b){b=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(b){case 0:b=null;break;default:var d={$bn:function(a){switch(a){case 0:return null;
default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),d.$bn(c)]}}};a=d.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:a(SmlPrims.i32_to_w32(b))}return[0,[c(b),!0]]}b=SmlPrims.chk_ovf_i32(-b);switch(b){case 0:b=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};a=f.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:a(SmlPrims.i32_to_w32(b))}return[0,
[b,!0]]}switch(b){case 0:b=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),g.$bn(c)]}}};a=g.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:a(SmlPrims.i32_to_w32(b))}return[0,[b,!1]]}}else{b=SmlPrims.chk_ovf_i32(SmlPrims.div_w32(a,3,CompilerInitial.exn$Div$47));switch(b){case 0:b=[0,[null,!1]];break;default:if(0>b)if(-2147483648==b){b=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));
switch(b){case 0:b=null;break;default:var r={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),r.$bn(c)]}}},k=r.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:k(SmlPrims.i32_to_w32(b))}b=[0,[c(b),!0]]}else{b=SmlPrims.chk_ovf_i32(-b);switch(b){case 0:b=null;break;default:var m={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),m.$bn(c)]}}};
k=m.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:k(SmlPrims.i32_to_w32(b))}b=[0,[b,!0]]}else{switch(b){case 0:b=null;break;default:var q={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),q.$bn(c)]}}};k=q.$bn;b=1073741823>=b?[SmlPrims.chk_ovf_i31(b),null]:k(SmlPrims.i32_to_w32(b))}b=[0,[b,!1]]}}a=SmlPrims.chk_ovf_i32(SmlPrims.mod_w32(a,3,CompilerInitial.exn$Div$47));switch(a){case 0:a=[0,[null,!1]];break;default:if(0>
a)if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var l={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),l.$bn(c)]}}};k=l.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:k(SmlPrims.i32_to_w32(a))}a=[0,[c(a),!0]]}else{a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var n={$bn:function(a){switch(a){case 0:return null;default:var c=
a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),n.$bn(c)]}}};k=n.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:k(SmlPrims.i32_to_w32(a))}a=[0,[a,!0]]}else{switch(a){case 0:a=null;break;default:var u={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),u.$bn(c)]}}};k=u.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:k(SmlPrims.i32_to_w32(a))}a=[0,[a,!1]]}}return I(I(I(b,b),b),a)}};basis$0IntInfRep$1.fromWord32X$1167=
function(a){a=SmlPrims.w32_to_i32_X(a);switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=
null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),g.$bn(c)]}}};d=g.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),
null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};basis$0IntInfRep$1.fromWord31X$1171=function(a){a=SmlPrims.w31_to_w32_X(a);a=SmlPrims.w32_to_i32_X(a);switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),
null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&
1073741823)),g.$bn(c)]}}};d=g.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};basis$0IntInfRep$1.fromWordX$1175=function(a){a=SmlPrims.w32_to_i32_X(a);switch(a){case 0:return[0,[null,!1]];default:if(0>a){if(-2147483648==a){a=SmlPrims.chk_ovf_i32(-SmlPrims.chk_ovf_i32(-2147483647));switch(a){case 0:a=null;break;default:var b={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),
b.$bn(c)]}}},d=b.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[c(a),!0]]}a=SmlPrims.chk_ovf_i32(-a);switch(a){case 0:a=null;break;default:var f={$bn:function(a){switch(a){case 0:return null;default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),f.$bn(c)]}}};d=f.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!0]]}switch(a){case 0:a=null;break;default:var g={$bn:function(a){switch(a){case 0:return null;
default:var c=a>>>30;return[SmlPrims.chk_ovf_i31(SmlPrims.chk_ovf_i32(a&1073741823)),g.$bn(c)]}}};d=g.$bn;a=1073741823>=a?[SmlPrims.chk_ovf_i31(a),null]:d(SmlPrims.i32_to_w32(a))}return[0,[a,!1]]}};basis$0IntInfRep$1.toWord32$1179=function(a){return SmlPrims.i32_to_w32(y(a))};basis$0IntInfRep$1.fromWord$1183=function(a){return basis$0IntInfRep$1.fromWord32$1156(a)};basis$0IntInfRep$1.toWord$1187=function(a){return SmlPrims.i32_to_w32(y(a))};basis$0IntInfRep$1.fromWord8$1191=function(a){return basis$0IntInfRep$1.fromWord32$1156(a)};
basis$0IntInfRep$1.fromWord8X$1195=function(a){if(128>a)return basis$0IntInfRep$1.fromWord32$1156(a);a=basis$0IntInfRep$1.fromWord32$1156((255-a&255)+1&255);var c=a[1],b=c[0];return null==b?a:c[1]?[0,[b,!1]]:[0,[b,!0]]};basis$0IntInfRep$1.toWord8$1203=function(a){return 255&SmlPrims.i32_to_w32(y(a))};basis$0IntInfRep$1.fromWord31$1207=function(a){return basis$0IntInfRep$1.fromWord32$1156(a)};basis$0IntInfRep$1.toWord31$1211=function(a){return SmlPrims.i32_to_w32(y(a))&2147483647};basis$0IntInfRep$1.s$p$1215=
function(a){var c=a[1],b=c[0];return null==b?a:c[1]?[0,[b,!1]]:[0,[b,!0]]};basis$0IntInfRep$1.s$t$1216=function(a,c){var b=c[1],d=b[0];if(null==d)return[0,[null,!1]];var f=a[1],g=f[0];return null==g?[0,[null,!1]]:f[1]?b[1]?[0,[J(a[1][0],c[1][0]),!1]]:[0,[J(g,d),!0]]:b[1]?[0,[J(g,d),!0]]:[0,[J(a[1][0],c[1][0]),!1]]};basis$0IntInfRep$1.s$f$1259=function(a){return I(a[0],a[1])};basis$0IntInfRep$1.s$g$1260=function(a,c){var b=c[1],d=b[0];if(null==d)return a;var g=a[1],k=g[0];if(null==k)return[0,[d,b[1]?
!1:!0]];if(g[1]){if(b[1]){if(null==k)var m=[d,!1];else if(null==d)m=[k,!0];else try{m=[u(d,k),!1]}catch(Q){m=function(a){if(a[0]==q)return[u(k,d),!0];throw a;}(Q)}return[0,m]}a=a[1];b=a[1];return[0,[f(a[0],c[1][0]),b]]}if(b[1])return a=a[1],b=a[1],[0,[f(a[0],c[1][0]),b]];if(null==d)var r=[k,!1];else if(null==k)r=[d,!0];else try{r=[u(k,d),!1]}catch(Q){r=function(a){if(a[0]==q)return[u(d,k),!0];throw a;}(Q)}return[0,r]};var S=function(a,b){a=a[1];if(a[1]){b=b[1];if(b[1])return a=G(a[0],b[0]),b=a[1],
[[0,[a[0],!1]],null==b?[0,[null,!1]]:[0,[b,!0]]];b=b[0];a=G(k(a[0]),b);var d=a[1];return[[0,[c(a[0]),!0]],[0,[k(u(b,d)),!1]]]}b=b[1];if(b[1]){d=a[0];if(null==d)return[[0,[null,!1]],[0,[null,!1]]];a=b[0];d=G(k(d),a);b=d[1];d=[0,[c(d[0]),!0]];a=k(u(a,b));return[d,null==a?[0,[null,!1]]:[0,[a,!0]]]}a=G(a[0],b[0]);return[[0,[a[0],!1]],[0,[a[1],!1]]]};basis$0IntInfRep$1.div$1396=function(a){return S(a[0],a[1])[0]};basis$0IntInfRep$1.mod$1404=function(a){return S(a[0],a[1])[1]};basis$0IntInfRep$1.abs$1412=
function(a){var c=a[1];return c[1]?[0,[c[0],!1]]:a};var A=function(a,c){a=a[1];if(a[1])return c=c[1],c[1]?H(c[0],a[0]):0;c=c[1];return c[1]?1:H(a[0],c[0])};basis$0IntInfRep$1.s$j$1456=function(a){switch(A(a[0],a[1])){case 0:return!0;default:return!1}};basis$0IntInfRep$1.s$l$1464=function(a){switch(A(a[0],a[1])){case 1:return!0;default:return!1}};basis$0IntInfRep$1.s$jk$1472=function(a){switch(A(a[0],a[1])){case 1:return!1;default:return!0}};basis$0IntInfRep$1.s$lk$1480=function(a){switch(A(a[0],a[1])){case 0:return!1;
default:return!0}};return 0})();"undefined"==typeof basis$0Int32$1&&(basis$0Int32$1={});
(function(){basis$0Int32$1.quot$57=function(a,c){if(0==c)throw CompilerInitial.exn$Div$47;return SmlPrims.chk_ovf_i32(SmlPrims.quot(a,c))};basis$0Int32$1.rem$68=function(a,c){if(0==c)throw CompilerInitial.exn$Div$47;return a%c};basis$0Int32$1.toLarge$87=function(a){return basis$0IntInfRep$1.fromInt32$1047(a)};basis$0Int32$1.fromLarge$91=function(a){return basis$0IntInfRep$1.toInt32$1035(a)};basis$0Int32$1.toInt$95=function(a){return a};basis$0Int32$1.fromInt$99=function(a){return a};basis$0Int32$1.precision$103=
[0,32];basis$0Int32$1.maxInt$104=[0,2147483647];basis$0Int32$1.minInt$105=[0,-2147483648];basis$0Int32$1.s$p$106=function(a){return SmlPrims.chk_ovf_i32(-a)};basis$0Int32$1.s$t$108=function(a,c){return SmlPrims.chk_ovf_i32(a*c)};basis$0Int32$1.div$110=function(a,c){return SmlPrims.div_i32(a,c,CompilerInitial.exn$Div$47)};basis$0Int32$1.mod$112=function(a,c){return SmlPrims.mod_i32(a,c,CompilerInitial.exn$Div$47)};basis$0Int32$1.s$f$114=function(a,c){return SmlPrims.chk_ovf_i32(a+c)};basis$0Int32$1.s$g$116=
function(a,c){return SmlPrims.chk_ovf_i32(a-c)};basis$0Int32$1.compare$118=function(a,c){return a<c?0:a>c?1:2};basis$0Int32$1.abs$133=function(a){return SmlPrims.chk_ovf_i32(Math.abs(a))};basis$0Int32$1.min$135=function(a,c){return a<c?a:c};basis$0Int32$1.max$146=function(a,c){return a<c?c:a};basis$0Int32$1.sign$157=function(a){return 0<a?1:0>a?-1:0};basis$0Int32$1.sameSign$169=function(a,c){return(0<a?1:0>a?-1:0)==(0<c?1:0>c?-1:0)};var b=function(a,c){if(basis$0General$1.eq_option$258(function(a){return a[0]==
a[1]},[[0,c],basis$0Int32$1.minInt$105]))switch(a){case 2:return"~10000000000000000000000000000000";case 8:return"~20000000000";case 10:return"~2147483648";case 16:return"~80000000";default:throw[basis$0Initial$1.en$Fail$54,"conv"];}else{var b=function(c,b){for(;;)switch(c){case 0:return b;default:var d=SmlPrims.div_i32(c,a,CompilerInitial.exn$Div$47);c=SmlPrims.mod_i32(c,a,CompilerInitial.exn$Div$47);10>c?(c=SmlPrims.chk_ovf_i32(c+48),c=basis$0Char$1.chr$73(c)):(c=SmlPrims.chk_ovf_i32(c+55),c=basis$0Char$1.chr$73(c));
b=[c,b];c=d}};if(0>c){c=SmlPrims.chk_ovf_i32(-c);var f=SmlPrims.div_i32(c,a,CompilerInitial.exn$Div$47);c=SmlPrims.mod_i32(c,a,CompilerInitial.exn$Div$47);10>c?(c=SmlPrims.chk_ovf_i32(c+48),c=basis$0Char$1.chr$73(c)):(c=SmlPrims.chk_ovf_i32(c+55),c=basis$0Char$1.chr$73(c));b=[126,b(f,[c,null])]}else f=SmlPrims.div_i32(c,a,CompilerInitial.exn$Div$47),c=SmlPrims.mod_i32(c,a,CompilerInitial.exn$Div$47),10>c?(c=SmlPrims.chk_ovf_i32(c+48),c=basis$0Char$1.chr$73(c)):(c=SmlPrims.chk_ovf_i32(c+55),c=basis$0Char$1.chr$73(c)),
b=b(f,[c,null]);return SmlPrims.implode(b)}};basis$0Int32$1.scan$257=function(a,c,b){switch(a){case 3:var d=[function(a){return 48<=a?49>=a:!1},2];break;case 0:d=[function(a){return 48<=a?55>=a:!1},8];break;case 2:d=[function(a){return 48<=a?57>=a:!1},10];break;default:d=[function(a){return 48<=a&&57>=a?!0:97<=a&&102>=a?!0:65<=a?70>=a:!1},16]}var g=d[0],k=d[1],q=function(a,b){switch(b[0]){case 1:return[1];default:var d=b[1];b=d[0];d=d[1];var f=function(a,b,d){for(;;){var f=c(d);switch(f[0]){case 1:return[0,
[a,d]];default:f=f[1];var m=f[0];f=f[1];if(g(m))a=b([k,a,48<=m&&57>=m?SmlPrims.chk_ovf_i32(m-48):SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(m-55),32,CompilerInitial.exn$Div$47)]),d=f;else return[0,[a,d]]}}},m=1==a?function(a){var c=a[2];return SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(a[0]*a[1])+c)}:function(a){var c=a[2];return SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(a[0]*a[1])-c)};return g(b)?f(SmlPrims.chk_ovf_i32(a*(48<=b&&57>=b?SmlPrims.chk_ovf_i32(b-48):SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(b-
55),32,CompilerInitial.exn$Div$47))),m,d):[1]}};d=function(b,d){switch(d[0]){case 1:return[1];default:var f=d[1];switch(f[0]){case 48:if(d=f[1],basis$0StringCvt$1.eq_radix$306(a,1))switch(f=c(d),f[0]){case 1:return[0,[0,d]];default:var g=f[1];switch(g[0]){case 120:switch(f=c(g[1]),b=q(b,f),b[0]){case 1:return[0,[0,d]];default:return b}case 88:switch(f=c(g[1]),b=q(b,f),b[0]){case 1:return[0,[0,d]];default:return b}default:switch(b=q(b,f),b[0]){case 1:return[0,[0,d]];default:return b}}}else switch(f=
c(d),b=q(b,f),b[0]){case 1:return[0,[0,d]];default:return b}default:return q(b,d)}}};b=c(basis$0StringCvt$1.dropl$250(function(a){return 32==a?!0:9<=a?13>=a:!1},c,b));switch(b[0]){case 1:return[1];default:var l=b[1];switch(l[0]){case 126:return d(-1,c(l[1]));case 45:return d(-1,c(l[1]));case 43:return d(1,c(l[1]));default:return d(1,b)}}};basis$0Int32$1.fmt$446=function(a){switch(a){case 3:return function(a){return b(2,a)};case 0:return function(a){return b(8,a)};case 2:return function(a){return b(10,
a)};default:return function(a){return b(16,a)}}};basis$0Int32$1.toString$458=function(a){return b(10,a)};basis$0Int32$1.fromString$462=function(a){var c=basis$0StringCvt$1.scanString$163;return c(function(a){return function(c){return basis$0Int32$1.scan$257(2,a,c)}},a)};basis$0Int32$1.s$l$466=function(a,c){return a>c};basis$0Int32$1.s$lk$468=function(a,c){return a>=c};basis$0Int32$1.s$j$470=function(a,c){return a<c};basis$0Int32$1.s$jk$472=function(a,c){return a<=c};return 0})();
"undefined"==typeof js$0JsCore$1&&(js$0JsCore$1={});
(function(){js$0JsCore$1.unit$63=0;js$0JsCore$1.int$64=0;js$0JsCore$1.string$65=0;js$0JsCore$1.real$66=0;js$0JsCore$1.fptr$67=0;js$0JsCore$1.bool$68=0;js$0JsCore$1.option$69=function(a){return 0};js$0JsCore$1.s$kkl$72=function(a,c){return 0};js$0JsCore$1.s$kkkl$75=function(a,c,b){return 0};js$0JsCore$1.s$kkkkl$78=function(a,c,b,f){return 0};js$0JsCore$1.exec0$81=function(a,c){return function(a){return(new Function("",c))()}};js$0JsCore$1.exec1$90=function(a,c,b){var d=a[0];return function(a){return(new Function(d,
b))(a)}};js$0JsCore$1.exec2$105=function(a,c,b,f){var d=a[0],k=c[0];return function(a){return(new Function(d+","+k,f))(a[0],a[1])}};js$0JsCore$1.exec3$128=function(a,c,b,f,g){var d=a[0],q=c[0],l=b[0];return function(a){return(new Function(d+","+q+","+l,g))(a[0],a[1],a[2])}};js$0JsCore$1.exec4$158=function(a,c,b,f,g,k){var d=a[0],l=c[0],m=b[0],u=f[0];return function(a){return(new Function(d+","+l+","+m+","+u,k))(a[0],a[1],a[2],a[3])}};js$0JsCore$1.exec5$195=function(a,c,b,f,g,k,q){var d=a[0],m=c[0],
u=b[0],C=f[0],D=g[0];return function(a){return(new Function(d+","+m+","+u+","+C+","+D,q))(a[0],a[1],a[2],a[3],a[4])}};js$0JsCore$1.exec10$239=function(a,c,b,f,g,k,q,l,m,u,C,D){var d=a[0],n=b[0],N=f[0],K=g[0],G=k[0],L=q[0],H=l[0],O=m[0],E=u[0],y=c[0];return function(a){return(new Function(d+","+n+","+N+","+K+","+G+","+L+","+H+","+O+","+E+","+y,D))(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9])}};js$0JsCore$1.call0$318=function(a,c){return(new Function("","return "+a+"()"))()};js$0JsCore$1.call1$325=
function(a,c,b){return function(c){return(new Function("a0","return "+a+"(a0)"))(c)}};js$0JsCore$1.call2$337=function(a,c,b,f){return function(c){return(new Function("a1,a0","return "+a+"(a1,a0)"))(c[0],c[1])}};js$0JsCore$1.call3$354=function(a,c,b,f,g){return function(c){return(new Function("a2,a1,a0","return "+a+"(a2,a1,a0)"))(c[0],c[1],c[2])}};js$0JsCore$1.call4$375=function(a,c,b,f,g,k){return function(c){return(new Function("a3,a2,a1,a0","return "+a+"(a3,a2,a1,a0)"))(c[0],c[1],c[2],c[3])}};js$0JsCore$1.method0$400=
function(a,c,b){return(new Function("obj","return obj."+b+"();"))(c)};js$0JsCore$1.method1$410=function(a,c,b,f,g){return(new Function("obj,a","return obj."+f+"(a);"))(b,g)};js$0JsCore$1.method2$426=function(a,c,b,f,g,k,q){return(new Function("obj,a1,a2","return obj."+g+"(a1,a2);"))(f,k,q)};js$0JsCore$1.method3$448=function(a,c,b,f,g,k,q,l,m){return js$0JsCore$1.exec4$158(["obj",js$0JsCore$1.fptr$67],["a1",a],["a2",c],["a3",b],f,"return obj."+k+"(a1,a2,a3);")([g,q,l,m])};js$0JsCore$1.method4$476=
function(a,c,b,f,g,k,q,l,m,u,C){return js$0JsCore$1.exec5$195(["obj",js$0JsCore$1.fptr$67],["a1",a],["a2",c],["a3",b],["a4",f],g,"return obj."+q+"(a1,a2,a3,a4);")([k,l,m,u,C])};js$0JsCore$1.getProperty$510=function(a,c,b){return a[b]};js$0JsCore$1.setProperty$520=function(a,c,b,f){a[b]=f};js$0JsCore$1.empty$533=function(a){return[]};js$0JsCore$1.push$536=function(a,c,b){c.push(b);return c};js$0JsCore$1.fromList$552=function(a){var c=[];return function(a){a:for(;;){if(null==a){a=c;break a}var b=a[1];
c.push(a[0]);a=b}return a}};js$0JsCore$1.empty$562=function(a){return{}};js$0JsCore$1.get$565=function(a,c,b){return c[b]};js$0JsCore$1.set$575=function(a,c,b,f){c[b]=f};js$0JsCore$1.fromList$588=function(a){var c={};return function(a){a:for(;;){if(null==a){a=c;break a}var b=a;a=b[0];b=b[1];c[a[0]]=a[1];a=b}return a}};js$0JsCore$1.P$611=function(a,c){return[2,[a,c]]};var b={$arrToFptr:function(a){switch(a[0]){case 6:var c=[];a:for(a=a[1];;){if(null==a)break a;var d=a[1];b.$pushArr(c,a[0]);a=d}return c;
default:throw[basis$0Initial$1.en$Fail$54,"arrToFptr expects array"];}},$setPropObj:function(a,c,d){switch(d[0]){case 0:a[c]=d[1];break;case 5:a[c]=d[1];break;case 3:a[c]=d[1];break;case 1:a[c]=d[1];break;case 4:a[c]=d[1];break;case 2:return b.$setPropObj(a,c,[4,b.$objToFptr(d)]);case 7:return b.$setPropObj(a,c,[4,b.$objToFptr(d)]);default:return b.$setPropObj(a,c,[4,b.$arrToFptr(d)])}},$setProps:function(a,c){switch(c[0]){case 2:return c=c[1],b.$setPropObj(a,c[0],c[1]);case 7:c=c[1];var d=c[1];b.$setProps(a,
c[0]);return b.$setProps(a,d);default:throw[basis$0Initial$1.en$Fail$54,"setProps expecting P or />"];}},$objToFptr:function(a){var c={};b.$setProps(c,a);return c},$pushArr:function(a,c){switch(c[0]){case 0:return a.push(c[1]),a,0;case 5:return a.push(c[1]),a,0;case 3:return a.push(c[1]),a,0;case 1:return a.push(c[1]),a,0;case 4:return a.push(c[1]),a,0;case 6:return b.$pushArr(a,[4,b.$arrToFptr(c)]);default:return b.$pushArr(a,[4,b.$objToFptr(c)])}}};js$0JsCore$1.arrToFptr$619=b.$arrToFptr;js$0JsCore$1.objToFptr$622=
b.$objToFptr;return 0})();"undefined"==typeof js$0Js$1&&(js$0Js$1={});
(function(){js$0Js$1.eq_eventType$826=function(a,c){switch(a){case 0:switch(c){case 0:return!0;default:return!1}case 1:switch(c){case 1:return!0;default:return!1}case 2:switch(c){case 2:return!0;default:return!1}case 3:switch(c){case 3:return!0;default:return!1}case 4:switch(c){case 4:return!0;default:return!1}case 5:switch(c){case 5:return!0;default:return!1}}};js$0Js$1.fromDoc$80=function(a){return a};js$0Js$1.nsFromString$84=function(a){return a};js$0Js$1.document$88=document;js$0Js$1.window$91=
function(){return this}();js$0Js$1.openWindow$94=function(a,c,b){return window.open(a,c,b)};js$0Js$1.windowDocument$109=function(a){return a.document};js$0Js$1.closeWindow$116=function(a){a.close()};js$0Js$1.documentWrite$123=function(a,c){return a.write(c)};js$0Js$1.getElementById$134=function(a,c){return SmlPrims.option(a.getElementById(c))};js$0Js$1.parent$145=function(a){return SmlPrims.option(a.parentNode)};js$0Js$1.firstChild$152=function(a){return SmlPrims.option(a.firstChild)};js$0Js$1.lastChild$159=
function(a){return SmlPrims.option(a.lastChild)};js$0Js$1.nextSibling$166=function(a){return SmlPrims.option(a.nextSibling)};js$0Js$1.previousSibling$173=function(a){return SmlPrims.option(a.previousSibling)};js$0Js$1.innerHTML$180=function(a,c){a.innerHTML=c};js$0Js$1.installEventHandler$197=function(a,c,b){switch(c){case 4:c="e.onclick = f;";break;case 5:c="e.onchange = f;";break;case 3:c="e.onkeypress = f;";break;case 2:c="e.onkeyup = f;";break;case 0:c="e.onmouseover = f;";break;default:c="e.onmouseout = f;"}return(new Function("e,f",
c))(a,b)};js$0Js$1.getEventHandler$226=function(a,c){return[1]};var b=document.all?!0:!1;js$0Js$1.onMouseMove$276=b?function(a){return function(c){return function(a,c){return a.onmousemove=function(b){c([event.clientX+a.body.scrollLeft,event.clientY+a.body.scrollTop])}}(a,function(a){var b=a[0];a=a[1];return c([0>b?0:b,0>a?0:a])})}}:function(a){return function(c){return function(a,c){return a.onmousemove=function(a){c([a.pageX,a.pageY])}}(a,function(a){var b=a[0];a=a[1];return c([0>b?0:b,0>a?0:a])})}};
js$0Js$1.xElem$281=function(a){for(var c=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,a=a.offsetParent;return c};js$0Js$1.yElem$288=function(a){for(var c=0;a;)c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return c};js$0Js$1.onMouseMoveElem$340=b?function(a){return function(c){var b=function(a){for(var c=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,a=a.offsetParent;return c}(a),f=function(a){for(var c=0;a;)c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return c}(a);return function(a,
c){return a.ownerDocument.onmousemove=function(b){c([event.clientX+a.ownerDocument.body.scrollLeft,event.clientY+a.ownerDocument.body.scrollTop])}}(a,function(a){var d=a[1];a=SmlPrims.chk_ovf_i32(a[0]-b);a=0>a?0:a;d=SmlPrims.chk_ovf_i32(d-f);return c([a,0>d?0:d])})}}:function(a){return function(c){var b=function(a){for(var c=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,a=a.offsetParent;return c}(a),f=function(a){for(var c=0;a;)c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return c}(a);
return function(a,c){return a.ownerDocument.onmousemove=function(a){c([a.pageX,a.pageY])}}(a,function(a){var d=a[1];a=SmlPrims.chk_ovf_i32(a[0]-b);a=0>a?0:a;d=SmlPrims.chk_ovf_i32(d-f);return c([a,0>d?0:d])})}};js$0Js$1.setInterval$345=function(a,c){return setInterval(c,a)};js$0Js$1.clearInterval$358=function(a){return clearInterval(a)};js$0Js$1.setTimeout$366=function(a,c){return setTimeout(c,a)};js$0Js$1.clearTimeout$379=function(a){return clearTimeout(a)};js$0Js$1.value$387=function(a){return a.value};
js$0Js$1.documentElement$394=function(a){return a.documentElement};js$0Js$1.setCookie$401=function(a,c){a.cookie=c};js$0Js$1.getCookie$408=function(a){return a.cookie};js$0Js$1.setAttribute$423=function(a,c,b){return a.setAttribute(c,b)};js$0Js$1.setAttributeNS$438=function(a,c,b,f){return js$0JsCore$1.exec4$158(["ns",js$0JsCore$1.string$65],["e",js$0JsCore$1.fptr$67],["a",js$0JsCore$1.string$65],["b",js$0JsCore$1.string$65],js$0JsCore$1.unit$63,"return e.setAttributeNS(ns,a,b);")([a,c,b,f])};js$0Js$1.removeAttribute$457=
function(a,c){return a.removeAttribute(c)};js$0Js$1.createElement$468=function(a){return document.createElement(a)};js$0Js$1.createElementNS$472=function(a,c){return document.createElementNS(a,c)};js$0Js$1.createFragment$479=function(a){return document.createDocumentFragment()};js$0Js$1.createTextNode$482=function(a){return document.createTextNode(a)};js$0Js$1.appendChild$486=function(a,c){return a.appendChild(c)};js$0Js$1.removeChild$497=function(a,c){return a.removeChild(c)};js$0Js$1.replaceChild$508=
function(a,c,b){return a.replaceChild(c,b)};js$0Js$1.setStyle$523=function(a,c){a.style[c[0]]=c[1]};js$0Js$1.taga$558=function(a,c,b){a=document.createElement(a);a:for(;;){if(null==c)break a;var d=c;c=d[0];d=d[1];a.setAttribute(c[0],c[1]);c=d}a.appendChild(b);return a};js$0Js$1.nstaga$559=function(a,c,b,f){a=document.createElementNS(a,c);a:for(;;){if(null==b)break a;c=b;b=c[0];c=c[1];a.setAttribute(b[0],b[1]);b=c}a.appendChild(f);return a};js$0Js$1.tag$563=function(a){return function(b){var c=document.createElement(a);
a:{var f=null;for(;;){if(null==f)break a;var g=f;f=g[0];g=g[1];c.setAttribute(f[0],f[1]);f=g}}c.appendChild(b);return c}};js$0Js$1.nstag$567=function(a,b){return function(c){var d=document.createElementNS(a,b);a:{var g=null;for(;;){if(null==g)break a;var k=g;g=k[0];k=k[1];d.setAttribute(g[0],g[1]);g=k}}d.appendChild(c);return d}};js$0Js$1.taga0$593=function(a,b){a=document.createElement(a);a:for(;;){if(null==b)break a;var c=b;b=c[0];c=c[1];a.setAttribute(b[0],b[1]);b=c}return a};js$0Js$1.nstaga0$594=
function(a,b,d){a=document.createElementNS(a,b);a:for(;;){if(null==d)break a;b=d;d=b[0];b=b[1];a.setAttribute(d[0],d[1]);d=b}return a};js$0Js$1.tag0$598=function(a){a=document.createElement(a);a:{var b=null;for(;;){if(null==b)break a;var d=b;b=d[0];d=d[1];a.setAttribute(b[0],b[1]);b=d}}return a};js$0Js$1.nstag0$602=function(a,b){a=document.createElementNS(a,b);a:for(b=null;;){if(null==b)break a;var c=b;b=c[0];c=c[1];a.setAttribute(b[0],b[1]);b=c}return a};js$0Js$1.s$d$609=function(a){return document.createTextNode(a)};
js$0Js$1.s$c$613=function(a,b){var c=document.createDocumentFragment();c.appendChild(a);c.appendChild(b);return c};js$0Js$1.toForeignPtr$625=function(a){return a};js$0Js$1.fromForeignPtr$629=function(a){return a};js$0Js$1.new$633=function(a){return SmlPrims.newRequest()};js$0Js$1.openn$636=function(a,b){var c=b[1],f=b[2];b=b[0];return js$0JsCore$1.exec4$158(["r",js$0JsCore$1.fptr$67],["m",js$0JsCore$1.string$65],["u",js$0JsCore$1.string$65],["a",js$0JsCore$1.bool$68],js$0JsCore$1.unit$63,"return r.open(m,u,a);")([a,
c,f,b])};js$0Js$1.send$654=function(a,b){switch(b[0]){case 0:return a.send(b[1]);default:return a.send(null)}};js$0Js$1.sendBinary$680=function(a,b){return a.send(SmlPrims.stringToArrayBuffer(b))};js$0Js$1.setRequestHeader$691=function(a,b){return a.setRequestHeader(b[0],b[1])};js$0Js$1.setResponseType$706=function(a,b){a.responseType=b};js$0Js$1.state$717=function(a){return a.readyState};js$0Js$1.status$724=function(a){return SmlPrims.option(a.status)};js$0Js$1.onStateChange$731=function(a,b){a.onreadystatechange=
b};js$0Js$1.response$742=function(a){return SmlPrims.option(a.responseText)};js$0Js$1.responseArrBuf$749=function(a){return SmlPrims.option(SmlPrims.arraybufferToString(a.response))};js$0Js$1.abort$756=function(a){return a.abort()};js$0Js$1.random$763=function(a){return Math.random()};js$0Js$1.loadScript$769=function(a,b){var c=document.getElementsByTagName("head")[0],f=document.createElement("script");f.type="text/javascript";f.src=a;f.onreadystatechange=b;f.onload=b;return c.appendChild(f)};return 0})();
"undefined"==typeof tuscheme$0JsMap$1&&(tuscheme$0JsMap$1={});
(function(){tuscheme$0JsMap$1.empty$55=function(b){return new Map};tuscheme$0JsMap$1.clear$60=function(b){b.clear()};tuscheme$0JsMap$1.copy$67=function(b){return new Map(b)};tuscheme$0JsMap$1.fromList$74=function(b){return new Map(b)};tuscheme$0JsMap$1.get$78=function(b,a){return b.get(a)};tuscheme$0JsMap$1.has$89=function(b,a){return b.has(a)};tuscheme$0JsMap$1.set$100=function(b,a,c){b.set(a,c)};tuscheme$0JsMap$1.delete$114=function(b,a){return b.delete(a)};tuscheme$0JsMap$1.size$125=function(b){return b.size};
tuscheme$0JsMap$1.forEach$132=function(b,a){return function(a,b){a.forEach(function(a,c){b([c,a])})}(b,a)};tuscheme$0JsMap$1.lookup$143=function(b,a){return b.has(a)?[0,b.get(a)]:[1]};return 0})();"undefined"==typeof tuscheme$0stubs$1&&(tuscheme$0stubs$1={});
(function(){tuscheme$0stubs$1.getEnv$54=function(b){return[1]};tuscheme$0stubs$1.en$IO_Io$64=new String("IO_Io");tuscheme$0stubs$1.outputBuf$65=[""];tuscheme$0stubs$1.stdOut$66=0;tuscheme$0stubs$1.stdErr$67=0;tuscheme$0stubs$1.output$68=function(b,a){return tuscheme$0stubs$1.outputBuf$65[0]+=a,0};tuscheme$0stubs$1.output1$73=function(b,a){return tuscheme$0stubs$1.outputBuf$65[0]+=SmlPrims.implode([a,null]),0};tuscheme$0stubs$1.print$78=function(b){return tuscheme$0stubs$1.outputBuf$65[0]+=b,0};tuscheme$0stubs$1.filemap$82=
function(b){return tuscheme_filemap};tuscheme$0stubs$1.inputLine$85=function(b,a){b=tuscheme$0JsMap$1.lookup$143(tuscheme_filemap,b);switch(b[0]){case 1:return[1];default:return b=basis$0Substring$1.extract$129(b[1],a[0],[1]),b=basis$0Substring$1.takel$836(function(a){return 10==a?!1:!0},b),a[0]=SmlPrims.chk_ovf_i32(SmlPrims.chk_ovf_i32(a[0]+b[2])+1),0,[0,basis$0Substring$1.string$117(b[0],b[1],b[2])+"\n"]}};tuscheme$0stubs$1.openIn$106=function(b){if(tuscheme_filemap.has(b))return[b,[0]];throw[basis$0Initial$1.en$Fail$54,
"nonexistent file"];};tuscheme$0stubs$1.closeIn$114=function(b,a){return 0};tuscheme$0stubs$1.stdIn$118=["<stdin>",[0]];tuscheme$0stubs$1.print$119=function(b){return tuscheme$0stubs$1.outputBuf$65[0]+=b,0};return 0})();"undefined"==typeof tuscheme$0tuscheme$1&&(tuscheme$0tuscheme$1={});
(function(){tuscheme$0tuscheme$1.eq_error$4919=function(a,b){var e=b[0];b=b[1];switch(e[0]){case 0:switch(b[0]){case 0:return a([e[1],b[1]]);default:return!1}case 1:switch(b[0]){case 1:return e[1]==b[1];default:return!1}}};tuscheme$0tuscheme$1.eq_input_interactivity$4929=function(a,b){switch(a){case 0:switch(b){case 0:return!0;default:return!1}case 1:switch(b){case 1:return!0;default:return!1}}};tuscheme$0tuscheme$1.eq_output_interactivity$4933=function(a,b){switch(a){case 0:switch(b){case 0:return!0;
default:return!1}case 1:switch(b){case 1:return!0;default:return!1}}};tuscheme$0tuscheme$1.eq_collection$4937=function(a,b){var e=b[0];b=b[1];switch(b[0]){case 0:return function(b,e){for(;;){if(null==b)return null==e?!0:!1;if(null!=e&&a([b[0],e[0]]))e=e[1],b=b[1];else return!1}}(e[1],b[1]);default:return!1}};tuscheme$0tuscheme$1.eq_error_format$4944=function(a,b){switch(a){case 0:switch(b){case 0:return!0;default:return!1}case 1:switch(b){case 1:return!0;default:return!1}}};tuscheme$0tuscheme$1.eq_eol_marked$4948=
function(a,b){var e=b[0];b=b[1];switch(e[0]){case 0:switch(b[0]){case 0:return a([e[1],b[1]]);default:return!1}case 1:switch(b[0]){case 1:return e[1]==b[1];default:return!1}}};tuscheme$0tuscheme$1.eq_bracket_shape$4958=function(a,b){switch(a){case 0:switch(b){case 0:return!0;default:return!1}case 1:switch(b){case 1:return!0;default:return!1}case 2:switch(b){case 2:return!0;default:return!1}}};tuscheme$0tuscheme$1.eq_plus_brackets$4962=function(a,b){var e=b[0];b=b[1];switch(e[0]){case 0:switch(b[0]){case 0:a=
b[1];switch(e[1]){case 0:switch(a){case 0:return!0;default:return!1}case 1:switch(a){case 1:return!0;default:return!1}case 2:switch(a){case 2:return!0;default:return!1}}break;default:return!1}break;case 1:switch(b[0]){case 1:return a([e[1],b[1]]);default:return!1}case 2:switch(b[0]){case 2:a=b[1];switch(e[1]){case 0:switch(a){case 0:return!0;default:return!1}case 1:switch(a){case 1:return!0;default:return!1}case 2:switch(a){case 2:return!0;default:return!1}}break;default:return!1}}};tuscheme$0tuscheme$1.eq_right_result$4973=
function(a,b){switch(a[0]){case 0:switch(b[0]){case 0:return a=a[1],b=b[1],a[0]==b[0]?a[1]==b[1]:!1;default:return!1}case 1:switch(b[0]){case 1:return!0;default:return!1}case 2:switch(b[0]){case 2:a=a[1];b=b[1];var e=a[0],c=b[0];if(e[0]==c[0]&&e[1]==c[1])switch(b=b[1],a[1]){case 0:switch(b){case 0:return!0;default:return!1}case 1:switch(b){case 1:return!0;default:return!1}case 2:switch(b){case 2:return!0;default:return!1}}else return!1;break;default:return!1}}};var b={$eq_kind:function(a,c){for(;;){if(null==
a)return null==c?!0:!1;if(null!=c&&function(a,e){for(;;){if(null==a)return null==e?!0:!1;if(null!=e&&b.$eq_kind(a[0],e[0]))e=e[1],a=a[1];else return!1}}(a[0],c[0]))c=c[1],a=a[1];else return!1}}};tuscheme$0tuscheme$1.eq_kind$4988=b.$eq_kind;var a={$eq_tyex:function(b,c){a:for(;;)switch(b[0]){case 0:switch(c[0]){case 0:return b[1]==c[1];default:return!1}case 1:switch(c[0]){case 1:return b[1]==c[1];default:return!1}case 2:switch(c[0]){case 2:if(b=b[1],c=c[1],function(b,e){for(;;){if(null==b)return null==
e?!0:!1;if(null!=e&&a.$eq_tyex(b[0],e[0]))e=e[1],b=b[1];else return!1}}(b[0],c[0])){c=c[1];b=b[1];continue a}else return!1;default:return!1}case 3:switch(c[0]){case 3:if(b=b[1],c=c[1],function(a,b){for(;;){if(null==a)return null==b?!0:!1;if(null!=b&&a[0]==b[0])b=b[1],a=a[1];else return!1}}(b[0],c[0])){c=c[1];b=b[1];continue a}else return!1;default:return!1}case 4:switch(c[0]){case 4:return b=b[1],c=c[1],a.$eq_tyex(b[0],c[0])?function(b,e){for(;;){if(null==b)return null==e?!0:!1;if(null!=e&&a.$eq_tyex(b[0],
e[0]))e=e[1],b=b[1];else return!1}}(b[1],c[1]):!1;default:return!1}}}};tuscheme$0tuscheme$1.eq_tyex$4995=a.$eq_tyex;tuscheme$0tuscheme$1.eq_let_kind$5015=function(a,b){switch(a[0]){case 0:switch(b[0]){case 0:return!0;default:return!1}case 1:switch(b[0]){case 1:return!0;default:return!1}}};tuscheme$0tuscheme$1.eq_pretoken$5019=function(a,b){switch(a[0]){case 0:switch(b[0]){case 0:return a[1]==b[1];default:return!1}case 1:switch(b[0]){case 1:return!0;default:return!1}case 2:switch(b[0]){case 2:return a[1]==
b[1];default:return!1}case 3:switch(b[0]){case 3:return a[1]==b[1];default:return!1}}};tuscheme$0tuscheme$1.en$TypeError$87=new String("TypeError");tuscheme$0tuscheme$1.en$BugInTypeChecking$88=new String("BugInTypeChecking");tuscheme$0tuscheme$1.id$89=function(a){return a};tuscheme$0tuscheme$1.fst$93=function(a,b){return a};tuscheme$0tuscheme$1.snd$100=function(a,b){return b};tuscheme$0tuscheme$1.pair$107=function(a,b){return[a,b]};tuscheme$0tuscheme$1.curry$114=function(a,b,c){return a([b,c])};tuscheme$0tuscheme$1.curry3$124=
function(a,b,c,d){return a([b,c,d])};tuscheme$0tuscheme$1.emptyEnv$137=function(a){return null};tuscheme$0tuscheme$1.en$NotFound$138=new String("NotFound");tuscheme$0tuscheme$1.find$139=function(a,b){for(;;){if(null==b)throw[tuscheme$0tuscheme$1.en$NotFound$138,a];var c=b[0],e=c[1];if(a==c[0])return e;b=b[1]}};tuscheme$0tuscheme$1.en$BindListLength$164=new String("BindListLength");tuscheme$0tuscheme$1.exn$BindListLength$164=[tuscheme$0tuscheme$1.en$BindListLength$164];tuscheme$0tuscheme$1.bind$165=
function(a,b,c){return[[a,b],c]};tuscheme$0tuscheme$1.bindList$174=function(a,b,c){for(;;){if(null==a){if(null==b)return c;throw tuscheme$0tuscheme$1.exn$BindListLength$164;}if(null==b)throw tuscheme$0tuscheme$1.exn$BindListLength$164;var e=b;b=e[1];c=[[a[0],e[0]],c];a=a[1]}};tuscheme$0tuscheme$1.duplicatename$205=function(a,b){for(;;){if(null==b)return[1];var c=b;b=c[0];c=c[1];b:{var e=c;for(;;){if(null==e){e=!1;break b}var h=e[1];if(a([e[0],b])){e=!0;break b}e=h}}if(e)return[0,b];b=c}};tuscheme$0tuscheme$1.en$RuntimeError$225=
new String("RuntimeError");tuscheme$0tuscheme$1.errorIfDups$226=function(a,b,c){a:for(;;){if(null==b){b=[1];break a}var e=b;b=e[0];e=e[1];c:{var h=e;for(;;){if(null==h){h=!1;break c}if(h[0]==b){h=!0;break c}h=h[1]}}if(h){b=[0,b];break a}b=e}switch(b[0]){case 1:return 0;default:throw[tuscheme$0tuscheme$1.en$RuntimeError$225,a+" "+b[1]+" appears twice in "+c];}};tuscheme$0tuscheme$1.en$InternalError$241=new String("InternalError");var c={$zip3:function(a,b,v){if(null==a){if(null==b&&null==v)return null;
throw basis$0ListPair$1.exn$UnequalLengths$54;}if(null==b)throw basis$0ListPair$1.exn$UnequalLengths$54;if(null==v)throw basis$0ListPair$1.exn$UnequalLengths$54;return[[a[0],b[0],v[0]],c.$zip3(a[1],b[1],v[1])]}};tuscheme$0tuscheme$1.zip3$242=c.$zip3;var d={$unzip3:function(a){if(null==a)return[null,null,null];var b=a[0],c=b[0],e=b[1];b=b[2];a=d.$unzip3(a[1]);return[[c,a[0]],[e,a[1]],[b,a[2]]]}};tuscheme$0tuscheme$1.unzip3$278=d.$unzip3;tuscheme$0tuscheme$1.reverse$307=function(a){return function(a){return basis$0List$1.rev$682(a)}};
var f={$optionList:function(a){if(null==a)return[0,null];var b=a[0];switch(b[0]){case 1:return[1];default:switch(b=b[1],a=f.$optionList(a[1]),a[0]){case 0:return[0,[b,a[1]]];default:return[1]}}}};tuscheme$0tuscheme$1.optionList$308=f.$optionList;tuscheme$0tuscheme$1.println$331=function(a){tuscheme$0stubs$1.print$119(a);return tuscheme$0stubs$1.print$119("\n")};tuscheme$0tuscheme$1.eprint$337=function(a){return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a)};tuscheme$0tuscheme$1.eprintln$341=
function(a){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a);return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n")};tuscheme$0tuscheme$1.predefinedFunctionError$347=function(a){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"while reading predefined functions, "+a);return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n")};tuscheme$0tuscheme$1.intString$351=function(a){a=basis$0Int32$1.toString$458(a);var b=a.length;if(0>b||16777211<b)throw CompilerInitial.exn$Size$53;
var c=Array(b);a:{var e=0;for(;;)if(e<b){var U=c,d=e;var f=a.charCodeAt(e);switch(f){case 126:f=45}U[d]=f;0;e=SmlPrims.chk_ovf_i32(e+1)}else break a}return SmlPrims.charArrayToString(c)};tuscheme$0tuscheme$1.plural$360=function(a,b){return null==b?a+"s":null==b[1]?a:a+"s"};tuscheme$0tuscheme$1.countString$383=function(a,b){var c=tuscheme$0tuscheme$1.intString$351;a:{var e=a,h=0;for(;;){if(null==e)break a;e=e[1];h=SmlPrims.chk_ovf_i32(h+1)}}return c(h)+" "+(null==a?b+"s":null==a[1]?b:b+"s")};tuscheme$0tuscheme$1.separate$390=
function(a,b){var c={$s:function(e){if(null==e)return a;var h=e[1];return null==h?e[0]:e[0]+b+c.$s(h)}},e=c.$s;return function(a){return e(a)}};tuscheme$0tuscheme$1.spaceSep$414;var g={$s:function(a){if(null==a)return"";var b=a[1];return null==b?a[0]:a[0]+" "+g.$s(b)}},k=g.$s;tuscheme$0tuscheme$1.spaceSep$414=function(a){return k(a)};tuscheme$0tuscheme$1.commaSep$415;var q={$s:function(a){if(null==a)return"";var b=a[1];return null==b?a[0]:a[0]+", "+q.$s(b)}},l=q.$s;tuscheme$0tuscheme$1.commaSep$415=
function(a){return l(a)};tuscheme$0tuscheme$1.printUTF8$416=function(a){var b=SmlPrims.i32_to_w32(a);if((b&2097151)!=b)throw[tuscheme$0tuscheme$1.en$RuntimeError$225,tuscheme$0tuscheme$1.intString$351(a)+" does not represent a Unicode code point"];0;return 65535<b?function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(a[0])));a=b}}([240|b>>>18,[128|b>>>12&63,[128|b>>>6&63,[128|b&63,null]]]]):2047<b?
function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(a[0])));a=b}}([224|b>>>12,[128|b>>>6&63,[128|b&63,null]]]):127<b?function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(a[0])));a=b}}([192|b>>>6,[128|b&63,null]]):tuscheme$0stubs$1.output1$73(tuscheme$0stubs$1.stdOut$66,basis$0General$1.chr$194(SmlPrims.chk_ovf_i32(b)))};
tuscheme$0tuscheme$1.stripNumericSuffix$454=function(a){var b=basis$0List$1.rev$682;var c=function(b,c){for(;;){if(0>b)return c;var e=SmlPrims.chk_ovf_i32(b-1);c=[a.charCodeAt(b),c];b=e}}(SmlPrims.chk_ovf_i32(a.length-1),null);return function(b){for(;;){if(null==b)return a;var c=b;b=c[0];switch(b){case 45:return b=c[1],null==b?a:SmlPrims.implode(basis$0List$1.rev$682(b));default:if(c=c[1],48<=b&&57>=b)b=c;else return SmlPrims.implode(basis$0List$1.rev$682([b,c]))}}}(b(c))};tuscheme$0tuscheme$1.s$llk$483=
function(a,b){switch(a[0]){case 0:return b(a[1]);default:return[1,a[1]]}};tuscheme$0tuscheme$1.s$llkf$501=function(a,b){switch(a[0]){case 0:return[0,b(a[1])];default:return[1,a[1]]}};tuscheme$0tuscheme$1.errorList$509=function(a){var b=[0,null],c={$foldr:function(a){if(null==a)return b;var e=a[0];a=c.$foldr(a[1]);switch(e[0]){case 0:switch(a[0]){case 0:return[0,[e[1],a[1]]];default:return[1,a[1]]}default:switch(a[0]){case 1:return[1,e[1]+"; "+a[1]];default:return[1,e[1]]}}}},e=c.$foldr;return e(a)};
tuscheme$0tuscheme$1.noninteractive$547=[1,1];tuscheme$0tuscheme$1.prompts$548=function(a,b){switch(a){case 0:return!0;default:return!1}};tuscheme$0tuscheme$1.prints$557=function(a,b){switch(b){case 0:return!0;default:return!1}};tuscheme$0tuscheme$1.emptyset$566=function(a){return null};tuscheme$0tuscheme$1.member$567=function(a,b){return function(c){a:for(;;){if(null==c){c=!1;break a}var e=c[1];if(a([c[0],b])){c=!0;break a}c=e}return c}};tuscheme$0tuscheme$1.insert$574=function(a,b){var c=b[0];b=
b[1];a:{var e=b;for(;;){if(null==e){a=!1;break a}var h=e[1];if(a([e[0],c])){a=!0;break a}e=h}}return a?b:[c,b]};tuscheme$0tuscheme$1.union$585=function(a,b){a:{var c=b[1];b=b[0];for(;;){if(null==b)break a;var e=b;b=e[0];e=e[1];c:{var h=c;for(;;){if(null==h){h=!1;break c}var d=h[1];if(a([h[0],b])){h=!0;break c}h=d}}c=h?c:[b,c];b=e}}return c};tuscheme$0tuscheme$1.inter$592=function(a,b){var c=b[1];return basis$0List$1.filter$417(function(b){a:{var e=c;for(;;){if(null==e){b=!1;break a}var h=e[1];if(a([e[0],
b])){b=!0;break a}e=h}}return b},b[0])};tuscheme$0tuscheme$1.diff$602=function(a,b){var c=b[1];return basis$0List$1.filter$417(function(b){a:{var e=c;for(;;){if(null==e){b=!1;break a}var h=e[1];if(a([e[0],b])){b=!0;break a}e=h}}return b?!1:!0},b[0])};tuscheme$0tuscheme$1.elemsC$613=function(a){return a[1]};tuscheme$0tuscheme$1.singleC$621=function(a){return[0,[a,null]]};tuscheme$0tuscheme$1.emptyC$625=function(a){return[0,null]};tuscheme$0tuscheme$1.joinC$626=function(a){return[0,basis$0List$1.concat$296(basis$0List$1.map$697(function(a){return a[1]},
a[1]))]};tuscheme$0tuscheme$1.mapC$634=function(a,b){return[0,basis$0List$1.map$697(a,b[1])]};tuscheme$0tuscheme$1.filterC$648=function(a,b){return[0,basis$0List$1.filter$417(a,b[1])]};tuscheme$0tuscheme$1.mapC2$662=function(a,b){var c=b[1];b=basis$0List$1.map$697(function(b){return[0,basis$0List$1.map$697(function(c){return a([b,c])},c[1])]},b[0][1]);return[0,basis$0List$1.concat$296(basis$0List$1.map$697(function(a){return a[1]},b))]};tuscheme$0tuscheme$1.delay$680=function(a){return[[1,a]]};tuscheme$0tuscheme$1.demand$684=
function(a){var b=a[0];switch(b[0]){case 1:return b=(0,b[1])(0),a[0]=[0,b],0,b;default:return b[1]}};tuscheme$0tuscheme$1.streamGet$703=function(a){for(;;)switch(a[0]){case 1:return[1];case 2:return a=a[1],[0,[a[0],a[1]]];default:a=a[1];var b=a[0];switch(b[0]){case 1:b=(0,b[1])(0);a[0]=[0,b];0;a=b;break;default:a=b[1]}}};tuscheme$0tuscheme$1.streamOfList$721=function(a){var b=[1],c={$foldr:function(a){return null==a?b:[2,[a[0],c.$foldr(a[1])]]}},e=c.$foldr;return e(a)};var m={$listOfStream:function(a){a=
tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:return null;default:return a=a[1],[a[0],m.$listOfStream(a[1])]}}};tuscheme$0tuscheme$1.listOfStream$726=m.$listOfStream;tuscheme$0tuscheme$1.delayedStream$739=function(a){return[0,[[1,a]]]};var u={$streamOfEffects:function(a){return[0,[[1,function(b){b=a(0);switch(b[0]){case 1:return[1];default:return[2,[b[1],u.$streamOfEffects(a)]]}}]]]}};tuscheme$0tuscheme$1.streamOfEffects$743=u.$streamOfEffects;tuscheme$0tuscheme$1.filelines$755=function(a){return tuscheme$0tuscheme$1.streamOfEffects$743(function(b){return tuscheme$0stubs$1.inputLine$85(a[0],
a[1])})};var C={$streamRepeat:function(a){return[0,[[1,function(b){return[2,[a,C.$streamRepeat(a)]]}]]]}};tuscheme$0tuscheme$1.streamRepeat$761=C.$streamRepeat;var D={$streamOfUnfold:function(a,b){return[0,[[1,function(c){c=a(b);switch(c[0]){case 1:return[1];default:return c=c[1],[2,[c[0],D.$streamOfUnfold(a,c[1])]]}}]]]}};tuscheme$0tuscheme$1.streamOfUnfold$767=D.$streamOfUnfold;tuscheme$0tuscheme$1.naturals$785;var J={$streamOfUnfold:function(a){return[0,[[1,function(b){b=[0,[a,SmlPrims.chk_ovf_i32(a+
1)]];switch(b[0]){case 1:return[1];default:return b=b[1],[2,[b[0],J.$streamOfUnfold(b[1])]]}}]]]}},n=J.$streamOfUnfold;tuscheme$0tuscheme$1.naturals$785=n(0);tuscheme$0tuscheme$1.preStream$789=function(a,b){var c={$streamOfUnfold:function(b){return[0,[[1,function(e){a(0);e=tuscheme$0tuscheme$1.streamGet$703(b);switch(e[0]){case 1:return[1];default:return e=e[1],[2,[e[0],c.$streamOfUnfold(e[1])]]}}]]]}},e=c.$streamOfUnfold;return e(b)};tuscheme$0tuscheme$1.postStream$801=function(a,b){var c={$streamOfUnfold:function(a){return[0,
[[1,function(e){e=tuscheme$0tuscheme$1.streamGet$703(a);switch(e[0]){case 1:e=[1];break;default:b(e[1][0])}switch(e[0]){case 1:return[1];default:return e=e[1],[2,[e[0],c.$streamOfUnfold(e[1])]]}}]]]}},e=c.$streamOfUnfold;return e(a)};var N={$streamMap:function(a,b){return[0,[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(b);switch(c[0]){case 1:return[1];default:c=c[1];var e=c[1];return[2,[a(c[0]),N.$streamMap(a,e)]]}}]]]}};tuscheme$0tuscheme$1.streamMap$821=N.$streamMap;var K={$streamFilter:function(a,
b){return[0,[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(b);switch(c[0]){case 1:return[1];default:var e=c[1];c=e[0];e=e[1];return a(c)?[2,[c,K.$streamFilter(a,e)]]:K.$streamFilter(a,e)}}]]]}};tuscheme$0tuscheme$1.streamFilter$839=K.$streamFilter;tuscheme$0tuscheme$1.streamFold$861=function(a,b,c){for(;;)switch(c=tuscheme$0tuscheme$1.streamGet$703(c),c[0]){case 1:return b;default:var e=c[1],h=e[1];c=a;b=a([e[0],b]);a=c;c=h}};var G={$streamZip:function(a,b){return[0,[[1,function(c){var e=tuscheme$0tuscheme$1.streamGet$703(a);
c=tuscheme$0tuscheme$1.streamGet$703(b);switch(e[0]){case 0:switch(c[0]){case 0:return e=e[1],c=c[1],[2,[[e[0],c[0]],G.$streamZip(e[1],c[1])]];default:return[1]}default:return[1]}}]]]}};tuscheme$0tuscheme$1.streamZip$880=G.$streamZip;tuscheme$0tuscheme$1.streamConcat$909=function(a){var b={$streamOfUnfold:function(a){return[0,[[1,function(c){a:{var e=a[0];c=a[1];b:for(;;)switch(e=tuscheme$0tuscheme$1.streamGet$703(e),e[0]){case 0:e=e[1];c=[0,[e[0],[e[1],c]]];break a;default:switch(c=tuscheme$0tuscheme$1.streamGet$703(c),
c[0]){case 0:e=c[1];c=e[1];e=e[0];continue b;default:c=[1];break a}}}switch(c[0]){case 1:return[1];default:return c=c[1],[2,[c[0],b.$streamOfUnfold(c[1])]]}}]]]}},c=b.$streamOfUnfold;return c([[1],a])};tuscheme$0tuscheme$1.streamConcatMap$940=function(a,b){var c=tuscheme$0tuscheme$1.streamConcat$909,e={$streamMap:function(b){return[0,[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(b);switch(c[0]){case 1:return[1];default:c=c[1];var h=c[1];return[2,[a(c[0]),e.$streamMap(h)]]}}]]]}},h=e.$streamMap;
b=h(b);return c(b)};tuscheme$0tuscheme$1.s$nnn$947=function(a,b){var c=tuscheme$0tuscheme$1.streamConcat$909,e=[1],h={$foldr:function(a){return null==a?e:[2,[a[0],h.$foldr(a[1])]]}},d=h.$foldr;a=d([a,[b,null]]);return c(a)};var L={$streamTake:function(a,b){switch(a){case 0:return null;default:switch(b=tuscheme$0tuscheme$1.streamGet$703(b),b[0]){case 0:b=b[1];var c=b[1];return[b[0],L.$streamTake(SmlPrims.chk_ovf_i32(a-1),c)];default:return null}}}};tuscheme$0tuscheme$1.streamTake$954=L.$streamTake;
tuscheme$0tuscheme$1.streamDrop$978=function(a,b){a:for(;;)switch(a){case 0:return b;default:switch(b=tuscheme$0tuscheme$1.streamGet$703(b),b[0]){case 0:b=b[1][1];a=SmlPrims.chk_ovf_i32(a-1);continue a;default:return[1]}}};tuscheme$0tuscheme$1.pure$1000=function(a,b){return[0,[[0,a],b]]};tuscheme$0tuscheme$1.s$jtl$1007=function(a,b){return function(c){c=a(c);switch(c[0]){case 1:return[1];default:var e=c[1];c=e[0];switch(c[0]){case 1:return[0,[[1,c[1]],e[1]]];default:switch(c=c[1],e=b(e[1]),e[0]){case 1:return[1];
default:var h=e[1];e=h[0];switch(e[0]){case 1:return[0,[[1,e[1]],h[1]]];default:return h=h[1],[0,[[0,c(e[1])],h]]}}}}}};tuscheme$0tuscheme$1.s$jdl$1051=function(a,b){return tuscheme$0tuscheme$1.s$jtl$1007(function(b){return[0,[[0,a],b]]},b)};tuscheme$0tuscheme$1.s$jsl$1058=function(a,b){return function(c){var e=a(c);switch(e[0]){case 0:return[0,e[1]];default:return b(c)}}};tuscheme$0tuscheme$1.pzero$1075=function(a){return[1]};tuscheme$0tuscheme$1.anyParser$1078=function(a){var b={$foldr:function(a){if(null==
a)return function(a){return[1]};var c=a[0],e=b.$foldr(a[1]);return function(a){var b=c(a);switch(b[0]){case 0:return[0,b[1]];default:return e(a)}}}},c=b.$foldr;return c(a)};tuscheme$0tuscheme$1.s$jt$1082=function(a,b){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],a]]},a),b)};tuscheme$0tuscheme$1.s$tl$1089=function(a,b){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(a){return a}}],a]]},a),b)};tuscheme$0tuscheme$1.s$jd$1096=function(a,b){return tuscheme$0tuscheme$1.s$jtl$1007(function(b){return[0,[[0,function(b){return a}],b]]},b)};tuscheme$0tuscheme$1.one$1105=function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:return[1];default:return a=a[1],[0,[[0,a[0]],a[1]]]}};tuscheme$0tuscheme$1.eos$1118=function(a){switch(tuscheme$0tuscheme$1.streamGet$703(a)[0]){case 1:return[0,[[0,0],[1]]];default:return[1]}};tuscheme$0tuscheme$1.peek$1126=
function(a,b){a=a(b);switch(a[0]){case 0:switch(a=a[1][0],a[0]){case 0:return[0,a[1]];default:return[1]}default:return[1]}};tuscheme$0tuscheme$1.rewind$1145=function(a,b){a=a(b);switch(a[0]){case 0:return[0,[a[1][0],b]];default:return[1]}};tuscheme$0tuscheme$1.sat$1160=function(a,b,c){b=b(c);switch(b[0]){case 0:switch(c=b[1][0],c[0]){case 0:return a(c[1])?b:[1];default:return b}default:return b}};tuscheme$0tuscheme$1.eqx$1190=function(a,b,c,d){c=c(d);switch(c[0]){case 0:switch(d=c[1][0],d[0]){case 0:return a([b,
d[1]])?c:[1];default:return c}default:return c}};tuscheme$0tuscheme$1.s$jdlm$1197=function(a,b){return function(c){c=b(c);switch(c[0]){case 1:return[1];default:var e=c[1];c=e[0];switch(c[0]){case 1:return[0,[[1,c[1]],e[1]]];default:switch(e=e[1],c=a(c[1]),c[0]){case 1:return[1];default:return[0,[[0,c[1]],e]]}}}}};tuscheme$0tuscheme$1.s$jcl$1230=function(a,b){return function(c){var e=a(c);switch(e[0]){case 0:switch(e[1][0][0]){case 0:return b(c);default:return[1]}default:return[1]}}};tuscheme$0tuscheme$1.notFollowedBy$1250=
function(a,b){switch(a(b)[0]){case 1:return[0,[[0,0],b]];default:return[1]}};var H={$many:function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},a),function(b){return H.$many(a)(b)});var c=function(a){return[0,[[0,null],a]]};return function(a){var e=b(a);switch(e[0]){case 0:return[0,e[1]];default:return c(a)}}}};tuscheme$0tuscheme$1.many$1261=H.$many;tuscheme$0tuscheme$1.many1$1269=function(a){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return[a,b]}}],a]]},a),tuscheme$0tuscheme$1.many$1261(a))};tuscheme$0tuscheme$1.optional$1274=function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[0,a]}],a]]},a),c=[1];var e=function(a){return[0,[[0,c],a]]};return function(a){var c=b(a);switch(c[0]){case 0:return[0,c[1]];default:return e(a)}}};tuscheme$0tuscheme$1.s$jtla$1279=function(a,b){return function(c){c=tuscheme$0tuscheme$1.s$jtl$1007(a,b)(c);switch(c[0]){case 1:return[1];
default:c=c[1];var e=c[0];switch(e[0]){case 0:switch(e=e[1],e[0]){case 0:return[0,[[0,e[1]],c[1]]];default:return[0,[[1,e[1]],c[1]]]}default:return[0,[[1,e[1]],c[1]]]}}}};tuscheme$0tuscheme$1.s$jdla$1314=function(a,b){return tuscheme$0tuscheme$1.s$jtla$1279(function(b){return[0,[[0,a],b]]},b)};tuscheme$0tuscheme$1.srclocString$1321=function(a,b){return a+", line "+tuscheme$0tuscheme$1.intString$351(b)};tuscheme$0tuscheme$1.toplevel_error_format$1330=[0];tuscheme$0tuscheme$1.synerrormsg$1331=function(a,
b){return function(c){switch(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]){case 0:var e=!1;break;case 1:e=!0}return e&&"standard input"==a?SmlPrims.concat(["syntax error: ",c]):SmlPrims.concat(["syntax error in ",[a+", line "+tuscheme$0tuscheme$1.intString$351(b),[": ",c]]])}};tuscheme$0tuscheme$1.en$Located$1349=new String("Located");tuscheme$0tuscheme$1.atLoc$1350=function(a,b,c){try{return b(c)}catch(B){b=B;if(b[0]==tuscheme$0tuscheme$1.en$RuntimeError$225)throw[tuscheme$0tuscheme$1.en$Located$1349,
[a,B]];if(b[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==tuscheme$0stubs$1.en$IO_Io$64)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==CompilerInitial.en$Div$47)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==CompilerInitial.en$Overflow$50)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==CompilerInitial.en$Subscript$52)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==CompilerInitial.en$Size$53)throw[tuscheme$0tuscheme$1.en$Located$1349,
[a,B]];if(b[0]==tuscheme$0tuscheme$1.en$TypeError$87)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];if(b[0]==tuscheme$0tuscheme$1.en$BugInTypeChecking$88)throw[tuscheme$0tuscheme$1.en$Located$1349,[a,B]];throw B;}};tuscheme$0tuscheme$1.fillComplaintTemplate$1388=function(a,b){var c=basis$0Substring$1.position$841(" <at loc>",[a,0,a.length]),e=c[0];c=c[1];var h=c[0],d=c[1],f=c[2];h=9>f?[h,SmlPrims.chk_ovf_i32(d+f),0]:[h,SmlPrims.chk_ovf_i32(d+9),SmlPrims.chk_ovf_i32(f-9)];switch(b[0]){case 1:var F=
"";break;default:b=b[1];d=b[0];switch(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]){case 0:F=!1;break;case 1:F=!0}F=F&&"standard input"==d?"":" in "+(b[0]+", line "+tuscheme$0tuscheme$1.intString$351(b[1]))}F=[F,0,F.length];return 0==c[2]?a:basis$0Substring$1.concat$355([e,[F,[h,null]]])};tuscheme$0tuscheme$1.errorAt$1426=function(a,b){return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]};tuscheme$0tuscheme$1.locatedStream$1433=function(a,b){a=tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(a),
tuscheme$0tuscheme$1.streamDrop$978(1,tuscheme$0tuscheme$1.naturals$785));return tuscheme$0tuscheme$1.streamZip$880(a,b)};tuscheme$0tuscheme$1.drainLine$1443=function(a){a:for(;;)switch(a[0]){case 1:return[1];case 0:a=a[1];var b=a[0];switch(b[0]){case 1:b=(0,b[1])(0);a[0]=[0,b];0;a=b;break;default:a=b[1]}continue a;default:switch(a=a[1],a[0][0]){case 1:return a[1];default:a=a[1]}}};tuscheme$0tuscheme$1.eol$1487=function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=
a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 1:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.inline$1491=function(a){var b=tuscheme$0tuscheme$1.many$1261(function(a){return tuscheme$0tuscheme$1.eol$1487(a)});a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],
a]]},b),function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:return[1];default:return a=a[1],[0,[[0,a[0]],a[1]]]}})(a);switch(a[0]){case 1:return[1];default:switch(a=a[1],b=a[0],b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 0:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.srcloc$1495=function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],
a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}};tuscheme$0tuscheme$1.isDelim$1499=function(a){if(32==a||9<=a&&13>=a)a=!0;else a:{var b=0;for(;;){if(7<=b){a=!1;break a}if("()[]{};".charCodeAt(b)==a){a=!0;break a}b=SmlPrims.chk_ovf_i32(b+1)}}return a};tuscheme$0tuscheme$1.whitespace$1507=tuscheme$0tuscheme$1.many$1261(function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,
[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return b=b[1],32==b||9<=b&&13>=b?a:[1];default:return a}default:return a}});tuscheme$0tuscheme$1.intChars$1508=function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007,c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 45==
b[1]?a:[1];default:return a}default:return a}});var e=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return b=b[1],48<=b&&57>=b?a:[1];default:return a}default:return a}}),tuscheme$0tuscheme$1.many$1261(function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);
switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return b=b[1],48<=b&&57>=b?a:[1];default:return a}default:return a}}));e=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],a]]},e),function(b){var c=tuscheme$0tuscheme$1.streamGet$703(b);switch(c[0]){case 1:c=[1];break;default:c=c[1],c=[0,[[0,c[0]],c[1]]]}switch(c[0]){case 0:var e=c[1][0];switch(e[0]){case 0:c=
a(e[1])?[1]:c}}switch(c[0]){case 1:return[0,[[0,0],b]];default:return[1]}});return b(function(a){var b=c(a);switch(b[0]){case 0:return[0,b[1]];default:return[0,[[0,function(a){return a}],a]]}},e)};var O={$intFromChars:function(a){if(null==a)try{var b=SmlPrims.implode(a),c=basis$0Int32$1.fromString$462(b);return[0,basis$0General$1.valOf$130(c)]}catch(R){if(R[0]==CompilerInitial.en$Overflow$50)a=[1,"this interpreter can't read arbitrarily large integers"];else throw R;return a}else switch(a[0]){case 45:switch(a=
O.$intFromChars(a[1]),a[0]){case 0:return[0,SmlPrims.chk_ovf_i32(-a[1])];default:return[1,a[1]]}default:try{var e=SmlPrims.implode(a),d=basis$0Int32$1.fromString$462(e);return[0,basis$0General$1.valOf$130(d)]}catch(R){if(R[0]==CompilerInitial.en$Overflow$50)a=[1,"this interpreter can't read arbitrarily large integers"];else throw R;return a}}}};tuscheme$0tuscheme$1.intFromChars$1513=O.$intFromChars;tuscheme$0tuscheme$1.intToken$1533=function(a){a=tuscheme$0tuscheme$1.intChars$1508(a);return tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,
[[0,function(a){return tuscheme$0tuscheme$1.intFromChars$1513(a)}],a]]},a)};tuscheme$0tuscheme$1.leftString$1540=function(a){switch(a){case 1:return"(";case 0:return"[";default:return"{"}};tuscheme$0tuscheme$1.rightString$1550=function(a){switch(a){case 1:return")";case 0:return"]";default:return"}"}};tuscheme$0tuscheme$1.bracketLexer$1563=function(a){var b=[2,1];var c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return b}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);
switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 40==b[1]?a:[1];default:return a}default:return a}});var e=[2,0];var d=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return e}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 91==b[1]?a:[1];default:return a}default:return a}});
var f=function(a){var b=c(a);switch(b[0]){case 0:return[0,b[1]];default:return d(a)}};var Z=[2,2];var F=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return Z}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 123==b[1]?a:[1];default:return a}default:return a}});var M=function(a){var b=f(a);switch(b[0]){case 0:return[0,b[1]];default:return F(a)}};
var g=[0,1];var k=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return g}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 41==b[1]?a:[1];default:return a}default:return a}});var ha=function(a){var b=M(a);switch(b[0]){case 0:return[0,b[1]];default:return k(a)}};var l=[0,0];var m=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return l}],
a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 93==b[1]?a:[1];default:return a}default:return a}});var ta=function(a){var b=ha(a);switch(b[0]){case 0:return[0,b[1]];default:return m(a)}};var ia=[0,2];var W=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return ia}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=
[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 125==b[1]?a:[1];default:return a}default:return a}});var q=function(a){var b=ta(a);switch(b[0]){case 0:return[0,b[1]];default:return W(a)}};var r=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[1,a]}],a]]},a);return function(a){var b=q(a);switch(b[0]){case 0:return[0,b[1]];default:return r(a)}}};tuscheme$0tuscheme$1.plusBracketsString$1568=function(a,b){switch(b[0]){case 2:switch(b[1]){case 1:return"(";
case 0:return"[";default:return"{"}case 0:switch(b[1]){case 1:return")";case 0:return"]";default:return"}"}default:return a(b[1])}};tuscheme$0tuscheme$1.token$1592=function(a){return tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[1]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a)};tuscheme$0tuscheme$1.noTokens$1596=function(a){switch(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[1]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a)[0]){case 1:return[0,
[[0,0],a]];default:return[1]}};tuscheme$0tuscheme$1.s$nn$1600=function(a){return tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),a)};tuscheme$0tuscheme$1.s$jml$1604=function(a,b){var c=
"expected "+b;var e=function(a){return[1,tuscheme$0tuscheme$1.synerrormsg$1331(a[0],a[1])([c,null])]};var h=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,e],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}});return function(b){var c=a(b);switch(c[0]){case 0:return[0,c[1]];default:return h(b)}}};tuscheme$0tuscheme$1.s$jal$1611=
function(a,b){return function(c){var e=a(c);switch(e[0]){case 0:switch(e=e[1],e[0][0]){case 0:e=e[1];var h=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(c);switch(h[0]){case 0:c=[0,[h[1][0],c]];break;default:c=[1]}switch(c[0]){case 0:c=c[1][0];switch(c[0]){case 0:c=[0,c[1]];break;default:c=[1]}break;default:c=[1]}switch(c[0]){case 0:return c=c[1],[0,[[1,tuscheme$0tuscheme$1.synerrormsg$1331(c[0],c[1])([b,
null])],e]];default:return[1]}default:return[1]}default:return[1]}}};tuscheme$0tuscheme$1.nodups$1640=function(a,b){return function(c){var e=c[0];c=c[1];a:{var h=c;for(;;){if(null==h){e=[0,c];break a}var d=h;h=d[0];d=d[1];c:{var v=d;for(;;){if(null==v){v=!1;break c}if(v[0]==h){v=!0;break c}v=v[1]}}if(v){c=a+" "+h+" appears twice in "+b;e=[1,tuscheme$0tuscheme$1.synerrormsg$1331(e[0],e[1])([c,null])];break a}h=d}}return e}};tuscheme$0tuscheme$1.notCurly$1673=function(a,b){switch(b){case 2:return!1;
default:return!0}};tuscheme$0tuscheme$1.left$1682=function(a){a=tuscheme$0tuscheme$1.inline$1491(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,[[1,a[1]],b[1]]];default:a=a[1];b=b[1];var c=a[1];switch(c[0]){case 2:a=[0,[a[0],c[1]]];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}};tuscheme$0tuscheme$1.right$1696=function(a){a=tuscheme$0tuscheme$1.inline$1491(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,
[[1,a[1]],b[1]]];default:a=a[1];b=b[1];var c=a[1];switch(c[0]){case 0:a=[0,[a[0],c[1]]];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}};tuscheme$0tuscheme$1.leftCurly$1710=function(a){a=tuscheme$0tuscheme$1.left$1682(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:switch(b[1][1]){case 2:b=!1;break;default:b=!0}return b?[1]:a;default:return a}default:return a}};tuscheme$0tuscheme$1.atRight$1714=function(a){return tuscheme$0tuscheme$1.s$jml$1604(function(a){var b=
tuscheme$0tuscheme$1.right$1696(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}},a)};tuscheme$0tuscheme$1.badRight$1718=function(a){return tuscheme$0tuscheme$1.s$jtla$1279(function(b){return[0,[[0,function(b){var c=b[0];var e=a+" ";switch(b[1]){case 1:b=")";break;case 0:b="]";break;default:b="}"}e+=b;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(c[0],c[1])([e,null])]}],b]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)})};tuscheme$0tuscheme$1.scanToClose$1731=function(a){var b=
basis$0General$1.getOpt$107;var c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(c[0]){case 0:c=[0,[c[1][0],a]];break;default:c=[1]}switch(c[0]){case 0:c=c[1][0];switch(c[0]){case 0:c=[0,c[1]];break;default:c=[1]}break;default:c=[1]}var e=b(c,["end of stream",9999]);return function(a,b){a:for(;;)switch(b[0]){case 2:b=b[1];var c=b[0];switch(c[0]){case 1:b=b[1];continue a;default:switch(c[1][1][0]){case 2:b=
b[1];a=SmlPrims.chk_ovf_i32(a+1);continue a;case 0:b=b[1];if(0==a)return[0,[[0,[0,e]],b]];a=SmlPrims.chk_ovf_i32(a-1);continue a;default:b=b[1];continue a}}case 1:return[0,[[0,[1]],b]];default:switch(b=b[1],c=b[0],c[0]){case 1:c=(0,c[1])(0);b[0]=[0,c];0;b=c;break;default:b=c[1]}}}(0,a)};tuscheme$0tuscheme$1.matchingRight$1781=function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[2,a]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)})(a);switch(b[0]){case 0:return[0,
b[1]];default:return tuscheme$0tuscheme$1.scanToClose$1731(a)}};tuscheme$0tuscheme$1.matchBrackets$1786=function(a,b,c,d){switch(d[0]){case 1:a=b[0];switch(b[1]){case 1:b="(";break;case 0:b="[";break;default:b="{"}b="unmatched "+b;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(a[0],a[1])([b,null])];case 0:return b=b[0],a="expected "+a,[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])];default:a=b[0];var e=b[1];d=d[1];b=d[0];d=d[1];switch(e){case 0:switch(d){case 0:var h=!0;break;default:h=
!1}break;case 1:switch(d){case 1:h=!0;break;default:h=!1}break;case 2:switch(d){case 2:h=!0;break;default:h=!1}}if(h)return[0,c];switch(d){case 1:c=")";break;case 0:c="]";break;default:c="}"}switch(e){case 1:h="(";break;case 0:h="[";break;default:h="{"}c=c+" does not match "+h;a=a[0]!=b[0]||a[1]!=b[1]?" at "+(a[0]+", line "+tuscheme$0tuscheme$1.intString$351(a[1])):"";a=c+a;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]}};tuscheme$0tuscheme$1.liberalBracket$1841=function(a,b){return tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(b){return[0,
[[0,function(b){return function(c){return function(e){return tuscheme$0tuscheme$1.matchBrackets$1786(a,b,c,e)}}}],b]]},function(a){a=tuscheme$0tuscheme$1.left$1682(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:switch(b[1][1]){case 2:b=!1;break;default:b=!0}return b?a:[1];default:return a}default:return a}}),b),function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[2,a]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)})(a);switch(b[0]){case 0:return[0,
b[1]];default:return tuscheme$0tuscheme$1.scanToClose$1731(a)}})};tuscheme$0tuscheme$1.bracketKeyword$1848=function(a,b,c){var e=tuscheme$0tuscheme$1.liberalBracket$1841;c=tuscheme$0tuscheme$1.s$jml$1604(c,b);a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},a),c);return e(b,a)};tuscheme$0tuscheme$1.bracket$1857=function(a,b){return tuscheme$0tuscheme$1.liberalBracket$1841(a,tuscheme$0tuscheme$1.s$jml$1604(b,
a))};tuscheme$0tuscheme$1.curlyBracket$1864=function(a,b){return tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(b){return[0,[[0,function(b){return function(c){return function(e){return tuscheme$0tuscheme$1.matchBrackets$1786(a,b,c,e)}}}],b]]},function(a){a=tuscheme$0tuscheme$1.left$1682(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:switch(b[1][1]){case 2:b=!1;break;default:b=!0}return b?[1]:a;default:return a}default:return a}}),
tuscheme$0tuscheme$1.s$jml$1604(b,a)),function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[2,a]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)})(a);switch(b[0]){case 0:return[0,b[1]];default:return tuscheme$0tuscheme$1.scanToClose$1731(a)}})};tuscheme$0tuscheme$1.usageParser$1871=function(a){var b=function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=
a[1][0];switch(b[0]){case 0:b=b[1];if(32==b||9<=b&&13>=b)b=!0;else a:{var c=0;for(;;){if(7<=c){b=!1;break a}if("()[]{};".charCodeAt(c)==b){b=!0;break a}c=SmlPrims.chk_ovf_i32(c+1)}}return b?[1]:a;default:return a}default:return a}};var c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){return b(a)}),tuscheme$0tuscheme$1.many$1261(function(a){return b(a)}));c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return SmlPrims.implode(a)}],a]]},c);var e=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 40==b[1]?a:[1];default:return a}default:return a}}),c);return function(b){var c=b[0];b=b[1];var h=function(a,b){for(;;){if(0>
a)return b;var e=SmlPrims.chk_ovf_i32(a-1);b=[c.charCodeAt(a),b];a=e}}(SmlPrims.chk_ovf_i32(c.length-1),null);var d=[1],v={$foldr:function(a){return null==a?d:[2,[a[0],v.$foldr(a[1])]]}},U=v.$foldr;h=U(h);h=e(h);switch(h[0]){case 0:switch(h=h[1][0],h[0]){case 0:return U=a(h[1]),h=tuscheme$0tuscheme$1.liberalBracket$1841,b=tuscheme$0tuscheme$1.s$jml$1604(b,c),b=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},U),
b),h(c,b);default:throw b=new String("BadUsage"),[b,c];}default:throw b=new String("BadUsage"),[b,c];}}};tuscheme$0tuscheme$1.safeTokens$1906=function(a){var b={$tokens:function(a,c){var e={$get:function(h){a:for(;;)switch(h[0]){case 2:h=h[1];var d=h[0];switch(d[0]){case 1:return h=h[1],c?null:b.$tokens(!0,!1)(h);default:return[d[1][1],e.$get(h[1])]}case 1:return null;default:switch(d=h[1],d[0][0]){case 0:h=d[0][1];continue a;default:if(a)return null;h=b.$tokens(!1,!0);var v=d[0];switch(v[0]){case 1:v=
(0,v[1])(0);d[0]=[0,v];0;d=v;break;default:d=v[1]}return h(d)}}}},h=e.$get;return function(a){return h(a)}}},c=b.$tokens;return c(!1,!1)(a)};tuscheme$0tuscheme$1.showErrorInput$1955=function(a,b,c){b=b(c);switch(b[0]){case 0:var e=b[1],h=e[0];switch(h[0]){case 1:return h=h[1],e=e[1],basis$0String$1.isSubstring$268(" [input: ",h)?b:[0,[[1,h+" [input: "+tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(a,tuscheme$0tuscheme$1.safeTokens$1906(c)))+"]"],e]];default:return b}default:return b}};tuscheme$0tuscheme$1.wrapAround$1985=
function(a,b,c,d){try{(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}})(["Looking for ",[b,[" at",null]]]);(function(b){for(;;){if(null==b)return 0;var c=b;b=c[1];c=" "+a(c[0]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,c)}})(tuscheme$0tuscheme$1.safeTokens$1906(d));tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");var e=c(d);switch(e[0]){case 1:var h="Didn't find ";break;default:h="Found "}(function(a){for(;;){if(null==
a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}})([h,[b,["\n",null]]]);return e}catch(Z){return function(a){a:{var c=["Search for ",[b,[" raised ",[a[0],["\n",null]]]]];for(;;){if(null==c)break a;var e=c[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,c[0]);c=e}}throw a;}(Z)}};tuscheme$0tuscheme$1.echoTagStream$2012=function(a){var b={$streamOfUnfold:function(a){return[0,[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(a);switch(c[0]){case 1:var e=
[1];break;default:var h=c[1][0];try{e=";#"==basis$0String$1.substring$169(h,0,2)}catch(F){e=!1}e?tuscheme$0stubs$1.print$119(h):0;e=c}switch(e[0]){case 1:return[1];default:return e=e[1],[2,[e[0],b.$streamOfUnfold(e[1])]]}}]]]}},c=b.$streamOfUnfold;return c(a)};tuscheme$0tuscheme$1.stripAndReportErrors$2026=function(a){var b={$streamOfUnfold:function(a){return[0,[[1,function(c){a:b:for(c=a;;)switch(c=tuscheme$0tuscheme$1.streamGet$703(c),c[0]){case 0:var e=c[1];c=e[0];switch(c[0]){case 1:e=e[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
c[1]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");c=e;continue b;default:c=[0,[c[1],e[1]]];break a}default:c=[1];break a}switch(c[0]){case 1:return[1];default:return c=c[1],[2,[c[0],b.$streamOfUnfold(c[1])]]}}]]]}},c=b.$streamOfUnfold;return c(a)};tuscheme$0tuscheme$1.lexLineWith$2054=function(a){var b={$streamOfUnfold:function(c){return[0,[[1,function(e){e=a(c);switch(e[0]){case 1:return[1];default:return e=e[1],[2,[e[0],b.$streamOfUnfold(e[1])]]}}]]]}},c=b.$streamOfUnfold;var e=
function(a){return c(a)};var d=function(a){return tuscheme$0tuscheme$1.stripAndReportErrors$2026(e(a))};var f=function(a){var b=[1],c={$foldr:function(a){return null==a?b:[2,[a[0],c.$foldr(a[1])]]}},e=c.$foldr;a=e(a);return d(a)};return function(a){a:{var b=SmlPrims.chk_ovf_i32(a.length-1),c=null;for(;;){if(0>b)break a;var e=SmlPrims.chk_ovf_i32(b-1);c=[a.charCodeAt(b),c];b=e}}return f(c)}};tuscheme$0tuscheme$1.parseWithErrors$2058=function(a){var b={$streamOfUnfold:function(c){return[0,[[1,function(e){e=
a(c);switch(e[0]){case 0:var h=e[1],d=h[0];switch(d[0]){case 1:e=[0,[[1,d[1]],tuscheme$0tuscheme$1.drainLine$1443(h[1])]]}}switch(e[0]){case 1:return[1];default:return e=e[1],[2,[e[0],b.$streamOfUnfold(e[1])]]}}]]]}},c=b.$streamOfUnfold;return function(a){return c(a)}};tuscheme$0tuscheme$1.stdPrompts$2081=["-> ","   "];tuscheme$0tuscheme$1.noPrompts$2082=["",""];tuscheme$0tuscheme$1.interactiveParsedStream$2083=function(a,b){return function(c){var e=c[0],h=c[2],d=h[0],v=h[1],f=[d];c=tuscheme$0tuscheme$1.echoTagStream$2012(c[1]);
var M={$streamOfUnfold:function(a){return[0,[[1,function(b){tuscheme$0stubs$1.print$119(f[0]);b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:return[1];default:return b=b[1],[2,[b[0],M.$streamOfUnfold(b[1])]]}}]]]}};h=M.$streamOfUnfold;c=h(c);var g={$streamOfUnfold:function(a){return[0,[[1,function(c){c=b(a);switch(c[0]){case 0:var e=c[1],h=e[0];switch(h[0]){case 1:c=[0,[[1,h[1]],tuscheme$0tuscheme$1.drainLine$1443(e[1])]]}}switch(c[0]){case 1:return[1];default:return c=c[1],[2,[c[0],
g.$streamOfUnfold(c[1])]]}}]]]}},k=g.$streamOfUnfold;var ha=function(a){return k(a)};e=tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(e),tuscheme$0tuscheme$1.streamDrop$978(1,tuscheme$0tuscheme$1.naturals$785));c=function(b){var c=tuscheme$0tuscheme$1.streamConcat$909;var e={$streamMap:function(b){return[0,[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(b);switch(c[0]){case 1:return[1];default:c=c[1];var h=c[0];c=c[1];var d=h[0];h=h[1];h=tuscheme$0tuscheme$1.lexLineWith$2054(a)(h);
var U={$streamOfUnfold:function(a){return[0,[[1,function(b){b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:b=[1];break;default:f[0]=v,0}switch(b[0]){case 1:return[1];default:return b=b[1],[2,[b[0],U.$streamOfUnfold(b[1])]]}}]]]}},B=U.$streamOfUnfold;h=B(h);var R={$streamMap:function(a){return[0,[[1,function(b){b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:return[1];default:return b=b[1],[2,[[0,b[0]],R.$streamMap(b[1])]]}}]]]}};B=R.$streamMap;h=B(tuscheme$0tuscheme$1.streamZip$880(tuscheme$0tuscheme$1.streamRepeat$761(d),
h));var M=[1],g={$foldr:function(a){return null==a?M:[2,[a[0],g.$foldr(a[1])]]}};B=g.$foldr;B=B([[1,d[1]],null]);d=tuscheme$0tuscheme$1.streamConcat$909;var F=[1],Z={$foldr:function(a){return null==a?F:[2,[a[0],Z.$foldr(a[1])]]}},fa=Z.$foldr;h=fa([h,[B,null]]);return[2,[d(h),e.$streamMap(c)]]}}]]]}},h=e.$streamMap;b=h(b);c=c(b);return ha(c)}(tuscheme$0tuscheme$1.streamZip$880(e,c));e=tuscheme$0tuscheme$1.stripAndReportErrors$2026;var l={$streamOfUnfold:function(a){return[0,[[1,function(b){f[0]=d;
0;b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:return[1];default:return b=b[1],[2,[b[0],l.$streamOfUnfold(b[1])]]}}]]]}};h=l.$streamOfUnfold;c=h(c);return e(c)}};tuscheme$0tuscheme$1.override_if_testing$2124=function(a){return basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC"))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0):0};tuscheme$0tuscheme$1.setup_error_format$2131=function(a,b){switch(a){case 0:a=!0;break;default:a=!1}return a?[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=
1,0),basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC"))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0):0][0]:[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=0,0),basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC"))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0):0][0]};tuscheme$0tuscheme$1.forward$2139=function(a,b){throw[new String("UnresolvedForwardDeclaration"),a];};tuscheme$0tuscheme$1.en$LeftAsExercise$2146=new String("LeftAsExercise");
var E={$eqKind:function(a,b){if(null==a)return null==b?!0:!1;if(null==b)return!1;var c=a[1],e=b[1];return E.$eqKinds(a[0],b[0])?E.$eqKind(c,e):!1},$eqKinds:function(a,b){return basis$0ListPair$1.allEq$384(function(a){return E.$eqKind(a[0],a[1])},[a,b])}};tuscheme$0tuscheme$1.eqKind$2150=E.$eqKind;tuscheme$0tuscheme$1.eqKinds$2149=E.$eqKinds;tuscheme$0tuscheme$1.inttype$2191=[1,"int"];tuscheme$0tuscheme$1.booltype$2192=[1,"bool"];tuscheme$0tuscheme$1.symtype$2193=[1,"sym"];tuscheme$0tuscheme$1.unittype$2194=
[1,"unit"];tuscheme$0tuscheme$1.tyvarA$2195=[0,"'a"];tuscheme$0tuscheme$1.listtype$2196=function(a){return[4,[[1,"list"],[a,null]]]};var y={$typeString:function(a){for(;;)switch(a[0]){case 1:return a[1];case 0:return a[1];case 2:var b=a[1];a=b[0];b=b[1];return"("+tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([y.$typeString]),a))+" -> "+y.$typeString(b)+")";case 4:return a=a[1],b=a[1],null==b?"("+y.$typeString(a[0])+")":"("+y.$typeString(a[0])+
" "+tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([y.$typeString]),b))+")";default:return a=a[1],b=a[1],"(forall ("+tuscheme$0tuscheme$1.spaceSep$414(a[0])+") "+y.$typeString(b)+")"}}};tuscheme$0tuscheme$1.typeString$2200=y.$typeString;tuscheme$0tuscheme$1.freetyvars$2241=function(a){var b={$free:function(a,c){switch(a[0]){case 0:var e=a[1];return function(a){for(;;){if(null==a)return!1;if(a[0]==e)return!0;a=a[1]}}(c)?c:[e,c];case 1:return c;
case 4:a=a[1];var h=a[1];return function(a,c){for(;;){if(null==c)return a;var e=c;c=e[1];a=b.$free(e[0],a)}}(b.$free(a[0],c),h);case 2:return a=a[1],h=a[0],function(a,c){for(;;){if(null==c)return a;var e=c;c=e[1];a=b.$free(e[0],a)}}(b.$free(a[1],c),h);default:a=a[1];var d=a[0];a=b.$free(a[1],tuscheme$0tuscheme$1.emptyset$566(0));a=basis$0List$1.filter$417(function(a){a:{var b=d;for(;;){if(null==b){a=!1;break a}if(b[0]==a){a=!0;break a}b=b[1]}}return a?!1:!0},a);return function(a,b){for(;;){if(null==
b)return a;var c=b;b=c[0];c=c[1];b:{var e=a;for(;;){if(null==e){e=!1;break b}if(e[0]==b){e=!0;break b}e=e[1]}}a=e?a:[b,a];b=c}}(c,a)}}},c=b.$free;return basis$0List$1.rev$682(c(a,tuscheme$0tuscheme$1.emptyset$566(0)))};tuscheme$0tuscheme$1.freetyvarsGamma$2291=function(a){a:{var b=tuscheme$0tuscheme$1.emptyset$566(0);for(;;){if(null==a)break a;var c=a;a=c[1];c:for(c=tuscheme$0tuscheme$1.freetyvars$2241(c[0][1]);;){if(null==b)break c;var e=b;b=e[0];e=e[1];e:{var d=c;for(;;){if(null==d){d=!1;break e}if(d[0]==
b){d=!0;break e}d=d[1]}}c=d?c:[b,c];b=e}b=c}}return b};tuscheme$0tuscheme$1.freshName$2304=function(a,b){var c=tuscheme$0tuscheme$1.stripNumericSuffix$454(a),e={$streamMap:function(a){return[0,[[1,function(b){b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:return[1];default:b=b[1];var h=b[1];return[2,[c+"-"+tuscheme$0tuscheme$1.intString$351(b[0]),e.$streamMap(h)]]}}]]]}};a=e.$streamMap;var h=a(tuscheme$0tuscheme$1.naturals$785);a=tuscheme$0tuscheme$1.streamGet$703;var d={$streamFilter:function(a){return[0,
[[1,function(c){c=tuscheme$0tuscheme$1.streamGet$703(a);switch(c[0]){case 1:return[1];default:var e=c[1];c=e[0];e=e[1];a:{var h=b;for(;;){if(null==h){h=!1;break a}if(h[0]==c){h=!0;break a}h=h[1]}}return h?d.$streamFilter(e):[2,[c,d.$streamFilter(e)]]}}]]]}},f=d.$streamFilter;h=f(h);a=a(h);switch(a[0]){case 0:return a[1][0];default:throw[new String("ThisCan'tHappen")];}};var I={$kindof:function(a,b){var c={$kind:function(a){for(;;)switch(a[0]){case 0:a=a[1];try{return tuscheme$0tuscheme$1.find$139(a,
b)}catch(M){return function(a){return function(b){var c=a[0];if(b[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"unknown type variable "+c];throw b;}}([a])(M)}case 1:a=a[1];try{return tuscheme$0tuscheme$1.find$139(a,b)}catch(M){return function(a){return function(b){var c=a[0];if(b[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"unknown type constructor "+c];throw b;}}([a])(M)}case 2:a=a[1];var e=a[0];if(tuscheme$0tuscheme$1.eqKind$2150(c.$kind(a[1]),
null)){if(function(a){for(;;){if(null==a)return!1;var b=a[1];if(tuscheme$0tuscheme$1.eqKind$2150(c.$kind(a[0]),null))a=b;else return!0}}(e))throw[tuscheme$0tuscheme$1.en$TypeError$87,"argument list includes a non-type"];return null}throw[tuscheme$0tuscheme$1.en$TypeError$87,"function result is not a type"];case 4:e=a[1];a=e[0];e=e[1];var h=c.$kind(a);if(null==h)throw[tuscheme$0tuscheme$1.en$TypeError$87,"tried to apply type "+tuscheme$0tuscheme$1.typeString$2200(a)+" as type constructor"];var d=h[1];
if(tuscheme$0tuscheme$1.eqKinds$2149(h[0],basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([c.$kind]),e)))return d;throw[tuscheme$0tuscheme$1.en$TypeError$87,"type constructor "+tuscheme$0tuscheme$1.typeString$2200(a)+" applied to the wrong arguments"];default:e=a[1];a=e[1];e=function(a,b){for(;;){if(null==b)return a;var c=b[1];a=[[b[0],null],a];b=c}}(b,e[0]);if(null==I.$kindof(a,e))return null;throw[tuscheme$0tuscheme$1.en$TypeError$87,"quantifed a non-nullary type constructor"];
}}},e=c.$kind;return e(a)}};tuscheme$0tuscheme$1.kindof$2329=I.$kindof;tuscheme$0tuscheme$1.asType$2416=function(a,b){if(null==tuscheme$0tuscheme$1.kindof$2329(a,b))return a;throw[tuscheme$0tuscheme$1.en$TypeError$87,"used type constructor `"+tuscheme$0tuscheme$1.typeString$2200(a)+"' as a type"];};var S={$valueString:function(a){switch(a[0]){case 4:return"()";case 6:return a[1]?"#t":"#f";case 3:return tuscheme$0tuscheme$1.intString$351(a[1]);case 0:return a[1];case 2:a=a[1];var b=a[1],c={$tail:function(a){switch(a[0]){case 2:a=
a[1];var b=a[1];return" "+S.$valueString(a[0])+c.$tail(b);case 4:return")";default:return" . "+S.$valueString(a)+")"}}},e=c.$tail;return"("+S.$valueString(a[0])+e(b);case 5:return"<procedure>";default:return"<procedure>"}}};tuscheme$0tuscheme$1.valueString$2459=S.$valueString;var A={$expString:function(a){for(;;)switch(a[0]){case 5:return tuscheme$0tuscheme$1.valueString$2459(a[1]);case 1:return a[1];case 4:return a=a[1],a=["set",[a[0],[A.$expString(a[1]),null]]],"("+tuscheme$0tuscheme$1.spaceSep$414(a)+
")";case 8:return a=a[1],a=[a[0],[a[1],[a[2],null]]],a=["if",basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([A.$expString]),a)],"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")";case 0:a=a[1];var b=a[1];a=["while",[A.$expString(a[0]),[A.$expString(b),null]]];return"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")";case 9:return a=a[1],a=["begin",basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([A.$expString]),a)],"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")";
case 10:return a=a[1],a=[a[0],a[1]],a=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([A.$expString]),a),"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")";case 6:var c=a[1];a=c[1];b=c[2];switch(c[0][0]){case 1:c="let";break;default:c="let*"}a=[c,["("+tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(function(a){return function(b){return"("+(b[0]+" "+(0,a[0])(b[1]))+")"}}([A.$expString]),a))+")",[A.$expString(b),null]]];return"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")";case 7:return b=
a[1],a=b[0],b=b[1],a=basis$0List$1.map$697(function(a){return function(b){var c=a[0],e=b[0];b=[(0,a[1])(b[1]),[e,null]];return"("+c(b)+")"}}([tuscheme$0tuscheme$1.spaceSep$414,tuscheme$0tuscheme$1.typeString$2200]),a),a=["("+tuscheme$0tuscheme$1.spaceSep$414(a)+")",[A.$expString(b),null]],"("+tuscheme$0tuscheme$1.spaceSep$414(["lambda",a])+")";case 2:return a=a[1],b=a[1],a=["lambda",["("+tuscheme$0tuscheme$1.spaceSep$414(a[0])+")",[A.$expString(b),null]]],"("+tuscheme$0tuscheme$1.spaceSep$414(a)+
")";default:return a=a[1],b=a[1],a=["@",[A.$expString(a[0]),basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([tuscheme$0tuscheme$1.typeString$2200]),b)]],"("+tuscheme$0tuscheme$1.spaceSep$414(a)+")"}}};tuscheme$0tuscheme$1.expString$2514=A.$expString;tuscheme$0tuscheme$1.unitVal$2641=[4];var r={$embedList:function(a){return null==a?[4]:[2,[a[0],r.$embedList(a[1])]]}};tuscheme$0tuscheme$1.embedList$2642=r.$embedList;tuscheme$0tuscheme$1.embedBool$2655=function(a){return[6,a]};
tuscheme$0tuscheme$1.bool$2659=function(a){switch(a[0]){case 6:return a[1];default:return!0}};tuscheme$0tuscheme$1.equalatoms$2670=function(a,b){switch(a[0]){case 4:switch(b[0]){case 4:return!0;default:return!1}case 3:switch(b[0]){case 3:return a[1]==b[1];default:return!1}case 0:switch(b[0]){case 0:return a[1]==b[1];default:return!1}case 6:switch(b[0]){case 6:return a[1]==b[1];default:return!1}default:return!1}};var p={$equalpairs:function(a,b){a:for(;;)switch(a[0]){case 2:switch(b[0]){case 2:var c=
a[1];a=c[1];b=b[1];var e=b[1];if(p.$equalpairs(c[0],b[0])){b=c=e;continue a}else return!1;default:switch(a[0]){case 4:switch(b[0]){case 4:return!0;default:return!1}case 3:switch(b[0]){case 3:return a[1]==b[1];default:return!1}case 0:switch(b[0]){case 0:return a[1]==b[1];default:return!1}case 6:switch(b[0]){case 6:return a[1]==b[1];default:return!1}default:return!1}}default:switch(a[0]){case 4:switch(b[0]){case 4:return!0;default:return!1}case 3:switch(b[0]){case 3:return a[1]==b[1];default:return!1}case 0:switch(b[0]){case 0:return a[1]==
b[1];default:return!1}case 6:switch(b[0]){case 6:return a[1]==b[1];default:return!1}default:return!1}}}};tuscheme$0tuscheme$1.equalpairs$2712=p.$equalpairs;tuscheme$0tuscheme$1.testEqual$2744=function(a){return tuscheme$0tuscheme$1.equalpairs$2712(a[0],a[1])};tuscheme$0tuscheme$1.cycleThrough$2745=function(a){var b=[a];if(null==a)throw[tuscheme$0tuscheme$1.en$InternalError$241,"empty list given to cycleThrough"];return function(c){a:for(;;)if(c=b[0],null==c)b[0]=a,0;else{var e=c[0];b[0]=c[1];0;break a}return e}};
tuscheme$0tuscheme$1.unspecified$2770;var V=[[6,!0],[[3,39],[[0,"this value is unspecified"],[[4],[[1,function(a){throw[new String("Unspecified")];}],null]]]]],da=[V];if(null==V)throw[tuscheme$0tuscheme$1.en$InternalError$241,"empty list given to cycleThrough"];tuscheme$0tuscheme$1.unspecified$2770=function(a){a:for(;;)if(a=da[0],null==a)da[0]=V,0;else{var b=a[0];da[0]=a[1];0;break a}return b};var la={$tysubst:function(a,b){var c={$subst:function(a){for(;;)switch(a[0]){case 0:a=a[1];try{return tuscheme$0tuscheme$1.find$139(a,
b)}catch(F){return function(a){return function(b){var c=a[0];if(b[0]==tuscheme$0tuscheme$1.en$NotFound$138)return[0,c];throw b;}}([a])(F)}case 1:return[1,a[1]];case 4:a=a[1];var e=a[1];return[4,[c.$subst(a[0]),basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([c.$subst]),e)]];case 2:return e=a[1],a=e[0],e=e[1],[2,[basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([c.$subst]),a),c.$subst(e)]];default:e=a[1];a=e[0];e=e[1];var h=tuscheme$0tuscheme$1.freetyvars$2241([3,
[a,e]]);h=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])([0,b])}}([c.$subst]),h);h=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([tuscheme$0tuscheme$1.freetyvars$2241]),h);h=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[1];b:for(c=c[0];;){if(null==c)break b;var e=c;c=e[0];e=e[1];d:{var h=a;for(;;){if(null==h){h=!1;break d}if(h[0]==c){h=!0;break d}h=h[1]}}a=h?a:[c,a];c=e}}}(tuscheme$0tuscheme$1.emptyset$566(0),h);if(null==basis$0List$1.filter$417(function(a){return function(b){a:{var c=
a[0];for(;;){if(null==c){b=!1;break a}if(c[0]==b){b=!0;break a}c=c[1]}}return b}}([a]),h))return h=tuscheme$0tuscheme$1.bindList$174(a,basis$0List$1.map$697(function(a){return function(a){return[0,a]}}([]),a),b),[3,[a,la.$tysubst(e,h)]];throw[tuscheme$0tuscheme$1.en$LeftAsExercise$2146,"renameForallAvoiding"];}}},e=c.$subst;return e(a)}};tuscheme$0tuscheme$1.tysubst$2774=la.$tysubst;tuscheme$0tuscheme$1.rename$2841=function(a,b,c){return tuscheme$0tuscheme$1.tysubst$2774(c,tuscheme$0tuscheme$1.bindList$174(a,
basis$0List$1.map$697(function(a){return[0,a]},b),tuscheme$0tuscheme$1.emptyEnv$137(0)))};tuscheme$0tuscheme$1.instantiate$2851=function(a,b,c){switch(a[0]){case 3:var e=a[1];a=e[0];e=e[1];var h=basis$0List$1.find$392(function(a){return tuscheme$0tuscheme$1.eqKind$2150(tuscheme$0tuscheme$1.kindof$2329(a,c),null)?!1:!0},b);switch(h[0]){case 0:throw[tuscheme$0tuscheme$1.en$TypeError$87,"instantiated at type constructor `"+tuscheme$0tuscheme$1.typeString$2200(h[1])+"', which is not a type"];default:try{return tuscheme$0tuscheme$1.tysubst$2774(e,
tuscheme$0tuscheme$1.bindList$174(a,b,tuscheme$0tuscheme$1.emptyEnv$137(0)))}catch(R){if(R[0]==tuscheme$0tuscheme$1.en$BindListLength$164)throw[tuscheme$0tuscheme$1.en$TypeError$87,"instantiated polymorphic term at wrong number of types"];throw R;}}default:throw[tuscheme$0tuscheme$1.en$TypeError$87,"tried to instantiate term of non-quantified type "+tuscheme$0tuscheme$1.typeString$2200(a)];}};tuscheme$0tuscheme$1.infiniteTyvars$2884;var T={$streamMap:function(a){return[0,[[1,function(b){b=tuscheme$0tuscheme$1.streamGet$703(a);
switch(b[0]){case 1:return[1];default:b=b[1];var c=b[1];return[2,["'b-"+tuscheme$0tuscheme$1.intString$351(b[0]),T.$streamMap(c)]]}}]]]}};n=T.$streamMap;tuscheme$0tuscheme$1.infiniteTyvars$2884=n(tuscheme$0tuscheme$1.naturals$785);var P={$eqType:function(a,b){switch(a[0]){case 0:switch(b[0]){case 0:return a[1]==b[1];default:return!1}case 1:switch(b[0]){case 1:return a[1]==b[1];default:return!1}case 4:switch(b[0]){case 4:a=a[1];var c=a[1];b=b[1];var e=b[1];return P.$eqType(a[0],b[0])?P.$eqTypes(c,
e):!1;default:return!1}case 2:switch(b[0]){case 2:return a=a[1],c=a[0],b=b[1],e=b[0],P.$eqType(a[1],b[1])?P.$eqTypes(c,e):!1;default:return!1}default:switch(b[0]){case 3:c=a[1];a=c[0];var h=c[1];c=b[1];b=c[0];var d=c[1];c=tuscheme$0tuscheme$1.streamTake$954;e=function(a,b){for(;;){if(null==a)return b;a=a[1];b=SmlPrims.chk_ovf_i32(b+1)}}(a,0);var f={$streamFilter:function(a){return[0,[[1,function(b){b=tuscheme$0tuscheme$1.streamGet$703(a);switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];b=b[1];
return function(a){for(;;){if(null==a)return!1;if(a[0]==c)return!0;a=a[1]}}(tuscheme$0tuscheme$1.freetyvars$2241(h))||function(a){for(;;){if(null==a)return!1;if(a[0]==c)return!0;a=a[1]}}(tuscheme$0tuscheme$1.freetyvars$2241(d))?f.$streamFilter(b):[2,[c,f.$streamFilter(b)]]}}]]]}};var g=f.$streamFilter;g=g(tuscheme$0tuscheme$1.infiniteTyvars$2884);c=c(e,g);e=function(a,b){for(;;){if(null==a)return b;a=a[1];b=SmlPrims.chk_ovf_i32(b+1)}}(a,0);g=function(a,b){for(;;){if(null==a)return b;a=a[1];b=SmlPrims.chk_ovf_i32(b+
1)}}(b,0);return e==g?P.$eqType(tuscheme$0tuscheme$1.tysubst$2774(h,tuscheme$0tuscheme$1.bindList$174(a,basis$0List$1.map$697(function(a){return[0,a]},c),tuscheme$0tuscheme$1.emptyEnv$137(0))),tuscheme$0tuscheme$1.tysubst$2774(d,tuscheme$0tuscheme$1.bindList$174(b,basis$0List$1.map$697(function(a){return[0,a]},c),tuscheme$0tuscheme$1.emptyEnv$137(0)))):!1;default:return!1}}},$eqTypes:function(a,b){if(null==a)return null==b?!0:!1;if(null==b)return!1;var c=a[1],e=b[1];return P.$eqType(a[0],b[0])?P.$eqTypes(c,
e):!1}};tuscheme$0tuscheme$1.eqType$2889=P.$eqType;tuscheme$0tuscheme$1.eqTypes$2888=P.$eqTypes;tuscheme$0tuscheme$1.appearsUnprotectedIn$3014=function(a,b){var c={$evaluatesX:function(b){a:for(;;)switch(b[0]){case 5:return!1;case 1:return b[1]==a;case 4:b=b[1][1];continue a;case 0:b=b[1];var e=b[1];if(c.$evaluatesX(b[0]))return!0;b=e;continue a;case 10:return b=b[1],e=b[1],c.$evaluatesX(b[0])?!0:function(a){for(;;){if(null==a)return!1;var b=a[1];if(c.$evaluatesX(a[0]))return!0;a=b}}(e);case 6:switch(b=
b[1],b[0][0]){case 0:if(e=b[1],null==e){b=b[2];continue a}else{var h=e;e=h[0];var d=e[0];h=h[1];b=b[2];if(c.$evaluatesX(e[1]))return!0;if(a!=d){b=[6,[[0],h,b]];continue a}else return!1}default:e=b[1];b=b[2];if(function(a){for(;;){if(null==a)return!1;var b=a[1];if(c.$evaluatesX(a[0][1]))return!0;a=b}}(e))return!0;if(function(b){for(;;){if(null==b)return!1;if(b[0][0]==a)return!0;b=b[1]}}(e))return!1;continue a}case 8:b=b[1];e=b[1];d=b[2];if(c.$evaluatesX(b[0])||c.$evaluatesX(e))return!0;b=d;continue a;
case 9:return function(a){for(;;){if(null==a)return!1;var b=a[1];if(c.$evaluatesX(a[0]))return!0;a=b}}(b[1]);case 7:return!1;case 3:b=b[1][0];continue a;default:b=b[1][1]}}},e=c.$evaluatesX;return e(b)};var Y={$typeof:function(a,b,c){var e={$literal:function(a){switch(a[0]){case 4:return[3,[["'a",null],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]]]];case 2:a=a[1];var b=a[1];return e.$listLiteral(e.$literal(a[0]),b);case 6:return tuscheme$0tuscheme$1.booltype$2192;case 3:return tuscheme$0tuscheme$1.inttype$2191;
case 0:return tuscheme$0tuscheme$1.symtype$2193;default:throw[new String("ThisCan'tHappen")];}},$listLiteral:function(a,b){switch(b[0]){case 4:return[4,[[1,"list"],[a,null]]];case 2:b=b[1];var c=b[1];if(tuscheme$0tuscheme$1.eqType$2889(a,e.$literal(b[0])))return e.$listLiteral(a,c);throw[tuscheme$0tuscheme$1.en$TypeError$87,"mixed types in list literal"];default:throw[new String("ThisCan'tHappen")];}}},h=e.$literal,d={$ty:function(a){a:for(;;)switch(a[0]){case 5:return h(a[1]);case 1:return tuscheme$0tuscheme$1.find$139(a[1],
c);case 4:var e=a[1];a=e[0];var f=e[1];e=tuscheme$0tuscheme$1.find$139(a,c);f=d.$ty(f);if(tuscheme$0tuscheme$1.eqType$2889(e,f))return e;throw[tuscheme$0tuscheme$1.en$TypeError$87,"Set variable "+a+" of type "+tuscheme$0tuscheme$1.typeString$2200(e)+" to value of type "+tuscheme$0tuscheme$1.typeString$2200(f)];case 0:e=a[1];a=e[1];e=d.$ty(e[0]);d.$ty(a);if(tuscheme$0tuscheme$1.eqType$2889(e,tuscheme$0tuscheme$1.booltype$2192))return tuscheme$0tuscheme$1.unittype$2194;throw[tuscheme$0tuscheme$1.en$TypeError$87,
"Condition in while expression has type "+tuscheme$0tuscheme$1.typeString$2200(e)+", which should be "+tuscheme$0tuscheme$1.typeString$2200(tuscheme$0tuscheme$1.booltype$2192)];case 10:switch(e=a[1],a=e[0],e=e[1],e=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([d.$ty]),e),f=d.$ty(a),f[0]){case 2:f=f[1];var v=f[1];if(tuscheme$0tuscheme$1.eqTypes$2888(e,f[0]))return v;throw[tuscheme$0tuscheme$1.en$TypeError$87,"function of type "+tuscheme$0tuscheme$1.typeString$2200(d.$ty(a))+
" received arguments of types ("+tuscheme$0tuscheme$1.spaceSep$414(basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([tuscheme$0tuscheme$1.typeString$2200]),e))+")"];case 3:throw[tuscheme$0tuscheme$1.en$TypeError$87,"function is polymorphic; instantiate before applying"];default:throw[tuscheme$0tuscheme$1.en$TypeError$87,"tried to apply non-function of type "+tuscheme$0tuscheme$1.typeString$2200(d.$ty(a))];}case 6:switch(a=a[1],a[0][0]){case 0:e=a[1];a=null==e?a[2]:[6,[[1],
[e[0],null],[6,[[0],e[1],a[2]]]]];continue a;default:return e=a[2],a=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[0];c=c[1];a=[[b[0],d.$ty(b[1])],a];b=c}}(c,a[1]),Y.$typeof(e,b,a)}case 8:f=a[1];a=f[0];e=f[1];f=f[2];if(tuscheme$0tuscheme$1.eqType$2889(d.$ty(a),tuscheme$0tuscheme$1.booltype$2192)){a=d.$ty(e);e=d.$ty(f);if(tuscheme$0tuscheme$1.eqType$2889(a,e))return a;throw[tuscheme$0tuscheme$1.en$TypeError$87,"incompatible types "+tuscheme$0tuscheme$1.typeString$2200(a)+" and "+tuscheme$0tuscheme$1.typeString$2200(e)+
" across branches of if"];}throw[tuscheme$0tuscheme$1.en$TypeError$87,"condition in if has type "+tuscheme$0tuscheme$1.typeString$2200(d.$ty(a))];case 9:return a=a[1],a=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([d.$ty]),a),function(a,b){for(;;){if(null==b)return a;a=b;b=a[1];a=a[0]}}(tuscheme$0tuscheme$1.unittype$2194,a);case 7:return e=a[1],a=e[0],e=e[1],f=function(a,c){for(;;){if(null==c)return a;var e=c[0];c=c[1];var h=e[1];e=e[0];if(null!=tuscheme$0tuscheme$1.kindof$2329(h,
b))throw[tuscheme$0tuscheme$1.en$TypeError$87,"used type constructor `"+tuscheme$0tuscheme$1.typeString$2200(h)+"' as a type"];a=[[e,h],a]}}(c,a),e=Y.$typeof(e,b,f),[2,[basis$0List$1.map$697(function(a){return function(a){return a[1]}}([]),a),e]];case 3:return a=a[1],e=a[1],tuscheme$0tuscheme$1.instantiate$2851(d.$ty(a[0]),e,b);default:return e=a[1],a=e[0],e=e[1],f=function(a,b){for(;;){if(null==b)return a;var c=b[1];a=[[""+b[0],null],a];b=c}}(b,a),[3,[a,Y.$typeof(e,f,c)]]}}},f=d.$ty;return f(a)}};
tuscheme$0tuscheme$1.typeof$3161=Y.$typeof;tuscheme$0tuscheme$1.elabdef$3424=function(a,b,c){a:for(;;)switch(a[0]){case 1:var e=a[1];a=e[0];b=tuscheme$0tuscheme$1.typeof$3161(e[1],b,c);return[[[a,b],c],tuscheme$0tuscheme$1.typeString$2200(b)];case 2:a=[1,["it",a[1]]];continue a;case 3:e=a[1];a=e[0];var h=e[1];e=e[2];var d=e[0];h=[2,[basis$0List$1.map$697(function(a){return function(a){return a[1]}}([]),d),h]];a=[0,[a,h,[7,e]]];continue a;default:e=a[1];a=e[0];h=e[1];e=e[2];if(null!=tuscheme$0tuscheme$1.kindof$2329(h,
b))throw[tuscheme$0tuscheme$1.en$TypeError$87,"used type constructor `"+tuscheme$0tuscheme$1.typeString$2200(h)+"' as a type"];c=[[a,h],c];b=tuscheme$0tuscheme$1.typeof$3161(e,b,c);if(tuscheme$0tuscheme$1.eqType$2889(h,b)){if(tuscheme$0tuscheme$1.appearsUnprotectedIn$3014(a,e))throw[tuscheme$0tuscheme$1.en$TypeError$87,"identifier "+a+" is evaluated in right-hand side of val-rec"];return[c,tuscheme$0tuscheme$1.typeString$2200(h)]}throw[tuscheme$0tuscheme$1.en$TypeError$87,"identifier "+a+" is declared to have type "+
tuscheme$0tuscheme$1.typeString$2200(h)+" but has actual type "+tuscheme$0tuscheme$1.typeString$2200(b)];}};tuscheme$0tuscheme$1.pretokenString$3492=function(a){switch(a[0]){case 1:return"'";case 3:return tuscheme$0tuscheme$1.intString$351(a[1]);case 0:return a[1]?"#t":"#f";default:return a[1]}};tuscheme$0tuscheme$1.tokenString$3516=function(a){switch(a[0]){case 2:switch(a[1]){case 1:return"(";case 0:return"[";default:return"{"}case 0:switch(a[1]){case 1:return")";case 0:return"]";default:return"}"}default:switch(a=
a[1],a[0]){case 1:return"'";case 3:return tuscheme$0tuscheme$1.intString$351(a[1]);case 0:return a[1]?"#t":"#f";default:return a[1]}}};tuscheme$0tuscheme$1.schemeToken$3546;n=tuscheme$0tuscheme$1.bracketLexer$1563;var Q=[1];var pa=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return Q}],a]]},function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:return 39==
b[1]?a:[1];default:return a}default:return a}});var x=tuscheme$0tuscheme$1.intChars$1508(function(a){if(32==a||9<=a&&13>=a)a=!0;else a:{var b=0;for(;;){if(7<=b){a=!1;break a}if("()[]{};".charCodeAt(b)==a){a=!0;break a}b=SmlPrims.chk_ovf_i32(b+1)}}return a});x=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){return tuscheme$0tuscheme$1.intFromChars$1513(a)}],a]]},x);var sa=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[3,a]}],a]]},x);var qa=function(a){var b=
pa(a);switch(b[0]){case 0:return[0,b[1]];default:return sa(a)}};var ma=function(a){a=tuscheme$0tuscheme$1.streamGet$703(a);switch(a[0]){case 1:a=[1];break;default:a=a[1],a=[0,[[0,a[0]],a[1]]]}switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:b=b[1];if(32==b||9<=b&&13>=b)b=!0;else a:{var c=0;for(;;){if(7<=c){b=!1;break a}if("()[]{};".charCodeAt(c)==b){b=!0;break a}c=SmlPrims.chk_ovf_i32(c+1)}}return b?[1]:a;default:return a}default:return a}};x=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){return ma(a)}),tuscheme$0tuscheme$1.many$1261(function(a){return ma(a)}));var ra=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){a=SmlPrims.implode(a);switch(a){case "#t":return[0,!0];case "#f":return[0,!1];default:return[2,a]}}],a]]},x);var ea=function(a){var b=qa(a);switch(b[0]){case 0:return[0,b[1]];default:return ra(a)}};n=n(function(a){var b=ea(a);switch(b[0]){case 0:return[0,b[1]];default:switch(a=tuscheme$0tuscheme$1.streamGet$703(a),
a[0]){case 1:return[1];default:switch(a=a[1],b=a[0],b){case 59:return[1];default:return[0,[[1,"invalid initial character in `"+SmlPrims.implode([b,tuscheme$0tuscheme$1.listOfStream$726(a[1])])+"'"],[1]]]}}}});tuscheme$0tuscheme$1.schemeToken$3546=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},tuscheme$0tuscheme$1.whitespace$1507),n);tuscheme$0tuscheme$1.pretoken$3548=function(a){a=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return a[1]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 1:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.quote$3556=function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,
[[1,a[1]],b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}};tuscheme$0tuscheme$1.int$3561=function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 3:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.booltok$3569=
function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 0:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.any_name$3585=function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];
switch(b[0]){case 2:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.arrow$3586=function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 2:switch(b[1]){case "->":b=[0,0];break;default:b=[1]}break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}};tuscheme$0tuscheme$1.name$3595=
function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:a=[1];break;default:a=a[1];var b=a[0];switch(b[0]){case 1:a=[0,[[1,b[1]],a[1]]];break;default:b=b[1];a=a[1];switch(b[0]){case 2:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:a=[1];break;default:a=[0,[[0,b[1]],a]]}}}switch(a[0]){case 0:switch(b=a[1][0],b[0]){case 0:return"->"!=b[1]?a:[1];default:return a}default:return a}};tuscheme$0tuscheme$1.tyvar$3599;n=tuscheme$0tuscheme$1.s$jml$1604(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return"'"+a}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}),"type variable (got quote mark)");tuscheme$0tuscheme$1.tyvar$3599=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,[[1,a[1]],b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=
[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}}),n);tuscheme$0tuscheme$1.formalsOf$3600=function(a,b,c){var e=tuscheme$0tuscheme$1.nodups$1640("formal parameter",c);b=tuscheme$0tuscheme$1.many$1261(b);a=tuscheme$0tuscheme$1.liberalBracket$1841(a,tuscheme$0tuscheme$1.s$jml$1604(b,a));a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),a);return tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,e],a]]},a)};tuscheme$0tuscheme$1.bindingsOf$3610=function(a,b,c){b=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},b),c);b=tuscheme$0tuscheme$1.liberalBracket$1841(a,tuscheme$0tuscheme$1.s$jml$1604(b,
a));a="(... "+a+" ...) in bindings";b=tuscheme$0tuscheme$1.many$1261(b);return tuscheme$0tuscheme$1.liberalBracket$1841(a,tuscheme$0tuscheme$1.s$jml$1604(b,a))};tuscheme$0tuscheme$1.distinctBsIn$3621=function(a,b){a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);
switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),a);return tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){var c=a[0];a=a[1];c=tuscheme$0tuscheme$1.nodups$1640("bound name",b)([c,basis$0List$1.map$697(function(a){return a[0]},a)]);switch(c[0]){case 0:return[0,a];default:return[1,c[1]]}}],a]]},a)};tuscheme$0tuscheme$1.recordFieldsOf$3637=function(a){var b=tuscheme$0tuscheme$1.nodups$1640("record fields","record definition");a=tuscheme$0tuscheme$1.many$1261(a);a=
tuscheme$0tuscheme$1.liberalBracket$1841("(field ...)",tuscheme$0tuscheme$1.s$jml$1604(a,"(field ...)"));a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),a);return tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,
[[0,b],a]]},a)};tuscheme$0tuscheme$1.kw$3641=function(a,b){b=tuscheme$0tuscheme$1.pretoken$3548(b);switch(b[0]){case 1:b=[1];break;default:b=b[1];var c=b[0];switch(c[0]){case 1:b=[0,[[1,c[1]],b[1]]];break;default:c=c[1];b=b[1];switch(c[0]){case 2:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:b=[1];break;default:b=[0,[[0,c[1]],b]]}}}switch(b[0]){case 0:switch(c=b[1][0],c[0]){case 0:return a==c[1]?b:[1];default:return b}default:return b}};tuscheme$0tuscheme$1.usageParsers$3645=function(a){a=basis$0List$1.map$697(tuscheme$0tuscheme$1.usageParser$1871(function(a){return function(b){return tuscheme$0tuscheme$1.kw$3641(a,
b)}}),a);var b={$foldr:function(a){if(null==a)return function(a){return[1]};var c=a[0],e=b.$foldr(a[1]);return function(a){var b=c(a);switch(b[0]){case 0:return[0,b[1]];default:return e(a)}}}},c=b.$foldr;return c(a)};tuscheme$0tuscheme$1.notDot$3649=function(a,b){switch(b){case ".":return[1,tuscheme$0tuscheme$1.synerrormsg$1331(a[0],a[1])(["this interpreter cannot handle . in quoted S-expressions",null])];default:return[0,b]}};var ja=function(a){for(;;){var b=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,
[[0,function(a){return function(a){return function(a){return function(b){return[a[0],b]}}([a])}}([])],a]]}}([]),function(a){return function(b){var c=a[0];c=(0,a[1])(function(a){return function(a){return[0,[[0,function(a){return function(a){return a[0]}}([])],a]]}}([]),function(a){return function(b){return(0,a[0])(b)}}([c]))(b);switch(c[0]){case 0:return[0,[c[1][0],b]];default:return[1]}}}([tuscheme$0tuscheme$1.inline$1491,tuscheme$0tuscheme$1.s$jtl$1007])),function(a){return function(b){b=(0,a[0])(b);
switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 2:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548]));b=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return function(b){return[0,[[0,function(a){return function(b){var c=a[0],e=b[1];switch(e){case ".":return b=b[0],[1,c(b[0],b[1])(["this interpreter cannot handle . in quoted S-expressions",
null])];default:return[0,e]}}}([a[0]])],b]]}}([tuscheme$0tuscheme$1.synerrormsg$1331]),b);b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return[0,a]}}([])],a]]}}([]),b);b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return[3,a]}}([])],a]]}}([]),function(a){return function(b){b=
(0,a[0])(b);switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 3:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548])),b]);b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return[6,
a]}}([])],a]]}}([]),function(a){return function(b){b=(0,a[0])(b);switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 0:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548])),b]);b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jal$1611(function(a){return function(b){b=
(0,a[0])(b);switch(b[0]){case 0:var c=b[1][0];switch(c[0]){case 0:switch(c[1][1]){case 2:c=!1;break;default:c=!0}return c?[1]:b;default:return b}default:return b}}}([tuscheme$0tuscheme$1.left$1682]),"curly brackets may not be used in S-expressions"),b]);var c=tuscheme$0tuscheme$1.many$1261(function(a){return function(b){return(0,a[0])(b)}}([ja]));c=tuscheme$0tuscheme$1.liberalBracket$1841("list of S-expressions",tuscheme$0tuscheme$1.s$jml$1604(c,"list of S-expressions"));b=function(a){return function(b){var c=
a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(b){return[0,[[0,function(a){return function(b){return(0,a[0])(b)}}([a[0]])],b]]}}([tuscheme$0tuscheme$1.embedList$2642]),c),b]);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(a){return a}}([])}}([])],a]]}}([]),function(a){return function(b){b=
(0,a[0])(b);switch(b[0]){case 1:return[1];default:var c=b[1];b=c[0];switch(b[0]){case 1:return[0,[[1,b[1]],c[1]]];default:c=c[1];switch(b[1][0]){case 1:b=[0,0];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],c]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548])),function(a){return function(b){return(0,a[0])(b)}}([ja]));c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(b){return[0,[[0,function(a){return function(b){return(0,a[0])([[0,"quote"],[b,null]])}}([a[0]])],
b]]}}([tuscheme$0tuscheme$1.embedList$2642]),c);b=b(a);switch(b[0]){case 0:return[0,b[1]];default:return c(a)}}};tuscheme$0tuscheme$1.sexp$3650=ja;tuscheme$0tuscheme$1.atomicSchemeExpOf$3670=function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[1,a]}],a]]},a);a=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[3,a]}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,
[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 3:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}});var c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},a);var e=function(a){var e=b(a);switch(e[0]){case 0:return[0,e[1]];default:return c(a)}};a=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[6,a]}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];
default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 0:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}});var d=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},a);return function(a){var b=e(a);switch(b[0]){case 0:return[0,b[1]];default:return d(a)}}};var aa={$fullSchemeExpOf:function(a,b){var c=b(function(c){return aa.$fullSchemeExpOf(a,b)(c)});var e=function(b){var e=
a(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}};var d=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},function(a){return tuscheme$0tuscheme$1.sexp$3650(a)});var h=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,[[1,a[1]],
b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}}),d);var f=function(a){var b=e(a);switch(b[0]){case 0:return[0,b[1]];default:return h(a)}};d=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){var b=a[0];switch(a[1]){case 1:a=")";break;case 0:a="]";break;default:a="}"}a="quote ' followed by right bracket "+a;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)});
var g=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,[[1,a[1]],b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}}),d);var k=function(a){var b=f(a);switch(b[0]){case 0:return[0,b[1]];default:return g(a)}};
var fa=tuscheme$0tuscheme$1.s$jal$1611(function(a){a=tuscheme$0tuscheme$1.left$1682(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:switch(b[1][1]){case 2:b=!1;break;default:b=!0}return b?[1]:a;default:return a}default:return a}},"curly brackets are not supported");var l=function(a){var b=k(a);switch(b[0]){case 0:return[0,b[1]];default:return fa(a)}};var m=tuscheme$0tuscheme$1.s$jal$1611(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],
a]]},function(a){return tuscheme$0tuscheme$1.left$1682(a)}),function(a){return tuscheme$0tuscheme$1.right$1696(a)}),"empty application");var q=function(a){var b=l(a);switch(b[0]){case 0:return[0,b[1]];default:return m(a)}};d=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[10,[a,b]]}}],a]]},function(c){return aa.$fullSchemeExpOf(a,b)(c)}),tuscheme$0tuscheme$1.many$1261(function(c){return aa.$fullSchemeExpOf(a,b)(c)}));var r=
tuscheme$0tuscheme$1.liberalBracket$1841("function application",tuscheme$0tuscheme$1.s$jml$1604(d,"function application"));return function(a){var b=q(a);switch(b[0]){case 0:return[0,b[1]];default:return r(a)}}}};tuscheme$0tuscheme$1.fullSchemeExpOf$3678=aa.$fullSchemeExpOf;tuscheme$0tuscheme$1.typedFormalOf$3691=function(a,b,c){var e=tuscheme$0tuscheme$1.s$jtl$1007;a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],
a]]},a),b);a=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},a);c=e(a,c);return tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",tuscheme$0tuscheme$1.s$jml$1604(c,"[x : ty]"))};tuscheme$0tuscheme$1.typedFormalsOf$3701=function(a,b,c,d){var e=tuscheme$0tuscheme$1.s$jtl$1007;a=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],a]]},a),b);a=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return[a,b]}}],a]]},a);c=e(a,c);e=tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",tuscheme$0tuscheme$1.s$jml$1604(c,"[x : ty]"));c=tuscheme$0tuscheme$1.distinctBsIn$3621;e=tuscheme$0tuscheme$1.many$1261(e);e=tuscheme$0tuscheme$1.liberalBracket$1841("(... [x : ty] ...)",tuscheme$0tuscheme$1.s$jml$1604(e,"(... [x : ty] ...)"));return c(e,d)};tuscheme$0tuscheme$1.distinctTyvars$3715;var va=tuscheme$0tuscheme$1.nodups$1640("quantified type variable","forall");n=
tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.tyvar$3599);n=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),n);tuscheme$0tuscheme$1.distinctTyvars$3715=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,
[[0,va],a]]},n);tuscheme$0tuscheme$1.arrowsOf$3716=function(a,b,c,d){return null==c?null==d?[1,"empty type ()"]:null==d[1]?(a=d[0],null==a?[1,"no result type after function arrow"]:null==a[1]?[0,b([c,a[0]])]:[1,"multiple result types after function arrow"]):[1,"multiple arrows in function type"]:null==d?[0,a([c[0],c[1]])]:null==d[1]?(a=d[0],null==a?[1,"no result type after function arrow"]:null==a[1]?[0,b([c,a[0]])]:[1,"multiple result types after function arrow"]):[1,"multiple arrows in function type"]};
tuscheme$0tuscheme$1.keyword$3768=function(a,b){b=tuscheme$0tuscheme$1.name$3595(b);switch(b[0]){case 0:var c=b[1][0];switch(c[0]){case 0:c=c[1];a:for(;;){if(null==a){a=!1;break a}if(c==a[0]){a=!0;break a}a=a[1]}return a?b:[1];default:return b}default:return b}};tuscheme$0tuscheme$1.expKeyword$3779;var wa=["if",["while",["set",["begin",["lambda",["type-lambda",["let",["let*",["@",null]]]]]]]]];tuscheme$0tuscheme$1.expKeyword$3779=function(a){a=tuscheme$0tuscheme$1.name$3595(a);switch(a[0]){case 0:var b=
a[1][0];switch(b[0]){case 0:b=b[1];a:{var c=wa;for(;;){if(null==c){b=!1;break a}if(b==c[0]){b=!0;break a}c=c[1]}}return b?a:[1];default:return a}default:return a}};tuscheme$0tuscheme$1.tyKeyword$3780;var xa=["forall",["function",["->",null]]];tuscheme$0tuscheme$1.tyKeyword$3780=function(a){a=tuscheme$0tuscheme$1.name$3595(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:b=b[1];a:{var c=xa;for(;;){if(null==c){b=!1;break a}if(b==c[0]){b=!0;break a}c=c[1]}}return b?a:[1];default:return a}default:return a}};
tuscheme$0tuscheme$1.tlformals$3781;var ya=tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda");n=tuscheme$0tuscheme$1.many$1261(function(a){return tuscheme$0tuscheme$1.name$3595(a)});n=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);
switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),n);tuscheme$0tuscheme$1.tlformals$3781=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,ya],a]]},n);tuscheme$0tuscheme$1.nodupsty$3782=function(a,b){var c=b[0];b=b[1];a=tuscheme$0tuscheme$1.nodups$1640(a[0],a[1])([c,basis$0List$1.map$697(function(a){return a[0]},b)]);switch(a[0]){case 0:return[0,b];default:return[1,a[1]]}};tuscheme$0tuscheme$1.letDups$3794=function(a,b){switch(a[0]){case 0:return[0,b[1]];default:switch(a=b[0],
b=b[1],a=tuscheme$0tuscheme$1.nodups$1640("bound variable","let")([a,basis$0List$1.map$697(function(a){return a[0]},b)]),a[0]){case 0:return[0,b];default:return[1,a[1]]}}};tuscheme$0tuscheme$1.arrows$3811=function(a){return function(b){return tuscheme$0tuscheme$1.arrowsOf$3716(function(a){return[4,a]},function(a){return[2,a]},a,b)}};var ca=function(a){for(;;){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return[1,a]}}([])],a]]}}([]),
function(a){return function(b){return(0,a[0])(b)}}([tuscheme$0tuscheme$1.name$3595]));b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return[0,a]}}([])],a]]}}([]),tuscheme$0tuscheme$1.tyvar$3599),b]);var c=tuscheme$0tuscheme$1.s$jtl$1007;var e=tuscheme$0tuscheme$1.liberalBracket$1841("('a ...)",tuscheme$0tuscheme$1.s$jml$1604(tuscheme$0tuscheme$1.distinctTyvars$3715,
"('a ...)"));e=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(b){return[3,[a[0],b]]}}([a])}}([])],a]]}}([]),e);e=c(e,function(a){return function(b){return(0,a[0])(b)}}([ca]));c=tuscheme$0tuscheme$1.liberalBracket$1841;e=tuscheme$0tuscheme$1.s$jml$1604(e,"(forall (tyvars) type)");e=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(a){return a}}([])}}([])],
a]]}}([]),function(a){return function(b){return(0,a[0])("forall",b)}}([tuscheme$0tuscheme$1.kw$3641])),e);b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([c("(forall (tyvars) type)",e),b]);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(b){return[a[0],b]}}([a])}}([])],a]]}}([]),function(a){return function(b){var c=
a[0];c=(0,a[1])(function(a){return function(a){return[0,[[0,function(a){return function(a){return a[0]}}([])],a]]}}([]),function(a){return function(b){return(0,a[0])(b)}}([c]))(b);switch(c[0]){case 0:return[0,[c[1][0],b]];default:return[1]}}}([tuscheme$0tuscheme$1.inline$1491,tuscheme$0tuscheme$1.s$jtl$1007])),tuscheme$0tuscheme$1.expKeyword$3779);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(a){return a}}([])}}([])],
a]]}}([]),function(a){return function(b){return(0,a[0])(b)}}([tuscheme$0tuscheme$1.left$1682])),c);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(b){return a[0]}}([a])}}([])],a]]}}([]),c),function(a){return function(b){var c=a[0],e=a[1];e=(0,a[2])(function(a){return function(a){return[0,[[0,function(a){return function(a){return[2,a]}}([])],a]]}}([]),function(a){return function(b){return(0,a[0])(b)}}([e]))(b);
switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.scanToClose$1731,tuscheme$0tuscheme$1.right$1696,tuscheme$0tuscheme$1.s$jtl$1007]));b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jtla$1279(function(a){return function(b){return[0,[[0,function(a){return function(b){var c=b[0];b="looking for type but found `"+b[1]+"'";return[1,(0,a[0])(c[0],c[1])([b,null])]}}([a[0]])],b]]}}([tuscheme$0tuscheme$1.synerrormsg$1331]),
c),b]);c=tuscheme$0tuscheme$1.s$jtla$1279;e=tuscheme$0tuscheme$1.many$1261(function(a){return function(b){return(0,a[0])(b)}}([ca]));e=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(b){return[0,[[0,function(a){return function(b){return function(a){return function(b){var c=a[0];return(0,a[1])(function(a){return function(a){return[4,a]}}([]),function(a){return function(a){return[2,a]}}([]),c,b)}}([b,a[0]])}}([a[0]])],b]]}}([tuscheme$0tuscheme$1.arrowsOf$3716]),e);var d=tuscheme$0tuscheme$1.many$1261;
var f=tuscheme$0tuscheme$1.many$1261(function(a){return function(b){return(0,a[0])(b)}}([ca]));f=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return function(a){return[0,[[0,function(a){return function(a){return function(a){return function(a){return a}}([])}}([])],a]]}}([]),function(a){return function(b){b=(0,a[0])(b);switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 2:switch(c[1]){case "->":c=
[0,0];break;default:c=[1]}break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548])),f);d=d(f);c=c(e,d);b=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.liberalBracket$1841("type application or function type",tuscheme$0tuscheme$1.s$jml$1604(c,"type application or function type")),b]);c=function(a){return function(b){var c=a[0],e=(0,a[1])(b);switch(e[0]){case 0:return[0,
e[1]];default:return c(b)}}}([tuscheme$0tuscheme$1.s$jal$1611(function(a){return function(b){b=(0,a[0])(b);switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 3:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548]),"expected type; found integer"),b]);b=tuscheme$0tuscheme$1.s$jal$1611(function(a){return function(b){b=(0,a[0])(b);
switch(b[0]){case 1:return[1];default:b=b[1];var c=b[0];switch(c[0]){case 1:return[0,[[1,c[1]],b[1]]];default:c=c[1];b=b[1];switch(c[0]){case 0:c=[0,c[1]];break;default:c=[1]}switch(c[0]){case 1:return[1];default:return[0,[[0,c[1]],b]]}}}}}([tuscheme$0tuscheme$1.pretoken$3548]),"expected type; found Boolean literal");c=c(a);switch(c[0]){case 0:return[0,c[1]];default:return b(a)}}};tuscheme$0tuscheme$1.ty$3814=ca;tuscheme$0tuscheme$1.flipPair$3828=function(a,b){return[b,a]};tuscheme$0tuscheme$1.formal$3835;
n=tuscheme$0tuscheme$1.s$jtl$1007;x=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}),function(a){return tuscheme$0tuscheme$1.kw$3641(":",a)});x=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},x);n=n(x,function(a){return tuscheme$0tuscheme$1.ty$3814(a)});tuscheme$0tuscheme$1.formal$3835=tuscheme$0tuscheme$1.liberalBracket$1841("[x : ty]",
tuscheme$0tuscheme$1.s$jml$1604(n,"[x : ty]"));tuscheme$0tuscheme$1.lformals$3836;n=tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.formal$3835);tuscheme$0tuscheme$1.lformals$3836=tuscheme$0tuscheme$1.liberalBracket$1841("([x : ty] ...)",tuscheme$0tuscheme$1.s$jml$1604(n,"([x : ty] ...)"));tuscheme$0tuscheme$1.tformals$3837;n=tuscheme$0tuscheme$1.many$1261(tuscheme$0tuscheme$1.tyvar$3599);tuscheme$0tuscheme$1.tformals$3837=tuscheme$0tuscheme$1.liberalBracket$1841("('a ...)",tuscheme$0tuscheme$1.s$jml$1604(n,
"('a ...)"));tuscheme$0tuscheme$1.lambda$3838=function(a,b){return function(c){var e=tuscheme$0tuscheme$1.nodups$1640("formal parameter","lambda")([a,basis$0List$1.map$697(function(a){return a[0]},b)]);switch(e[0]){case 0:e=[0,b];break;default:e=[1,e[1]]}switch(e[0]){case 0:return[0,[7,[e[1],c]]];default:return[1,e[1]]}}};tuscheme$0tuscheme$1.tylambda$3848=function(a,b){a=tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda")(a);switch(a[0]){case 0:return[0,[2,[a[1],b]]];default:return[1,
a[1]]}};tuscheme$0tuscheme$1.cb$3858=function(a,b,c){var e=tuscheme$0tuscheme$1.liberalBracket$1841;c=tuscheme$0tuscheme$1.s$jml$1604(c,b);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(b){b=tuscheme$0tuscheme$1.name$3595(b);switch(b[0]){case 0:var c=b[1][0];switch(c[0]){case 0:return a==c[1]?b:[1];default:return b}default:return b}}),c);return e(b,c)};tuscheme$0tuscheme$1.badTyKeyword$3868=function(a,
b){b="looking for expression but found `"+b+"'";return[1,tuscheme$0tuscheme$1.synerrormsg$1331(a[0],a[1])([b,null])]};tuscheme$0tuscheme$1.letrec$3870=function(a,b){return[1,"letrec is not included in Typed uScheme"]};tuscheme$0tuscheme$1.letx$3871=function(a,b,c){switch(a[0]){case 0:var e=[0,b[1]];break;default:switch(e=b[0],b=b[1],e=tuscheme$0tuscheme$1.nodups$1640("bound variable","let")([e,basis$0List$1.map$697(function(a){return a[0]},b)]),e[0]){case 0:e=[0,b];break;default:e=[1,e[1]]}}switch(e[0]){case 0:return[0,
[6,[a,e[1],c]]];default:return[1,e[1]]}};var z={$exp:function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[1,a]}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}),c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[3,a]}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 3:b=
[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}});var e=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},c);var d=function(a){var c=b(a);switch(c[0]){case 0:return[0,c[1]];default:return e(a)}};c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[6,a]}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:a=a[1];var b=a[0];switch(b[0]){case 1:return[0,
[[1,b[1]],a[1]]];default:b=b[1];a=a[1];switch(b[0]){case 0:b=[0,b[1]];break;default:b=[1]}switch(b[0]){case 1:return[1];default:return[0,[[0,b[1]],a]]}}}});var f=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},c);var g=function(a){var b=d(a);switch(b[0]){case 0:return[0,b[1]];default:return f(a)}};c=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[5,a]}],a]]},function(a){return tuscheme$0tuscheme$1.sexp$3650(a)});var k=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,[[1,a[1]],b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}}),c);var l=function(a){var b=g(a);switch(b[0]){case 0:return[0,b[1]];default:return k(a)}};c=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){var b=
a[0];switch(a[1]){case 1:a=")";break;case 0:a="]";break;default:a="}"}a="quote mark ' followed by right bracket "+a;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)});var m=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){a=tuscheme$0tuscheme$1.pretoken$3548(a);switch(a[0]){case 1:return[1];default:var b=a[1];a=b[0];switch(a[0]){case 1:return[0,
[[1,a[1]],b[1]]];default:b=b[1];switch(a[1][0]){case 1:a=[0,0];break;default:a=[1]}switch(a[0]){case 1:return[1];default:return[0,[[0,a[1]],b]]}}}}),c);var q=function(a){var b=l(a);switch(b[0]){case 0:return[0,b[1]];default:return m(a)}};var r=tuscheme$0tuscheme$1.cb$3858("if","(if e1 e2 e3)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return function(c){return[8,[a,b,c]]}}}],a]]},function(a){return z.$exp(a)}),
function(a){return z.$exp(a)}),function(a){return z.$exp(a)}));var n=function(a){var b=q(a);switch(b[0]){case 0:return[0,b[1]];default:return r(a)}};var p=tuscheme$0tuscheme$1.cb$3858("while","(while e1 e2)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[0,[a,b]]}}],a]]},function(a){return z.$exp(a)}),function(a){return z.$exp(a)}));var u=function(a){var b=n(a);switch(b[0]){case 0:return[0,b[1]];default:return p(a)}};
var x=tuscheme$0tuscheme$1.cb$3858("set","(set x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[4,[a,b]]}}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}),function(a){return z.$exp(a)}));var W=function(a){var b=u(a);switch(b[0]){case 0:return[0,b[1]];default:return x(a)}};c=tuscheme$0tuscheme$1.cb$3858;var w=tuscheme$0tuscheme$1.many$1261(function(a){return z.$exp(a)});w=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return[9,a]}],a]]},w);var ba=c("begin","",w);var y=function(a){var b=W(a);switch(b[0]){case 0:return[0,b[1]];default:return ba(a)}};c=tuscheme$0tuscheme$1.cb$3858;w=tuscheme$0tuscheme$1.s$jtla$1279;var t=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);
switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),tuscheme$0tuscheme$1.lformals$3836);t=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return tuscheme$0tuscheme$1.lambda$3838(a[0],a[1])}],a]]},t);w=w(t,function(a){return z.$exp(a)});var ua=c("lambda","(lambda (formals) body)",w);var A=function(a){var b=y(a);switch(b[0]){case 0:return[0,b[1]];default:return ua(a)}};c=tuscheme$0tuscheme$1.cb$3858;w=tuscheme$0tuscheme$1.s$jtla$1279;t=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),tuscheme$0tuscheme$1.tformals$3837);t=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){var c=tuscheme$0tuscheme$1.nodups$1640("formal type parameter","type-lambda")(a);switch(c[0]){case 0:return[0,
[2,[c[1],b]]];default:return[1,c[1]]}}}],a]]},t);w=w(t,function(a){return z.$exp(a)});var C=c("type-lambda","(type-lambda (tyvars) body)",w);var D=function(a){var b=A(a);switch(b[0]){case 0:return[0,b[1]];default:return C(a)}};c=tuscheme$0tuscheme$1.cb$3858;w=tuscheme$0tuscheme$1.s$jtla$1279;var E=[1];var G=function(a){return function(b){return tuscheme$0tuscheme$1.letx$3871(E,a,b)}};t=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,
b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),function(a){return z.$bindings(a)});t=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,G],a]]},t);w=w(t,function(a){return z.$exp(a)});var H=c("let","(let (bindings) body)",w);var I=function(a){var b=D(a);switch(b[0]){case 0:return[0,b[1]];default:return H(a)}};
var J=tuscheme$0tuscheme$1.cb$3858("letrec","(letrec (bindings) body)",tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return[1,"letrec is not included in Typed uScheme"]}}],a]]},function(a){return z.$bindings(a)}),function(a){return z.$exp(a)}));var K=function(a){var b=I(a);switch(b[0]){case 0:return[0,b[1]];default:return J(a)}};c=tuscheme$0tuscheme$1.cb$3858;w=tuscheme$0tuscheme$1.s$jtla$1279;var L=[0];var N=function(a){return function(b){return tuscheme$0tuscheme$1.letx$3871(L,
a,b)}};t=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),function(a){return z.$bindings(a)});t=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,N],a]]},t);w=w(t,function(a){return z.$exp(a)});
var O=c("let*","(let* (bindings) body)",w);var P=function(a){var b=K(a);switch(b[0]){case 0:return[0,b[1]];default:return O(a)}};var Q=tuscheme$0tuscheme$1.cb$3858("@","(@ exp types)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[3,[a,b]]}}],a]]},function(a){return z.$exp(a)}),tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){return tuscheme$0tuscheme$1.ty$3814(a)}),
tuscheme$0tuscheme$1.many$1261(function(a){return tuscheme$0tuscheme$1.ty$3814(a)}))));var S=function(a){var b=P(a);switch(b[0]){case 0:return[0,b[1]];default:return Q(a)}};c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,
[b[1][0],a]];default:return[1]}}),tuscheme$0tuscheme$1.tyKeyword$3780);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){return tuscheme$0tuscheme$1.left$1682(a)}),c);c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return a}}],a]]},c),function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[2,
a]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)})(a);switch(b[0]){case 0:return[0,b[1]];default:return tuscheme$0tuscheme$1.scanToClose$1731(a)}});var T=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){var b=a[0];a="looking for expression but found `"+a[1]+"'";return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]}],a]]},c);var V=function(a){var b=S(a);switch(b[0]){case 0:return[0,b[1]];default:return T(a)}};var X=tuscheme$0tuscheme$1.s$jal$1611(function(a){a=
tuscheme$0tuscheme$1.left$1682(a);switch(a[0]){case 0:var b=a[1][0];switch(b[0]){case 0:switch(b[1][1]){case 2:b=!1;break;default:b=!0}return b?[1]:a;default:return a}default:return a}},"curly brackets are not supported");var Y=function(a){var b=V(a);switch(b[0]){case 0:return[0,b[1]];default:return X(a)}};var aa=tuscheme$0tuscheme$1.s$jal$1611(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(a){return a}}],a]]},function(a){return tuscheme$0tuscheme$1.left$1682(a)}),
function(a){return tuscheme$0tuscheme$1.right$1696(a)}),"empty application");c=tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[10,[a,b]]}}],a]]},function(a){return z.$exp(a)}),tuscheme$0tuscheme$1.many$1261(function(a){return z.$exp(a)}));c=tuscheme$0tuscheme$1.liberalBracket$1841("function application",tuscheme$0tuscheme$1.s$jml$1604(c,"function application"));w=function(a){var b=Y(a);switch(b[0]){case 0:return[0,b[1]];
default:return aa(a)}}(a);switch(w[0]){case 0:return[0,w[1]];default:return c(a)}},$bindings:function(a){return tuscheme$0tuscheme$1.bindingsOf$3610("(x e)",function(a){return tuscheme$0tuscheme$1.name$3595(a)},function(a){return z.$exp(a)})(a)}};tuscheme$0tuscheme$1.exp$3872=z.$exp;tuscheme$0tuscheme$1.bindings$3869=z.$bindings;tuscheme$0tuscheme$1.unit_test$3913;var za=tuscheme$0tuscheme$1.cb$3858("check-expect","(check-expect e1 e2)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return[2,[a,b]]}}],a]]},function(a){return tuscheme$0tuscheme$1.exp$3872(a)}),function(a){return tuscheme$0tuscheme$1.exp$3872(a)})),Aa=tuscheme$0tuscheme$1.cb$3858("check-error","(check-error e)",tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[3,a]}],a]]},function(a){return tuscheme$0tuscheme$1.exp$3872(a)}));var Ba=function(a){var b=za(a);switch(b[0]){case 0:return[0,b[1]];default:return Aa(a)}};var Ca=tuscheme$0tuscheme$1.cb$3858("check-type",
"(check-type e tau)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[1,[a,b]]}}],a]]},function(a){return tuscheme$0tuscheme$1.exp$3872(a)}),function(a){return tuscheme$0tuscheme$1.ty$3814(a)}));var Da=function(a){var b=Ba(a);switch(b[0]){case 0:return[0,b[1]];default:return Ca(a)}};var Ea=tuscheme$0tuscheme$1.cb$3858("check-type-error","(check-type-error e)",tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[0,
a]}],a]]},function(a){return tuscheme$0tuscheme$1.exp$3872(a)}));tuscheme$0tuscheme$1.unit_test$3913=function(a){var b=Da(a);switch(b[0]){case 0:return[0,b[1]];default:return Ea(a)}};tuscheme$0tuscheme$1.define$3918=function(a,b,c,d){var e=c[0];c=c[1];e=tuscheme$0tuscheme$1.nodups$1640("formal parameter","definition of function "+b)([e,basis$0List$1.map$697(function(a){return a[0]},c)]);switch(e[0]){case 0:e=[0,c];break;default:e=[1,e[1]]}switch(e[0]){case 0:return[0,[3,[b,a,[e[1],d]]]];default:return[1,
e[1]]}};tuscheme$0tuscheme$1.valrec$3934=function(a,b,c){return[0,[b,a,c]]};tuscheme$0tuscheme$1.xdef$3944;n=tuscheme$0tuscheme$1.s$jml$1604;var Fa=tuscheme$0tuscheme$1.cb$3858("define","(define type f (args) body)",tuscheme$0tuscheme$1.s$jtla$1279(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return function(c){return function(e){return tuscheme$0tuscheme$1.define$3918(a,b,c,e)}}}}],a]]},function(a){return tuscheme$0tuscheme$1.ty$3814(a)}),
function(a){return tuscheme$0tuscheme$1.name$3595(a)}),tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[a,b]}}],a]]},function(a){var b=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return a[0]}],a]]},function(a){return tuscheme$0tuscheme$1.inline$1491(a)})(a);switch(b[0]){case 0:return[0,[b[1][0],a]];default:return[1]}}),tuscheme$0tuscheme$1.lformals$3836)),function(a){return tuscheme$0tuscheme$1.exp$3872(a)})),
Ga=tuscheme$0tuscheme$1.cb$3858("val","(val x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return function(b){return[1,[a,b]]}}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}),function(a){return tuscheme$0tuscheme$1.exp$3872(a)}));var Ha=function(a){var b=Fa(a);switch(b[0]){case 0:return[0,b[1]];default:return Ga(a)}};var Ia=tuscheme$0tuscheme$1.cb$3858("val-rec","(val-rec type x e)",tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return function(b){return function(c){return[0,[b,a,c]]}}}],a]]},function(a){return tuscheme$0tuscheme$1.ty$3814(a)}),function(a){return tuscheme$0tuscheme$1.name$3595(a)}),function(a){return tuscheme$0tuscheme$1.exp$3872(a)}));var Ja=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[3,a]}],a]]},function(a){var b=Ha(a);switch(b[0]){case 0:return[0,b[1]];default:return Ia(a)}});var Ka=tuscheme$0tuscheme$1.cb$3858("use","(use filename)",tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,
[[0,function(a){return[0,a]}],a]]},function(a){return tuscheme$0tuscheme$1.name$3595(a)}));var La=function(a){var b=Ja(a);switch(b[0]){case 0:return[0,b[1]];default:return Ka(a)}};var Ma=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[1,a]}],a]]},tuscheme$0tuscheme$1.unit_test$3913);var Na=function(a){var b=La(a);switch(b[0]){case 0:return[0,b[1]];default:return Ma(a)}};var Oa=tuscheme$0tuscheme$1.s$jtla$1279(function(a){return[0,[[0,function(a){var b=a[0];switch(a[1]){case 1:a=
")";break;case 0:a="]";break;default:a="}"}a="unexpected right bracket "+a;return[1,tuscheme$0tuscheme$1.synerrormsg$1331(b[0],b[1])([a,null])]}],a]]},function(a){return tuscheme$0tuscheme$1.right$1696(a)});var Pa=function(a){var b=Na(a);switch(b[0]){case 0:return[0,b[1]];default:return Oa(a)}};x=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,function(a){return[2,a]}],a]]},function(a){return tuscheme$0tuscheme$1.exp$3872(a)});var Qa=tuscheme$0tuscheme$1.s$jtl$1007(function(a){return[0,[[0,
function(a){return[3,a]}],a]]},x);tuscheme$0tuscheme$1.xdef$3944=n(function(a){var b=Pa(a);switch(b[0]){case 0:return[0,b[1]];default:return Qa(a)}},"definition");tuscheme$0tuscheme$1.xdefstream$3951=tuscheme$0tuscheme$1.interactiveParsedStream$2083(tuscheme$0tuscheme$1.schemeToken$3546,tuscheme$0tuscheme$1.xdef$3944);tuscheme$0tuscheme$1.filexdefs$3952=function(a,b,c){return tuscheme$0tuscheme$1.xdefstream$3951([a,tuscheme$0tuscheme$1.streamOfEffects$743(function(a){return tuscheme$0stubs$1.inputLine$85(b[0],
b[1])}),c])};tuscheme$0tuscheme$1.stringsxdefs$3961=function(a,b){var c=tuscheme$0tuscheme$1.xdefstream$3951,e=[1],d={$foldr:function(a){return null==a?e:[2,[a[0],d.$foldr(a[1])]]}},f=d.$foldr;b=f(b);return c([a,b,tuscheme$0tuscheme$1.noPrompts$2082])};tuscheme$0tuscheme$1.namedValueString$3968=function(a,b){switch(b[0]){case 5:return a;case 1:return a;default:return tuscheme$0tuscheme$1.valueString$2459(b)}};var X={$eval:function(a,b){var c={$ev:function(a){a:for(;;)switch(a[0]){case 5:return a[1];
case 3:a=a[1][0];continue a;case 2:a=a[1][1];continue a;case 1:return tuscheme$0tuscheme$1.find$139(a[1],b)[0];case 4:var e=a[1];a=e[0];e=c.$ev(e[1]);tuscheme$0tuscheme$1.find$139(a,b)[0]=e;0;return e;case 8:var d=a[1];a=d[1];e=d[2];d=c.$ev(d[0]);switch(d[0]){case 6:d=d[1];break;default:d=!0}a=d?a:e;continue a;case 0:e=a[1];a=e[0];e=e[1];d=c.$ev(a);switch(d[0]){case 6:d=d[1];break;default:d=!0}if(d){c.$ev(e);a=[0,[a,e]];continue a}else return tuscheme$0tuscheme$1.unitVal$2641;case 9:return function(a,
b){for(;;){if(null==a)return b;b=a;a=b[1];b=c.$ev(b[0])}}(a[1],tuscheme$0tuscheme$1.unitVal$2641);case 7:return e=a[1],a=e[0],e=e[1],[5,[[basis$0List$1.map$697(function(a){return function(a){return a[0]}}([]),a),e],b]];case 10:switch(e=a[1],a=e[1],e=c.$ev(e[0]),e[0]){case 1:return(0,e[1])(basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([c.$ev]),a));case 5:var f=e[1];d=f[0];e=d[0];d=d[1];f=f[1];a=basis$0List$1.map$697(function(a){return function(b){return(0,a[0])(b)}}([c.$ev]),
a);try{return X.$eval(d,tuscheme$0tuscheme$1.bindList$174(e,basis$0List$1.map$697(function(a){return function(a){return[a]}}([]),a),f))}catch(M){return function(a){return function(b){var c=a[0],e=a[1];if(b[0]==tuscheme$0tuscheme$1.en$BindListLength$164)throw[tuscheme$0tuscheme$1.en$RuntimeError$225,"Wrong number of arguments to closure; expected ("+e(c)+")"];throw b;}}([e,tuscheme$0tuscheme$1.spaceSep$414])(M)}default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"applied non-function"];}default:switch(a=
a[1],a[0][0]){case 1:return e=a[2],a=basis$0ListPair$1.unzip$140(a[1]),d=a[1],X.$eval(e,tuscheme$0tuscheme$1.bindList$174(a[0],basis$0List$1.map$697(function(a){return function(b){return[(0,a[0])(b)]}}([c.$ev]),d),b));default:return e=X.$eval,d=a[2],a=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[0];c=c[1];a=[[b[0],[X.$eval(b[1],a)]],a];b=c}}(b,a[1]),e(d,a)}}}},e=c.$ev;return e(a)}};tuscheme$0tuscheme$1.eval$3983=X.$eval;tuscheme$0tuscheme$1.evaldef$4159=function(a,b){for(;;)switch(a[0]){case 1:var c=
a[1];a=c[0];c=tuscheme$0tuscheme$1.eval$3983(c[1],b);b=[[a,[c]],b];switch(c[0]){case 5:break;case 1:break;default:a=tuscheme$0tuscheme$1.valueString$2459(c)}return[b,a];case 0:var e=a[1];a=e[0];c=[[4]];b=[[a,c],b];e=tuscheme$0tuscheme$1.eval$3983(e[2],b);c[0]=e;0;switch(e[0]){case 5:break;case 1:break;default:a=tuscheme$0tuscheme$1.valueString$2459(e)}return[b,a];case 2:return a=tuscheme$0tuscheme$1.eval$3983(a[1],b),[[["it",[a]],b],tuscheme$0tuscheme$1.valueString$2459(a)];default:a=a[1],a=[0,[a[0],
a[1],[7,a[2]]]]}};tuscheme$0tuscheme$1.processDef$4211=function(a,b,c){var e=b[0],d=b[2],f=tuscheme$0tuscheme$1.elabdef$3424(a,e,b[1]);b=f[0];f=f[1];d=tuscheme$0tuscheme$1.evaldef$4159(a,d);a=d[0];d=d[1];switch(c[1]){case 0:c=!0;break;default:c=!1}c?(tuscheme$0stubs$1.print$119(d+" : "+f),tuscheme$0stubs$1.print$119("\n")):0;return[e,b,a]};tuscheme$0tuscheme$1.failtest$4241=function(a){a:for(;;){if(null==a)break a;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
"\n");return!1};tuscheme$0tuscheme$1.reportTestResultsOf$4249=function(a,b){var c=b[0],e=b[1];b=function(b){return c==e?function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.print$119(a[0]);a=b}}(["All ",[tuscheme$0tuscheme$1.intString$351(e),[" "+a+"s passed.\n",null]]]):0==c?function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.print$119(a[0]);a=b}}(["All ",[tuscheme$0tuscheme$1.intString$351(e),[" "+a+"s failed.\n",null]]]):function(a){for(;;){if(null==a)return 0;
var b=a[1];tuscheme$0stubs$1.print$119(a[0]);a=b}}([tuscheme$0tuscheme$1.intString$351(c),[" of ",[tuscheme$0tuscheme$1.intString$351(e),[" "+a+"s passed.\n",null]]]])};switch(e){case 0:return 0;default:switch(c){case 0:switch(e){case 1:return tuscheme$0stubs$1.print$119("The only "+a+" failed."),tuscheme$0stubs$1.print$119("\n");case 2:return tuscheme$0stubs$1.print$119("Both "+a+"s failed."),tuscheme$0stubs$1.print$119("\n");default:return b(0)}case 1:switch(e){case 1:return tuscheme$0stubs$1.print$119("The only "+
a+" passed."),tuscheme$0stubs$1.print$119("\n");case 2:return tuscheme$0stubs$1.print$119("One of two "+a+"s passed."),tuscheme$0stubs$1.print$119("\n");default:return b(0)}case 2:switch(e){case 2:return tuscheme$0stubs$1.print$119("Both "+a+"s passed."),tuscheme$0stubs$1.print$119("\n");default:return b(0)}default:return b(0)}}};tuscheme$0tuscheme$1.reportTestResults$4287=function(a){return tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",a)};tuscheme$0tuscheme$1.testIsGood$4288=function(a,b){var c=
b[0],e=b[1];b=b[2];switch(a[0]){case 2:var d=a[1],f=d[0],h=d[1];try{try{var g=tuscheme$0tuscheme$1.typeof$3161(f,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}try{var k=tuscheme$0tuscheme$1.typeof$3161(h,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}if(tuscheme$0tuscheme$1.eqType$2889(g,k))var l=!0;else throw[tuscheme$0tuscheme$1.en$TypeError$87,
"Expressions have types "+tuscheme$0tuscheme$1.typeString$2200(g)+" and "+tuscheme$0tuscheme$1.typeString$2200(k)];}catch(t){l=function(a){if(a[0]==tuscheme$0tuscheme$1.en$TypeError$87){a=a[1];a:for(a=["In (check-expect ",[tuscheme$0tuscheme$1.expString$2514(f),[" ",[tuscheme$0tuscheme$1.expString$2514(h),["), ",[a,null]]]]]];;){if(null==a)break a;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}throw a;
}(t)}break;case 3:var m=a[1];try{try{tuscheme$0tuscheme$1.typeof$3161(m,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}l=!0}catch(t){l=function(a){if(a[0]==tuscheme$0tuscheme$1.en$TypeError$87){a=a[1];a:for(a=["In (check-error ",[tuscheme$0tuscheme$1.expString$2514(m),["), ",[a,null]]]];;){if(null==a)break a;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
"\n");return!1}throw a;}(t)}break;case 1:g=a[1];var q=g[0],r=g[1];try{try{tuscheme$0tuscheme$1.typeof$3161(q,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}l=!0}catch(t){l=function(a){if(a[0]==tuscheme$0tuscheme$1.en$TypeError$87){a=a[1];a:for(a=["In (check-type ",[tuscheme$0tuscheme$1.expString$2514(q),[" "+tuscheme$0tuscheme$1.typeString$2200(r),["), ",[a,null]]]]];;){if(null==a)break a;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
a[0]);a=b}tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}throw a;}(t)}break;default:l=!0}if(l)switch(a[0]){case 2:c=a[1];e=c[0];c=c[1];try{var n=[0,tuscheme$0tuscheme$1.eval$3983(e,b)]}catch(t){n=[1,"evaluation failed"]}try{var p=[0,tuscheme$0tuscheme$1.eval$3983(c,b)]}catch(t){p=[1,"evaluation failed"]}switch(n[0]){case 0:switch(p[0]){case 0:b=n[1];n=p[1];if(tuscheme$0tuscheme$1.equalpairs$2712(b,n))return!0;p=tuscheme$0tuscheme$1.expString$2514(e);n=[0,n];switch(c[0]){case 5:e=
[0,c[1]];break;default:e=[1]}switch(e[0]){case 0:n=tuscheme$0tuscheme$1.valueString$2459(e[1]);break;default:switch(n[0]){case 0:n=tuscheme$0tuscheme$1.valueString$2459(n[1])+" (from evaluating "+tuscheme$0tuscheme$1.expString$2514(c)+")";break;default:n="the result of evaluating "+tuscheme$0tuscheme$1.expString$2514(c)}}b=[n,[", but it's ",[tuscheme$0tuscheme$1.valueString$2459(b),[".",null]]]];(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
a[0]);a=b}})(["check-expect failed: ",[" expected ",[p,[" to evaluate to ",b]]]]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1;default:b=p[1];p=tuscheme$0tuscheme$1.expString$2514(e);b=[1,b];switch(c[0]){case 5:n=[0,c[1]];break;default:n=[1]}switch(n[0]){case 0:b=tuscheme$0tuscheme$1.valueString$2459(n[1]);break;default:switch(b[0]){case 0:b=tuscheme$0tuscheme$1.valueString$2459(b[1])+" (from evaluating "+tuscheme$0tuscheme$1.expString$2514(c)+")";break;default:b="the result of evaluating "+
tuscheme$0tuscheme$1.expString$2514(c)}}b=[b,[", but evaluating ",[tuscheme$0tuscheme$1.expString$2514(c),[" caused an error.",null]]]];(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}})(["check-expect failed: ",[" expected ",[p,[" to evaluate to ",b]]]]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}default:b=tuscheme$0tuscheme$1.expString$2514(e);switch(c[0]){case 5:n=[0,c[1]];break;default:n=[1]}switch(n[0]){case 0:p=
tuscheme$0tuscheme$1.valueString$2459(n[1]);break;default:switch(p[0]){case 0:p=tuscheme$0tuscheme$1.valueString$2459(p[1])+" (from evaluating "+tuscheme$0tuscheme$1.expString$2514(c)+")";break;default:p="the result of evaluating "+tuscheme$0tuscheme$1.expString$2514(c)}}p=[p,[", but evaluating ",[tuscheme$0tuscheme$1.expString$2514(e),[" caused an error.",null]]]];(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}})(["check-expect failed: ",
[" expected ",[b,[" to evaluate to ",p]]]]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}case 3:p=a[1];try{var u=[0,tuscheme$0tuscheme$1.eval$3983(p,b)]}catch(t){u=[1,"evaluation failed"]}switch(u[0]){case 1:return!0;default:return b=u[1],function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}}(["check-error failed: ",[" expected evaluating ",[tuscheme$0tuscheme$1.expString$2514(p),[" to cause an error, but evaluation produced ",
[tuscheme$0tuscheme$1.valueString$2459(b),null]]]]]),tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n"),!1}case 1:p=a[1];var W=p[0],w=p[1];try{try{var ba=tuscheme$0tuscheme$1.typeof$3161(W,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}if(tuscheme$0tuscheme$1.eqType$2889(w,ba))return!0;(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,
a[0]);a=b}})(["check-type failed: expected ",[tuscheme$0tuscheme$1.expString$2514(W),[" to have type ",[tuscheme$0tuscheme$1.typeString$2200(w),[", but it has type ",[tuscheme$0tuscheme$1.typeString$2200(ba),null]]]]]]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}catch(t){return function(a){if(a[0]==tuscheme$0tuscheme$1.en$TypeError$87){a=a[1];a:for(a=["In (check-type ",[tuscheme$0tuscheme$1.expString$2514(W),[" "+tuscheme$0tuscheme$1.typeString$2200(w),["), ",[a,null]]]]];;){if(null==
a)break a;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}throw a;}(t)}default:p=a[1];try{try{var x=tuscheme$0tuscheme$1.typeof$3161(p,c,e)}catch(t){if(t[0]==tuscheme$0tuscheme$1.en$NotFound$138)throw[tuscheme$0tuscheme$1.en$TypeError$87,"name "+t[1]+" is not defined"];throw t;}(function(a){for(;;){if(null==a)return 0;var b=a[1];tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a[0]);a=b}})(["check-type-error failed: expected ",
[tuscheme$0tuscheme$1.expString$2514(p),[" not to have a type, but it has type ",[tuscheme$0tuscheme$1.typeString$2200(x),null]]]]);tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n");return!1}catch(t){if(t[0]!=tuscheme$0tuscheme$1.en$TypeError$87&&(t[0]!=tuscheme$0tuscheme$1.en$Located$1349||t[1][1][0]!=tuscheme$0tuscheme$1.en$TypeError$87))throw t;return!0}}else return!1};tuscheme$0tuscheme$1.numberOfGoodTests$4527=function(a,b){var c={$foldr:function(a){if(null==a)return 0;var e=a[0];
a=c.$foldr(a[1]);return tuscheme$0tuscheme$1.testIsGood$4288(e,b)?SmlPrims.chk_ovf_i32(a+1):a}},e=c.$foldr;return e(a)};tuscheme$0tuscheme$1.processTests$4544=function(a,b){var c={$foldr:function(a){if(null==a)return 0;var e=a[0];a=c.$foldr(a[1]);return tuscheme$0tuscheme$1.testIsGood$4288(e,b)?SmlPrims.chk_ovf_i32(a+1):a}};var e=c.$foldr;e=e(a);a=function(a,b){for(;;){if(null==a)return b;a=a[1];b=SmlPrims.chk_ovf_i32(b+1)}}(a,0);return tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",[e,a])};
tuscheme$0tuscheme$1.processPredefined$4551=function(a,b){return tuscheme$0tuscheme$1.processDef$4211(a,b,tuscheme$0tuscheme$1.noninteractive$547)};var na={$readEvalPrintWith:function(a,b){var c=b[2],e=[null],d={$processXDef:function(b,f){try{switch(b[0]){case 0:var h=b[1],g=tuscheme$0stubs$1.openIn$106(h),k=[1,c[1]];return na.$readEvalPrintWith(a,[tuscheme$0tuscheme$1.xdefstream$3951([h,tuscheme$0tuscheme$1.streamOfEffects$743(function(a){return tuscheme$0stubs$1.inputLine$85(g[0],g[1])}),tuscheme$0tuscheme$1.noPrompts$2082]),
f,k]);case 1:return e[0]=[b[1],e[0]],0,f;case 3:return tuscheme$0tuscheme$1.processDef$4211(b[1],f,c);default:var l=basis$0List$1.map$697(function(a){return[3,a]},b[1]);return function(a,b){for(;;){if(null==b)return a;var c=b;b=c[1];a=d.$processXDef(c[0],a)}}(f,l)}}catch(ia){return function(b){if(b[0]==tuscheme$0stubs$1.en$IO_Io$64||b[0]==CompilerInitial.en$Div$47||b[0]==CompilerInitial.en$Overflow$50||b[0]==CompilerInitial.en$Subscript$52||b[0]==CompilerInitial.en$Size$53||b[0]==tuscheme$0tuscheme$1.en$RuntimeError$225||
b[0]==tuscheme$0tuscheme$1.en$NotFound$138||b[0]==tuscheme$0tuscheme$1.en$Located$1349||b[0]==tuscheme$0tuscheme$1.en$TypeError$87||b[0]==tuscheme$0tuscheme$1.en$BugInTypeChecking$88){if(b[0]==tuscheme$0tuscheme$1.en$Located$1349){var c=b[1][0];var e=b[1][1];b=tuscheme$0tuscheme$1.fillComplaintTemplate$1388;if(e[0]==tuscheme$0stubs$1.en$IO_Io$64)e="I/O error <at loc>: "+e[1][0];else if(e[0]==CompilerInitial.en$Div$47)e="Division by zero <at loc>";else if(e[0]==CompilerInitial.en$Overflow$50)e="Arithmetic overflow <at loc>";
else if(e[0]==CompilerInitial.en$Subscript$52)e="Array index out of bounds <at loc>";else if(e[0]==CompilerInitial.en$Size$53)e="Array length too large (or negative) <at loc>";else if(e[0]==tuscheme$0tuscheme$1.en$RuntimeError$225)e="Run-time error <at loc>: "+e[1];else if(e[0]==tuscheme$0tuscheme$1.en$NotFound$138)e="Variable "+e[1]+" not found <at loc>";else if(e[0]==tuscheme$0tuscheme$1.en$TypeError$87)e="type error <at loc>: "+e[1];else if(e[0]==tuscheme$0tuscheme$1.en$BugInTypeChecking$88)e=
"bug in type checking: "+e[1];else if(e[0]==tuscheme$0tuscheme$1.en$Located$1349)e="internal error --- template mustn't be used";else throw[tuscheme$0tuscheme$1.en$InternalError$241,"exception has handler but no template"];c=b(e,[0,c])}else{c=tuscheme$0tuscheme$1.fillComplaintTemplate$1388;if(b[0]==tuscheme$0stubs$1.en$IO_Io$64)b="I/O error <at loc>: "+b[1][0];else if(b[0]==CompilerInitial.en$Div$47)b="Division by zero <at loc>";else if(b[0]==CompilerInitial.en$Overflow$50)b="Arithmetic overflow <at loc>";
else if(b[0]==CompilerInitial.en$Subscript$52)b="Array index out of bounds <at loc>";else if(b[0]==CompilerInitial.en$Size$53)b="Array length too large (or negative) <at loc>";else if(b[0]==tuscheme$0tuscheme$1.en$RuntimeError$225)b="Run-time error <at loc>: "+b[1];else if(b[0]==tuscheme$0tuscheme$1.en$NotFound$138)b="Variable "+b[1]+" not found <at loc>";else if(b[0]==tuscheme$0tuscheme$1.en$TypeError$87)b="type error <at loc>: "+b[1];else if(b[0]==tuscheme$0tuscheme$1.en$BugInTypeChecking$88)b=
"bug in type checking: "+b[1];else if(b[0]==tuscheme$0tuscheme$1.en$Located$1349)b="internal error --- template mustn't be used";else throw[tuscheme$0tuscheme$1.en$InternalError$241,"exception has handler but no template"];c=c(b,[1])}a(c);return f}throw b;}(ia)}}},f=d.$processXDef;var h=function(a,b){for(;;)switch(b=tuscheme$0tuscheme$1.streamGet$703(b),b[0]){case 1:return a;default:var c=b[1];b=c[1];a=f(c[0],a)}}(b[1],b[0]);b=e[0];var g={$foldr:function(a){if(null==a)return 0;var b=a[0];a=g.$foldr(a[1]);
return tuscheme$0tuscheme$1.testIsGood$4288(b,h)?SmlPrims.chk_ovf_i32(a+1):a}};var k=g.$foldr;k=k(b);b=function(a,b){for(;;){if(null==a)return b;a=a[1];b=SmlPrims.chk_ovf_i32(b+1)}}(b,0);tuscheme$0tuscheme$1.reportTestResultsOf$4249("test",[k,b]);return h}};tuscheme$0tuscheme$1.readEvalPrintWith$4558=na.$readEvalPrintWith;tuscheme$0tuscheme$1.binaryOp$4692=function(a,b){if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var c=b[1];if(null==c)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 2"];if(null==c[1])return a([b[0],c[0]]);throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];};tuscheme$0tuscheme$1.unaryOp$4713=function(a,b){if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==b[1])return a(b[0]);throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];};tuscheme$0tuscheme$1.arithOp$4728=function(a,b){if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var c=b[1];if(null==c)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 2"];if(null==c[1])switch(b=b[0],c=c[0],b[0]){case 3:switch(c[0]){case 3:return[3,a([b[1],c[1]])];default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arithmetic on non-numbers"];}default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arithmetic on non-numbers"];}else throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];};tuscheme$0tuscheme$1.arithtype$4746=[2,[[tuscheme$0tuscheme$1.inttype$2191,[tuscheme$0tuscheme$1.inttype$2191,null]],tuscheme$0tuscheme$1.inttype$2191]];
tuscheme$0tuscheme$1.comparison$4747=function(a,b){if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var c=b[1];if(null==c)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];if(null==c[1])return[6,a([b[0],c[0]])];throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];};tuscheme$0tuscheme$1.intcompare$4752=function(a,b){if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var c=b[1];if(null==c)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 2"];if(null==c[1]){b=b[0];c=c[0];switch(b[0]){case 3:switch(c[0]){case 3:a=a([b[1],c[1]]);break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}return[6,a]}throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];};tuscheme$0tuscheme$1.comptype$4770=[2,[[tuscheme$0tuscheme$1.inttype$2191,[tuscheme$0tuscheme$1.inttype$2191,null]],tuscheme$0tuscheme$1.booltype$2192]];
tuscheme$0tuscheme$1.initialBasis$4771;n=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[0];c=c[1];a=[[b[0],b[1]],a];b=c}}(tuscheme$0tuscheme$1.emptyEnv$137(0),[["int",null],[["bool",null],[["sym",null],[["unit",null],[["list",[[null,null],null]],null]]]]]);x=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[0];var e=b[0];c=c[1];a=[[[e,b[2]],a[0]],[[e,[[1,b[1]]]],a[1]]];b=c}}([tuscheme$0tuscheme$1.emptyEnv$137(0),tuscheme$0tuscheme$1.emptyEnv$137(0)],[["+",function(a){return tuscheme$0tuscheme$1.arithOp$4728(function(a){return SmlPrims.chk_ovf_i32(a[0]+
a[1])},a)},tuscheme$0tuscheme$1.arithtype$4746],[["-",function(a){return tuscheme$0tuscheme$1.arithOp$4728(function(a){return SmlPrims.chk_ovf_i32(a[0]-a[1])},a)},tuscheme$0tuscheme$1.arithtype$4746],[["*",function(a){return tuscheme$0tuscheme$1.arithOp$4728(function(a){return SmlPrims.chk_ovf_i32(a[0]*a[1])},a)},tuscheme$0tuscheme$1.arithtype$4746],[["/",function(a){return tuscheme$0tuscheme$1.arithOp$4728(function(a){return SmlPrims.div_i32(a[0],a[1],CompilerInitial.exn$Div$47)},a)},tuscheme$0tuscheme$1.arithtype$4746],
[["<",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var b=a[1];if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];if(null==b[1]){a=a[0];b=b[0];switch(a[0]){case 3:switch(b[0]){case 3:b=a[1]<b[1];break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}return[6,b]}throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 2"];},tuscheme$0tuscheme$1.comptype$4770],[[">",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var b=a[1];if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];if(null==b[1]){a=a[0];b=b[0];switch(a[0]){case 3:switch(b[0]){case 3:b=a[1]>b[1];break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}break;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"comparing non-numbers"];}return[6,b]}throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 2"];},tuscheme$0tuscheme$1.comptype$4770],[["=",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var b=a[1];if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];if(null==b[1]){a=a[0];b=b[0];switch(a[0]){case 4:switch(b[0]){case 4:b=!0;break;default:b=!1}break;case 3:switch(b[0]){case 3:b=a[1]==b[1];break;default:b=!1}break;case 0:switch(b[0]){case 0:b=a[1]==b[1];break;default:b=!1}break;case 6:switch(b[0]){case 6:b=a[1]==b[1];break;default:b=
!1}break;default:b=!1}return[6,b]}throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,[tuscheme$0tuscheme$1.tyvarA$2195,null]],tuscheme$0tuscheme$1.booltype$2192]]]]],[["null?",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==a[1]){switch(a[0][0]){case 4:a=!0;break;default:a=!1}return[6,a]}throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];},[3,[["'a",null],[2,[[[4,[[1,"list"],
[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],tuscheme$0tuscheme$1.booltype$2192]]]]],[["cons",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];var b=a[1];if(null==b)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];if(null==b[1])return[2,[a[0],b[0]]];throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 2"];},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null]],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,
null]]]]]]]],[["car",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==a[1])switch(a=a[0],a[0]){case 2:return a[1][0];default:throw[tuscheme$0tuscheme$1.en$RuntimeError$225,"car applied to non-list "+tuscheme$0tuscheme$1.valueString$2459(a)];}else throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];},[3,[["'a",null],[2,[[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],tuscheme$0tuscheme$1.tyvarA$2195]]]]],[["cdr",function(a){if(null==
a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==a[1])switch(a=a[0],a[0]){case 2:return a[1][1];default:throw[tuscheme$0tuscheme$1.en$RuntimeError$225,"cdr applied to non-list "+tuscheme$0tuscheme$1.valueString$2459(a)];}else throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];},[3,[["'a",null],[2,[[[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]],null],[4,[[1,"list"],[tuscheme$0tuscheme$1.tyvarA$2195,null]]]]]]]],[["println",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 1"];if(null==a[1])return tuscheme$0stubs$1.print$119(tuscheme$0tuscheme$1.valueString$2459(a[0])+"\n"),tuscheme$0tuscheme$1.unitVal$2641;throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,null],tuscheme$0tuscheme$1.unittype$2194]]]]],[["print",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==a[1])return tuscheme$0stubs$1.print$119(tuscheme$0tuscheme$1.valueString$2459(a[0])),tuscheme$0tuscheme$1.unitVal$2641;
throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];},[3,[["'a",null],[2,[[tuscheme$0tuscheme$1.tyvarA$2195,null],tuscheme$0tuscheme$1.unittype$2194]]]]],[["printu",function(a){if(null==a)throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"arity 1"];if(null==a[1])switch(a=a[0],a[0]){case 3:return tuscheme$0tuscheme$1.printUTF8$416(a[1]),tuscheme$0tuscheme$1.unitVal$2641;default:throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,"printu of non-number"];}else throw[tuscheme$0tuscheme$1.en$BugInTypeChecking$88,
"arity 1"];},[2,[[tuscheme$0tuscheme$1.inttype$2191,null],tuscheme$0tuscheme$1.unittype$2194]]],null]]]]]]]]]]]]]]);x=function(a,b){for(;;){if(null==b)return a;var c=b;b=c[0];var d=b[0];c=c[1];a=[[[d,b[2]],a[0]],[[d,[b[1]]],a[1]]];b=c}}([x[0],x[1]],null);n=[n,x[0],x[1]];x=tuscheme$0tuscheme$1.xdefstream$3951;var Ra=[1],oa={$foldr:function(a){return null==a?Ra:[2,[a[0],oa.$foldr(a[1])]]}};var ka=oa.$foldr;ka=ka(["(val list1 (type-lambda ['a] (lambda ([x : 'a]) ((@ cons 'a) x (@ '() 'a)))))",["(val list2 (type-lambda ['a] (lambda ([x : 'a] [y : 'a])",
["                               ((@ cons 'a) x ((@ list1 'a) y)))))",["(val list3 (type-lambda ['a] (lambda ([x : 'a] [y : 'a] [z : 'a])",["                               ((@ cons 'a) x ((@ list2 'a) y z)))))",["(val o (type-lambda ['a 'b 'c]",["  (lambda ([f : ('b -> 'c)]",["           [g : ('a -> 'b)])",["     (lambda ([x : 'a]) (f (g x))))))",["",["(val curry (type-lambda ['a 'b 'c]",["   (lambda ([f : ('a 'b -> 'c)])",["      (lambda ([x : 'a]) (lambda ([y : 'b]) (f x y))))))",["",["(val uncurry (type-lambda ['a 'b 'c]",
["   (lambda ([f : ('a -> ('b -> 'c))])",["      (lambda ([x : 'a] [y : 'b]) ((f x) y)))))",["(val-rec",["  (forall ('a) ((list 'a) -> int))  ; type of thing being defined",["  length                            ; name of thing being defined",["  (type-lambda ['a]                 ; value of thing: a polymorphic function",["     (lambda ([xs : (list 'a)])",["       (if ((@ null? 'a) xs) 0",["          (+ 1 ((@ length 'a) ((@ cdr 'a) xs)))))))",["(val-rec ",["  (forall ('a) ((list 'a) (list 'a) -> (list 'a)))",
["  revapp",["  (type-lambda ['a]",["     (lambda ([xs : (list 'a)] [ys : (list 'a)])",["        (if ((@ null? 'a) xs)",["        ys",["        ((@ revapp 'a) ((@ cdr 'a) xs) ((@ cons 'a) ((@ car 'a) xs) ys))))))",["(val caar",["   (type-lambda ('a)",["      (lambda ([xs : (list (list 'a))])",["          ((@ car 'a) ((@ car (list 'a)) xs)))))",["(val cadr",["   (type-lambda ('a)",["      (lambda ([xs : (list (list 'a))])",["          ((@ car (list 'a)) ((@ cdr (list 'a)) xs)))))",["(define bool and ([b : bool] [c : bool]) (if b  c  b))",
["(define bool or  ([b : bool] [c : bool]) (if b  b  c))",["(define bool not ([b : bool])            (if b #f #t))",["(val-rec (forall ('a) ((list 'a) (list 'a) -> (list 'a))) append",["  (type-lambda ('a)",["     (lambda ([xs : (list 'a)] [ys : (list 'a)])",["       (if ((@ null? 'a) xs)",["         ys",["         ((@ cons 'a) ((@ car 'a) xs) ((@ append 'a) ((@ cdr 'a) xs) ys))))))",["(val-rec (forall ('a) (('a -> bool) (list 'a) -> (list 'a))) filter",["   (type-lambda ('a)",["      (lambda ([p? : ('a -> bool)] [xs : (list 'a)])",
["         (if ((@ null? 'a) xs)",["             (@ '() 'a)",["             (if (p? ((@ car 'a) xs))",["                 ((@ cons 'a) ((@ car 'a) xs) ((@ filter 'a) p? ((@ cdr 'a) xs)))",["                 ((@ filter 'a) p? ((@ cdr 'a) xs)))))))",["(val-rec (forall ('a 'b) (('a -> 'b) (list 'a) -> (list 'b))) map",["   (type-lambda ('a 'b)",["      (lambda ([f : ('a -> 'b)] [xs : (list 'a)])",["         (if ((@ null? 'a) xs)",["             (@ '() 'b)",["             ((@ cons 'b) (f ((@ car 'a) xs)) ((@ map 'a 'b) f ((@ cdr 'a) xs)))))))",
["(define bool <= ([x : int] [y : int]) (not (> x y)))",["(define bool >= ([x : int] [y : int]) (not (< x y)))",["(val != (type-lambda ('a) (lambda ([x : 'a] [y : 'a]) (not ((@ = 'a) x y)))))",["(define int max ([m : int] [n : int]) (if (> m n) m n))",["(define int min ([m : int] [n : int]) (if (< m n) m n))",["(define int mod ([m : int] [n : int]) (- m (* n (/ m n))))",["(define int gcd ([m : int] [n : int]) (if ((@ = int) n 0) m (gcd n (mod m n))))",["(define int lcm ([m : int] [n : int]) (* m (/ n (gcd m n))))",
null]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]);x=x(["predefined functions",ka,tuscheme$0tuscheme$1.noPrompts$2082]);tuscheme$0tuscheme$1.initialBasis$4771=tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(a){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"while reading predefined functions, "+a);return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n")},[x,n,tuscheme$0tuscheme$1.noninteractive$547]);tuscheme$0tuscheme$1.runAs$4883=function(a){switch(a[0]){case 0:var b=
!0;break;default:b=!1}b?[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0),basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC"))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0):0][0]:[(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=0,0),basis$0General$1.isSome$122(tuscheme$0stubs$1.getEnv$54("NOERRORLOC"))?(tuscheme$0tuscheme$1.toplevel_error_format$1330[0]=1,0):0][0];switch(a[0]){case 0:b=!0;break;default:b=!1}b=b?tuscheme$0tuscheme$1.stdPrompts$2081:tuscheme$0tuscheme$1.noPrompts$2082;
b=tuscheme$0tuscheme$1.xdefstream$3951(["standard input",tuscheme$0tuscheme$1.streamOfEffects$743(function(a){return tuscheme$0stubs$1.inputLine$85(tuscheme$0stubs$1.stdIn$118[0],tuscheme$0stubs$1.stdIn$118[1])}),b]);tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(a){tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,a);return tuscheme$0stubs$1.output$68(tuscheme$0stubs$1.stdErr$67,"\n")},[b,tuscheme$0tuscheme$1.initialBasis$4771,a]);return 0};return 0})();
"undefined"==typeof tuscheme$0run$1&&(tuscheme$0run$1={});
(function(){tuscheme$0run$1.clone_basis$54=function(b,a,c){return[b,a,basis$0List$1.map$332(function(a){return[a[0],[a[1][0]]]},c)]};tuscheme$0run$1.current_basis$76=[[tuscheme$0tuscheme$1.initialBasis$4771[0],tuscheme$0tuscheme$1.initialBasis$4771[1],basis$0List$1.map$332(function(b){return[b[0],[b[1][0]]]},tuscheme$0tuscheme$1.initialBasis$4771[2])]];tuscheme$0run$1.tuscheme_eval$77=function(b){tuscheme$0stubs$1.outputBuf$65[0]="";0;var a=tuscheme$0run$1.current_basis$76[0];b=tuscheme$0tuscheme$1.stringsxdefs$3961("<website>",
basis$0String$1.fields$231(function(a){return 10==a},b));a=tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(a){return tuscheme$0tuscheme$1.eprintln$341(a)},[b,a,[1,0]]);b=tuscheme$0stubs$1.outputBuf$65[0];tuscheme$0stubs$1.outputBuf$65[0]="";0;tuscheme$0run$1.current_basis$76[0]=a;0;return b};tuscheme$0run$1.tuscheme_reset$94=function(b){return tuscheme$0run$1.current_basis$76[0]=[tuscheme$0tuscheme$1.initialBasis$4771[0],tuscheme$0tuscheme$1.initialBasis$4771[1],basis$0List$1.map$332(function(a){return[a[0],
[a[1][0]]]},tuscheme$0tuscheme$1.initialBasis$4771[2])],0};tuscheme_eval=function(b){tuscheme$0stubs$1.outputBuf$65[0]="";0;var a=tuscheme$0run$1.current_basis$76[0];b=tuscheme$0tuscheme$1.stringsxdefs$3961("<website>",basis$0String$1.fields$231(function(a){return 10==a},b));a=tuscheme$0tuscheme$1.readEvalPrintWith$4558(function(a){return tuscheme$0tuscheme$1.eprintln$341(a)},[b,a,[1,0]]);b=tuscheme$0stubs$1.outputBuf$65[0];tuscheme$0stubs$1.outputBuf$65[0]="";0;tuscheme$0run$1.current_basis$76[0]=
a;0;return b};tuscheme_reset=function(b){return tuscheme$0run$1.current_basis$76[0]=[tuscheme$0tuscheme$1.initialBasis$4771[0],tuscheme$0tuscheme$1.initialBasis$4771[1],basis$0List$1.map$332(function(a){return[a[0],[a[1][0]]]},tuscheme$0tuscheme$1.initialBasis$4771[2])],0};return 0})();
/* eslint-enable */

export class TUScheme {
    name = 'tuscheme';
    mode = 'scheme';
    autoCloseBrackets = '()[]{}';
    extension = '.scm'
    async setFilemap(filemap) {
        tuscheme_filemap = filemap;
    }
    async eval(str) {
        return tuscheme_eval(str);
    }
    async reset() {
        tuscheme_reset();
    }
};

